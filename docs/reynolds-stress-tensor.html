<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Reynolds stress tensor | Reddy: A toolbox for analyzing eddy-covariance measurements</title>
  <meta name="description" content="6 Reynolds stress tensor | Reddy: A toolbox for analyzing eddy-covariance measurements" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Reynolds stress tensor | Reddy: A toolbox for analyzing eddy-covariance measurements" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="noctiluc3nt/Reddy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Reynolds stress tensor | Reddy: A toolbox for analyzing eddy-covariance measurements" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spectra.html"/>
<link rel="next" href="flux-footprint.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/noctiluc3nt/Reddy" target="blank"><bf>Reddy<bf></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#measurement-setup-and-instrumentation"><i class="fa fa-check"></i><b>1.1</b> Measurement setup and instrumentation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.2</b> Data sources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html"><i class="fa fa-check"></i><b>2</b> Post-processing of raw eddy-covariance data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#eddy-covariance-method"><i class="fa fa-check"></i><b>2.1</b> Eddy-covariance method</a></li>
<li class="chapter" data-level="2.2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#raw-data-handling-and-corrections"><i class="fa fa-check"></i><b>2.2</b> Raw data handling and corrections</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#choosing-a-suitable-averaging-time"><i class="fa fa-check"></i><b>2.2.1</b> Choosing a suitable averaging time</a></li>
<li class="chapter" data-level="2.2.2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#overview-of-correction-procedures-applied-to-the-raw-data"><i class="fa fa-check"></i><b>2.2.2</b> Overview of correction procedures applied to the raw data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#an-example-post-processing-routine"><i class="fa fa-check"></i><b>2.3</b> An example post-processing routine</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html"><i class="fa fa-check"></i><b>3</b> Turbulence diagnostics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#standard-turbulence-diagnostics-and-fluxes"><i class="fa fa-check"></i><b>3.1</b> Standard turbulence diagnostics and fluxes</a></li>
<li class="chapter" data-level="3.2" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#stability-dependence"><i class="fa fa-check"></i><b>3.2</b> Stability dependence</a></li>
<li class="chapter" data-level="3.3" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#turbulence-regimes-and-hockey-stick-model"><i class="fa fa-check"></i><b>3.3</b> Turbulence regimes and “Hockey-stick” model</a></li>
<li class="chapter" data-level="3.4" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#decoupling-metric"><i class="fa fa-check"></i><b>3.4</b> Decoupling metric</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html"><i class="fa fa-check"></i><b>4</b> Quadrant analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html#calculation-of-occurrence-frequencies-and-strengths-of-the-four-quadrants-with-calc_quadrant_analysis"><i class="fa fa-check"></i><b>4.1</b> Calculation of occurrence frequencies and strengths of the four quadrants with <code>calc_quadrant_analysis</code></a></li>
<li class="chapter" data-level="4.2" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html#plotting-quadrant-analysis-with-plot_quadrant_analysis"><i class="fa fa-check"></i><b>4.2</b> Plotting quadrant analysis with <code>plot_quadrant_analysis</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spectra.html"><a href="spectra.html"><i class="fa fa-check"></i><b>5</b> Spectra</a>
<ul>
<li class="chapter" data-level="5.1" data-path="spectra.html"><a href="spectra.html#spectral-analysis-of-timeseries"><i class="fa fa-check"></i><b>5.1</b> Spectral analysis of timeseries</a></li>
<li class="chapter" data-level="5.2" data-path="spectra.html"><a href="spectra.html#frequency-spectrum-with-fft"><i class="fa fa-check"></i><b>5.2</b> Frequency spectrum with FFT</a></li>
<li class="chapter" data-level="5.3" data-path="spectra.html"><a href="spectra.html#multiresolution-decomposition-mrd"><i class="fa fa-check"></i><b>5.3</b> Multiresolution decomposition (MRD)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="spectra.html"><a href="spectra.html#calculating-multiresolution-decomposition-with-calc_mrd"><i class="fa fa-check"></i><b>5.3.1</b> Calculating multiresolution decomposition with <code>calc_mrd</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="spectra.html"><a href="spectra.html#plotting-multiresolution-decomposition-with-plot_mrd"><i class="fa fa-check"></i><b>5.3.2</b> Plotting multiresolution decomposition with <code>plot_mrd</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="spectra.html"><a href="spectra.html#ogives"><i class="fa fa-check"></i><b>5.4</b> Ogives</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html"><i class="fa fa-check"></i><b>6</b> Reynolds stress tensor</a>
<ul>
<li class="chapter" data-level="6.1" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#invariant-analysis-of-the-reynolds-stress-tensor"><i class="fa fa-check"></i><b>6.1</b> Invariant analysis of the Reynolds stress tensor</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#performing-the-invariant-analysis-of-the-reynolds-stress-tensor-with-calc_anisotropy"><i class="fa fa-check"></i><b>6.1.1</b> Performing the invariant analysis of the Reynolds stress tensor with <code>calc_anisotropy</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#plotting-the-barycentric-map-using-plot_barycentric_map"><i class="fa fa-check"></i><b>6.1.2</b> Plotting the barycentric map using <code>plot_barycentric_map</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#anisotropy-and-velocity-aspect-ratio-var"><i class="fa fa-check"></i><b>6.2</b> Anisotropy and velocity aspect ratio (VAR)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="flux-footprint.html"><a href="flux-footprint.html"><i class="fa fa-check"></i><b>7</b> Flux footprint</a>
<ul>
<li class="chapter" data-level="7.1" data-path="flux-footprint.html"><a href="flux-footprint.html#flux-footprint-parametrizations"><i class="fa fa-check"></i><b>7.1</b> Flux footprint parametrizations</a></li>
<li class="chapter" data-level="7.2" data-path="flux-footprint.html"><a href="flux-footprint.html#d-flux-footprint-estimate"><i class="fa fa-check"></i><b>7.2</b> 2D flux footprint estimate</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="flux-footprint.html"><a href="flux-footprint.html#calculate-2d-flux-footprint-estimate-with-calc_flux_footprint"><i class="fa fa-check"></i><b>7.2.1</b> Calculate 2D flux footprint estimate with <code>calc_flux_footprint</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="flux-footprint.html"><a href="flux-footprint.html#plotting-of-flux-footprint-with-plot_flux_footprint"><i class="fa fa-check"></i><b>7.2.2</b> Plotting of flux footprint with <code>plot_flux_footprint</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="flux-footprint.html"><a href="flux-footprint.html#flux-footprint-climatology"><i class="fa fa-check"></i><b>7.3</b> Flux footprint climatology</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html"><i class="fa fa-check"></i><b>8</b> Surface energy balance</a>
<ul>
<li class="chapter" data-level="8.1" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#surface-energy-balance-closure"><i class="fa fa-check"></i><b>8.1</b> Surface energy balance closure</a></li>
<li class="chapter" data-level="8.2" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#calculating-surface-energy-balance"><i class="fa fa-check"></i><b>8.2</b> Calculating surface energy balance</a></li>
<li class="chapter" data-level="8.3" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#hydrological-measures-bowen-ratio-and-evaporative-fraction"><i class="fa fa-check"></i><b>8.3</b> Hydrological measures: Bowen ratio and evaporative fraction</a></li>
<li class="chapter" data-level="8.4" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#meteorological-contextualization"><i class="fa fa-check"></i><b>8.4</b> Meteorological contextualization</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown <br>(Laura Mack, 2025)</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reddy: A toolbox for analyzing eddy-covariance measurements</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reynolds-stress-tensor" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Reynolds stress tensor<a href="reynolds-stress-tensor.html#reynolds-stress-tensor" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The Reynolds stress tensor
<span class="math display">\[ R := \overline{u_i &#39; u_j &#39;} = \begin{pmatrix}
            u&#39;^2 &amp; \overline{u&#39;v&#39;} &amp; \overline{u&#39;w&#39;} \\
            \overline{v&#39;u&#39;} &amp; v&#39;^2 &amp; \overline{v&#39;w&#39;} \\
            \overline{w&#39;u&#39;} &amp; \overline{w&#39;v&#39;} &amp; w&#39;^2 
        \end{pmatrix}, \quad \textrm{with} \quad R = R^T\]</span>
summarizes all normal and shear stresses. Based on an invariant analysis, the most important geometric properties can be derived from its eigenvalues and eigenvectors. Using a linear combination of the three eigenvalues, a two-dimensional mapping into an equilateral triangle – called <em>barycentric map</em> (<span class="citation">Banerjee et al. (<a href="#ref-Banerjee2007" role="doc-biblioref">2007</a>)</span>, see figure) – with the coordinates <span class="math inline">\((x_B,y_B)\)</span>, can be constructed, which allows to characterize the anisotropy (<span class="math inline">\(y_B\)</span>) and the limiting states. The three corners of the triangle represent the three limiting state 1-, 2- and 3-component limit, where the 3-component limit corresponds to isotropic turbulence.
The 2-component limit represents “disk-like” turbulence associated with strong wind shear and the 1-component limit “rod-like” turbulence, which is related to wave-like motions, e.g. internal gravity waves.</p>
<p><img src="figures/schema/triangle_schema.png" width=550 /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="reynolds-stress-tensor.html#cb36-1" aria-hidden="true"></a><span class="co">#loading Reddy package</span></span>
<span id="cb36-2"><a href="reynolds-stress-tensor.html#cb36-2" aria-hidden="true"></a><span class="kw">install.packages</span>(<span class="st">&quot;../src/Reddy_0.0.0.9000.tar.gz&quot;</span>,<span class="dt">repos=</span><span class="ot">NULL</span>,<span class="dt">source=</span><span class="ot">TRUE</span>,<span class="dt">quiet=</span><span class="ot">TRUE</span>)</span>
<span id="cb36-3"><a href="reynolds-stress-tensor.html#cb36-3" aria-hidden="true"></a><span class="kw">library</span>(Reddy)</span>
<span id="cb36-4"><a href="reynolds-stress-tensor.html#cb36-4" aria-hidden="true"></a></span>
<span id="cb36-5"><a href="reynolds-stress-tensor.html#cb36-5" aria-hidden="true"></a><span class="co">#read in processed example data</span></span>
<span id="cb36-6"><a href="reynolds-stress-tensor.html#cb36-6" aria-hidden="true"></a>dat=<span class="kw">readRDS</span>(<span class="st">&quot;../data/ec-data_30min_processed/processed_data_example.rds&quot;</span>)</span></code></pre></div>
<div id="invariant-analysis-of-the-reynolds-stress-tensor" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Invariant analysis of the Reynolds stress tensor<a href="reynolds-stress-tensor.html#invariant-analysis-of-the-reynolds-stress-tensor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="performing-the-invariant-analysis-of-the-reynolds-stress-tensor-with-calc_anisotropy" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Performing the invariant analysis of the Reynolds stress tensor with <code>calc_anisotropy</code><a href="reynolds-stress-tensor.html#performing-the-invariant-analysis-of-the-reynolds-stress-tensor-with-calc_anisotropy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The function <code>calc_anisotropy</code> calculates the invariant analysis and takes for this vectors for all six independent components of the Reynolds stress tensor as input (since it is symmetric there are only six not nine independent entries) in the form
<span class="math display">\[ R  = \begin{pmatrix}
            a_{11} &amp; a_{12} &amp; a_{13}\\
            a_{12} &amp; a_{22} &amp; a_{23} \\
            a_{13} &amp; a_{23} &amp; a_{33} 
        \end{pmatrix}
\]</span>
and in the order <span class="math inline">\(a_{11}, a_{12}, a_{13}, a_{22}, a_{23}, a_{33}\)</span>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="reynolds-stress-tensor.html#cb37-1" aria-hidden="true"></a>rey_ana =<span class="st"> </span><span class="kw">calc_anisotropy</span>(dat<span class="op">$</span>u_sd<span class="op">^</span><span class="dv">2</span>,dat<span class="op">$</span>cov_uv,dat<span class="op">$</span>cov_uw,dat<span class="op">$</span>v_sd<span class="op">^</span><span class="dv">2</span>,dat<span class="op">$</span>cov_vw,dat<span class="op">$</span>w_sd<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb37-2"><a href="reynolds-stress-tensor.html#cb37-2" aria-hidden="true"></a><span class="kw">str</span>(rey_ana)</span></code></pre></div>
<pre><code>List of 6
 $ xb          : num [1:127] 0.348 0.249 0.326 0.257 0.188 ...
 $ yb          : num [1:127] 0.119 0.124 0.101 0.103 0.117 ...
 $ eta         : num [1:127] 0.165 0.152 0.166 0.157 0.148 ...
 $ xi          : num [1:127] -0.0562 -0.1214 -0.0821 -0.1202 -0.1353 ...
 $ eigenvalues : num [1:127, 1:3] 0.283 0.232 0.281 0.245 0.204 ...
 $ eigenvectors: num [1:127, 1:3, 1:3] 0.89759 0.93931 0.86082 0.00664 -0.64731 ...</code></pre>
<p>The output contains the coordinates of the barycentric map (<code>xb, yb</code>) and of the Lumley triangle (<code>eta, xi</code>) as well as all eigenvalues and eigenvectors.</p>
</div>
<div id="plotting-the-barycentric-map-using-plot_barycentric_map" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Plotting the barycentric map using <code>plot_barycentric_map</code><a href="reynolds-stress-tensor.html#plotting-the-barycentric-map-using-plot_barycentric_map" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The function <code>plot_barycentric_map</code> takes <code>xb, yb</code> as input (as calculated in the invariant analysis before) and plots them in the barycentric map.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="reynolds-stress-tensor.html#cb39-1" aria-hidden="true"></a><span class="kw">plot_barycentric_map</span>(rey_ana<span class="op">$</span>xb,rey_ana<span class="op">$</span>yb)</span></code></pre></div>
<p><img src="figures/fig_0701.png" width="500" /></p>
<p>The three corners of the tringle represent the three limiting state: 3-component limit (isotropic, “sphere-like”) at <span class="math inline">\((0.5,\sqrt{3}/2\)</span>), 2-component limit (“disk-like”) at <span class="math inline">\((0,0)\)</span> and 1-component limit (“rod-like”) at <span class="math inline">\((1,0)\)</span>. <span class="math inline">\(y_B\)</span> is a measure for anisotropy – from <span class="math inline">\(y_B = 0\)</span> completely anisotropic to <span class="math inline">\(y_B = \sqrt(3)/2\)</span> perfectly isotropic. <br>
Anisotropy leads to deviations from classical scaling functions used in Monin-Obukhov similarity theory, e.g. <span class="citation">Stiperski, Calaf, and Rotach (<a href="#ref-Stiperski2019" role="doc-biblioref">2019</a>)</span> and <span class="citation">Stiperski and Calaf (<a href="#ref-Stiperski2022" role="doc-biblioref">2023</a>)</span>.</p>
</div>
</div>
<div id="anisotropy-and-velocity-aspect-ratio-var" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Anisotropy and velocity aspect ratio (VAR)<a href="reynolds-stress-tensor.html#anisotropy-and-velocity-aspect-ratio-var" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The velocity aspect ratio VAR (<code>calc_var</code>) is an approximation of anisotropy that only takes the diagonal elements of the Reynolds stress tensor, i.e., <span class="math inline">\(\sigma_u, \sigma_v,\sigma_w\)</span>, into account <span class="citation">(Mahrt <a href="#ref-Mahrt2010" role="doc-biblioref">2010</a>)</span>. A deviation from a linear regression between VAR and <span class="math inline">\(y_B\)</span> allows quantify the effect of shear stresses. As seen in the plot below, for small values of <span class="math inline">\(y_B\)</span>, i.e., very anisotropic, is the deviation from the linear fit larger than for higher values of <span class="math inline">\(y_B\)</span>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="reynolds-stress-tensor.html#cb40-1" aria-hidden="true"></a>var=<span class="kw">calc_var</span>(dat<span class="op">$</span>u_sd,dat<span class="op">$</span>v_sd,dat<span class="op">$</span>w_sd)</span>
<span id="cb40-2"><a href="reynolds-stress-tensor.html#cb40-2" aria-hidden="true"></a><span class="kw">plot</span>(var,rey_ana<span class="op">$</span>yb,<span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="dt">pch=</span><span class="dv">20</span>,<span class="dt">cex=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;VAR&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;yb&quot;</span>)</span>
<span id="cb40-3"><a href="reynolds-stress-tensor.html#cb40-3" aria-hidden="true"></a><span class="kw">grid</span>()</span>
<span id="cb40-4"><a href="reynolds-stress-tensor.html#cb40-4" aria-hidden="true"></a>fit=<span class="kw">lm</span>(rey_ana<span class="op">$</span>yb<span class="op">~</span>var)</span>
<span id="cb40-5"><a href="reynolds-stress-tensor.html#cb40-5" aria-hidden="true"></a><span class="kw">abline</span>(fit,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb40-6"><a href="reynolds-stress-tensor.html#cb40-6" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">summary</span>(fit))</span></code></pre></div>
<pre><code>Call:
lm(formula = rey_ana$yb ~ var)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.011421 -0.003373 -0.001110  0.003227  0.021316 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.08683    0.00265  -32.77   &lt;2e-16 ***
var          0.64442    0.00660   97.64   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.005629 on 125 degrees of freedom
Multiple R-squared:  0.9871,    Adjusted R-squared:  0.987 
F-statistic:  9534 on 1 and 125 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><img src="figures/fig_0702.png" width="500" /></p>

</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references hanging-indent">
<div id="ref-Banerjee2007">
<p>Banerjee, S., R. Krahl, F. Durst, and C. Zenger. 2007. “Presentation of anisotropy properties of turbulence, invariants versus eigenvalue approaches.” <em>J Turb</em> 8 (N32). <a href="https://doi.org/10.1080/14685240701506896">https://doi.org/10.1080/14685240701506896</a>.</p>
</div>
<div id="ref-Mahrt2010">
<p>Mahrt, L. 2010. “Variability and Maintenance of Turbulence in the Very Stable Boundary Layer.” <em>Boundary-Layer Meteorol</em> 135: 1–18. <a href="https://doi.org/10.1007/s10546-009-9463-6">https://doi.org/10.1007/s10546-009-9463-6</a>.</p>
</div>
<div id="ref-Stiperski2022">
<p>Stiperski, I., and M. Calaf. 2023. “Generalizing Monin-Obukhov similarity theory (1954) for complex atmospheric turbulence.” <em>Phys Rev Lett</em> 130. <a href="https://doi.org/10.48550/arXiv.2206.14592">https://doi.org/10.48550/arXiv.2206.14592</a>.</p>
</div>
<div id="ref-Stiperski2019">
<p>Stiperski, I., M. Calaf, and M. W. Rotach. 2019. “Scaling, Anisotropy, and Complexity in Near-Surface Atmospheric Turbulence.” <em>J Geophys Res Atmos</em> 124: 1428–48. <a href="https://doi.org/10.1029/2018JD029383">https://doi.org/10.1029/2018JD029383</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spectra.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="flux-footprint.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": null,
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  },
  "toc depth": 2,
  "github-repo": "noctiluc3nt/ec_analyze"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
