<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Turbulence parameterizations | Reddy: A toolbox for analyzing eddy-covariance measurements</title>
  <meta name="description" content="9 Turbulence parameterizations | Reddy: A toolbox for analyzing eddy-covariance measurements" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Turbulence parameterizations | Reddy: A toolbox for analyzing eddy-covariance measurements" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="noctiluc3nt/Reddy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Turbulence parameterizations | Reddy: A toolbox for analyzing eddy-covariance measurements" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="surface-energy-balance.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/noctiluc3nt/Reddy" target="blank"><bf>Reddy<bf></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#measurement-setup-and-instrumentation"><i class="fa fa-check"></i><b>1.1</b> Measurement setup and instrumentation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.2</b> Data sources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html"><i class="fa fa-check"></i><b>2</b> Post-processing of raw eddy-covariance data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#eddy-covariance-method"><i class="fa fa-check"></i><b>2.1</b> Eddy-covariance method</a></li>
<li class="chapter" data-level="2.2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#raw-data-handling-and-corrections"><i class="fa fa-check"></i><b>2.2</b> Raw data handling and corrections</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#choosing-a-suitable-averaging-time"><i class="fa fa-check"></i><b>2.2.1</b> Choosing a suitable averaging time</a></li>
<li class="chapter" data-level="2.2.2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#overview-of-correction-procedures-applied-to-the-raw-data"><i class="fa fa-check"></i><b>2.2.2</b> Overview of correction procedures applied to the raw data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#an-example-post-processing-routine"><i class="fa fa-check"></i><b>2.3</b> An example post-processing routine</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html"><i class="fa fa-check"></i><b>3</b> Turbulence diagnostics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#standard-turbulence-diagnostics-and-fluxes"><i class="fa fa-check"></i><b>3.1</b> Standard turbulence diagnostics and fluxes</a></li>
<li class="chapter" data-level="3.2" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#stability-dependence"><i class="fa fa-check"></i><b>3.2</b> Stability dependence</a></li>
<li class="chapter" data-level="3.3" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#turbulence-regimes-and-hockey-stick-model"><i class="fa fa-check"></i><b>3.3</b> Turbulence regimes and “Hockey-stick” model</a></li>
<li class="chapter" data-level="3.4" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#decoupling-metric"><i class="fa fa-check"></i><b>3.4</b> Decoupling metric</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html"><i class="fa fa-check"></i><b>4</b> Quadrant analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html#calculation-of-occurrence-frequencies-and-strengths-of-the-four-quadrants-with-calc_quadrant_analysis"><i class="fa fa-check"></i><b>4.1</b> Calculation of occurrence frequencies and strengths of the four quadrants with <code>calc_quadrant_analysis</code></a></li>
<li class="chapter" data-level="4.2" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html#plotting-quadrant-analysis-with-plot_quadrant_analysis"><i class="fa fa-check"></i><b>4.2</b> Plotting quadrant analysis with <code>plot_quadrant_analysis</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spectra.html"><a href="spectra.html"><i class="fa fa-check"></i><b>5</b> Spectra</a>
<ul>
<li class="chapter" data-level="5.1" data-path="spectra.html"><a href="spectra.html#spectral-analysis-of-timeseries"><i class="fa fa-check"></i><b>5.1</b> Spectral analysis of timeseries</a></li>
<li class="chapter" data-level="5.2" data-path="spectra.html"><a href="spectra.html#frequency-spectrum-with-fft"><i class="fa fa-check"></i><b>5.2</b> Frequency spectrum with FFT</a></li>
<li class="chapter" data-level="5.3" data-path="spectra.html"><a href="spectra.html#multiresolution-decomposition-mrd"><i class="fa fa-check"></i><b>5.3</b> Multiresolution decomposition (MRD)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="spectra.html"><a href="spectra.html#calculating-multiresolution-decomposition-with-calc_mrd"><i class="fa fa-check"></i><b>5.3.1</b> Calculating multiresolution decomposition with <code>calc_mrd</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="spectra.html"><a href="spectra.html#plotting-multiresolution-decomposition-with-plot_mrd"><i class="fa fa-check"></i><b>5.3.2</b> Plotting multiresolution decomposition with <code>plot_mrd</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="spectra.html"><a href="spectra.html#ogives"><i class="fa fa-check"></i><b>5.4</b> Ogives</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html"><i class="fa fa-check"></i><b>6</b> Reynolds stress tensor</a>
<ul>
<li class="chapter" data-level="6.1" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#invariant-analysis-of-the-reynolds-stress-tensor"><i class="fa fa-check"></i><b>6.1</b> Invariant analysis of the Reynolds stress tensor</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#performing-the-invariant-analysis-of-the-reynolds-stress-tensor-with-calc_anisotropy"><i class="fa fa-check"></i><b>6.1.1</b> Performing the invariant analysis of the Reynolds stress tensor with <code>calc_anisotropy</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#plotting-the-barycentric-map-using-plot_barycentric_map"><i class="fa fa-check"></i><b>6.1.2</b> Plotting the barycentric map using <code>plot_barycentric_map</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#anisotropy-and-velocity-aspect-ratio-var"><i class="fa fa-check"></i><b>6.2</b> Anisotropy and velocity aspect ratio (VAR)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="flux-footprint.html"><a href="flux-footprint.html"><i class="fa fa-check"></i><b>7</b> Flux footprint</a>
<ul>
<li class="chapter" data-level="7.1" data-path="flux-footprint.html"><a href="flux-footprint.html#flux-footprint-parametrizations"><i class="fa fa-check"></i><b>7.1</b> Flux footprint parametrizations</a></li>
<li class="chapter" data-level="7.2" data-path="flux-footprint.html"><a href="flux-footprint.html#d-flux-footprint-estimate"><i class="fa fa-check"></i><b>7.2</b> 2D flux footprint estimate</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="flux-footprint.html"><a href="flux-footprint.html#calculate-2d-flux-footprint-estimate-with-calc_flux_footprint"><i class="fa fa-check"></i><b>7.2.1</b> Calculate 2D flux footprint estimate with <code>calc_flux_footprint</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="flux-footprint.html"><a href="flux-footprint.html#plotting-of-flux-footprint-with-plot_flux_footprint"><i class="fa fa-check"></i><b>7.2.2</b> Plotting of flux footprint with <code>plot_flux_footprint</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="flux-footprint.html"><a href="flux-footprint.html#flux-footprint-climatology"><i class="fa fa-check"></i><b>7.3</b> Flux footprint climatology</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html"><i class="fa fa-check"></i><b>8</b> Surface energy balance</a>
<ul>
<li class="chapter" data-level="8.1" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#surface-energy-balance-closure"><i class="fa fa-check"></i><b>8.1</b> Surface energy balance closure</a></li>
<li class="chapter" data-level="8.2" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#calculating-surface-energy-balance"><i class="fa fa-check"></i><b>8.2</b> Calculating surface energy balance</a></li>
<li class="chapter" data-level="8.3" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#hydrological-measures-bowen-ratio-and-evaporative-fraction"><i class="fa fa-check"></i><b>8.3</b> Hydrological measures: Bowen ratio and evaporative fraction</a></li>
<li class="chapter" data-level="8.4" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#meteorological-contextualization"><i class="fa fa-check"></i><b>8.4</b> Meteorological contextualization</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="turbulence-parameterizations.html"><a href="turbulence-parameterizations.html"><i class="fa fa-check"></i><b>9</b> Turbulence parameterizations</a>
<ul>
<li class="chapter" data-level="9.1" data-path="turbulence-parameterizations.html"><a href="turbulence-parameterizations.html#flux-variance-relations"><i class="fa fa-check"></i><b>9.1</b> Flux-variance relations</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="turbulence-parameterizations.html"><a href="turbulence-parameterizations.html#example-latent-heat-flux-from-flux-variance-relation"><i class="fa fa-check"></i><b>9.1.1</b> Example: Latent heat flux from flux-variance relation</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="turbulence-parameterizations.html"><a href="turbulence-parameterizations.html#flux-profile-relations-and-vertical-profiles-of-temperature-and-wind-speed"><i class="fa fa-check"></i><b>9.2</b> Flux-profile relations and vertical profiles of temperature and wind speed</a></li>
<li class="chapter" data-level="9.3" data-path="turbulence-parameterizations.html"><a href="turbulence-parameterizations.html#using-nwp-model-output"><i class="fa fa-check"></i><b>9.3</b> Using NWP model output</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>10</b> References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown <br>(Laura Mack, 2025)</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reddy: A toolbox for analyzing eddy-covariance measurements</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="turbulence-parameterizations" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> Turbulence parameterizations<a href="turbulence-parameterizations.html#turbulence-parameterizations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The cornerstone of parameterizing turbulence in weather and climate models is Monin-Obukhov similarity theory (MOST, <span class="citation">Monin and Obukhov (<a href="#ref-Monin1954" role="doc-biblioref">1954</a>)</span>). This theory is derived from the TKE equation, assuming stationarity and homogeneity (and neglecting pressure fluctuations), and states that all dimensionless turbulent quantities can be expressed in terms of the stability parameter <span class="math inline">\(\zeta\)</span>. This has the consequence that subgrid-scale quantities, such as fluxes or turbulence intensities, can be parameterized (after normalization) in terms of static stability. Two MOST methods to parameterize fluxes are (1) flux-variance relations (used mainly in dispersion models) and (2) flux-profile relations (used in weather and climate models).</p>
<div id="flux-variance-relations" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Flux-variance relations<a href="turbulence-parameterizations.html#flux-variance-relations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Flux-variance relations follow from MOST, and relate the (temporal) variance (<span class="math inline">\(\sigma_x\)</span>) of a scalar (<span class="math inline">\(x\)</span>) to its vertical flux (<span class="math inline">\(\overline{w&#39;x&#39;}\)</span>) by</p>
<p><span class="math display">\[ \frac{\sigma_x}{x_*} = \Phi_x(\zeta) \quad \quad \textrm{with} \quad\quad x_* := \frac{\overline{w&#39;x&#39;}}{u_*}.  \]</span>
Thereby, <span class="math inline">\(\Phi_x(\zeta)\)</span> is a stability correction function that accounts for diabatic processes. Under neutral conditions, the so called integral turbulence quantities, i.e. <span class="math inline">\(\sigma_x/u_*\)</span>, are constant, so that there no stability correction is needed.
When measuring fluxes and variances with the eddy-covariance method, the functions <span class="math inline">\(\Phi_x(\zeta)\)</span> can be fitted to the observations, and are assumed to have a certain “universality”, so that they are transferable to other sites. This offers the possibility to then estimate the flux from the variance (and friction velocity and stability) by
<span class="math display">\[ \overline{w&#39;x&#39;} = \frac{\sigma_x \, u_*}{\Phi_x(\zeta)}. \]</span></p>
<p>Even though stability correction functions show some “universality”, recent studies found that the spread around stability correction function can be partly attributed to turbulence anisotropy (<span class="citation">Stiperski and Calaf (<a href="#ref-Stiperski2018" role="doc-biblioref">2018</a>)</span>) and flow organization (<span class="citation">Mack et al. (<a href="#ref-Mack2024" role="doc-biblioref">2024</a>)</span>), indicating that surface and flow properties are further important scaling parameters (additionally to <span class="math inline">\(\zeta\)</span>), particularly over complex terrain. <br>
In Reddy, the variable <span class="math inline">\(x_*\)</span> can be calculated with <code>calc_xstar</code>, and scaling functions for horizontal velocity (<span class="math inline">\(\Phi_u\)</span>, <code>scale_phiu</code>), vertical velocity (<span class="math inline">\(\Phi_w\)</span>, <code>scale_phiw</code>), temperature (<span class="math inline">\(\Phi_T\)</span>, <code>scale_phiT</code>) and passive scalar concentration (<span class="math inline">\(\Phi_c\)</span>, <code>scale_phic</code>) from different studies are available.</p>
<div id="example-latent-heat-flux-from-flux-variance-relation" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Example: Latent heat flux from flux-variance relation<a href="turbulence-parameterizations.html#example-latent-heat-flux-from-flux-variance-relation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Examplary, we calculate the latent heat flux using the flux-variance relation and compare it with the measured latent heat flux. As humididty is an ‘almost’ passive tracer, we use the scaling function for concentration (in Reddy <code>scale_phic</code>).</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="turbulence-parameterizations.html#cb65-1" aria-hidden="true"></a><span class="co">#loading Reddy package</span></span>
<span id="cb65-2"><a href="turbulence-parameterizations.html#cb65-2" aria-hidden="true"></a><span class="co">#install.packages(&quot;../src/Reddy_0.0.0.9000.tar.gz&quot;,repos=NULL,source=TRUE,quiet=TRUE)</span></span>
<span id="cb65-3"><a href="turbulence-parameterizations.html#cb65-3" aria-hidden="true"></a><span class="kw">library</span>(Reddy)</span>
<span id="cb65-4"><a href="turbulence-parameterizations.html#cb65-4" aria-hidden="true"></a><span class="kw">library</span>(latex2exp)</span>
<span id="cb65-5"><a href="turbulence-parameterizations.html#cb65-5" aria-hidden="true"></a></span>
<span id="cb65-6"><a href="turbulence-parameterizations.html#cb65-6" aria-hidden="true"></a><span class="co">#read in processed example data</span></span>
<span id="cb65-7"><a href="turbulence-parameterizations.html#cb65-7" aria-hidden="true"></a>dat=<span class="kw">readRDS</span>(<span class="st">&quot;../data/ec-data_30min_processed/processed_data_example.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="turbulence-parameterizations.html#cb66-1" aria-hidden="true"></a>ustar=<span class="kw">calc_ustar</span>(dat<span class="op">$</span>cov_uw)</span>
<span id="cb66-2"><a href="turbulence-parameterizations.html#cb66-2" aria-hidden="true"></a>L=<span class="kw">calc_L</span>(ustar,dat<span class="op">$</span>T_mean,dat<span class="op">$</span>cov_wT)</span>
<span id="cb66-3"><a href="turbulence-parameterizations.html#cb66-3" aria-hidden="true"></a>zeta=<span class="kw">calc_zeta</span>(<span class="fl">4.4</span>,L)</span>
<span id="cb66-4"><a href="turbulence-parameterizations.html#cb66-4" aria-hidden="true"></a><span class="co">#calculate cov(h2o,w) from the flux variance relation</span></span>
<span id="cb66-5"><a href="turbulence-parameterizations.html#cb66-5" aria-hidden="true"></a>cov_h2ow_fv=dat<span class="op">$</span>cov_h2ow<span class="op">*</span>ustar<span class="op">/</span><span class="kw">scale_phic</span>(zeta)</span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="turbulence-parameterizations.html#cb67-1" aria-hidden="true"></a><span class="co">#compare flux-variance relation with measured latent heat flux</span></span>
<span id="cb67-2"><a href="turbulence-parameterizations.html#cb67-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">cov2lh</span>(cov_h2ow_fv),<span class="kw">cov2lh</span>(dat<span class="op">$</span>cov_h2ow),<span class="dt">pch=</span><span class="dv">20</span>,<span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="dt">cex=</span><span class="dv">2</span>,</span>
<span id="cb67-3"><a href="turbulence-parameterizations.html#cb67-3" aria-hidden="true"></a>     <span class="dt">xlab=</span><span class="kw">TeX</span>(<span class="st">&quot;LH [W/m$^2$] (from flux-variance relation)&quot;</span>),<span class="dt">ylab=</span><span class="kw">TeX</span>(<span class="st">&quot;LH [W/m$^2$] (measured)&quot;</span>),</span>
<span id="cb67-4"><a href="turbulence-parameterizations.html#cb67-4" aria-hidden="true"></a>     <span class="dt">main=</span><span class="st">&quot;Latent Heat Flux</span><span class="ch">\n</span><span class="st">Comparison: Flux-Variance Relation vs EC Measurement&quot;</span>)</span>
<span id="cb67-5"><a href="turbulence-parameterizations.html#cb67-5" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;red3&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb67-6"><a href="turbulence-parameterizations.html#cb67-6" aria-hidden="true"></a><span class="kw">grid</span>()</span>
<span id="cb67-7"><a href="turbulence-parameterizations.html#cb67-7" aria-hidden="true"></a>fit=<span class="kw">lm</span>(<span class="kw">cov2lh</span>(dat<span class="op">$</span>cov_h2ow) <span class="op">~</span><span class="st"> </span><span class="kw">cov2lh</span>(cov_h2ow_fv))</span>
<span id="cb67-8"><a href="turbulence-parameterizations.html#cb67-8" aria-hidden="true"></a><span class="kw">summary</span>(fit) <span class="co">#R^2 = 0.987</span></span></code></pre></div>
<pre><code>Call:
lm(formula = cov2lh(dat$cov_h2ow) ~ cov2lh(cov_h2ow_fv))

Residuals:
     Min       1Q   Median       3Q      Max 
-10.0789  -2.8135  -0.4376   3.1445   7.6008 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         4.386407   0.456952   9.599   &lt;2e-16 ***
cov2lh(cov_h2ow_fv) 0.813245   0.008209  99.067   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 3.838 on 124 degrees of freedom
  (1 observation deleted due to missingness)
Multiple R-squared:  0.9875,    Adjusted R-squared:  0.9874 
F-statistic:  9814 on 1 and 124 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><img src="figures/fig_0901.png" width="400" /></p>
<p>We see, that the agreement is generally quite good but deteriorates at higher fluxes (convective conditions). Here, we used the variance from the high-frequency gas analyzer measurements, but the method is also applicable if the measurement frequency of the concentration is lower.</p>
</div>
</div>
<div id="flux-profile-relations-and-vertical-profiles-of-temperature-and-wind-speed" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Flux-profile relations and vertical profiles of temperature and wind speed<a href="turbulence-parameterizations.html#flux-profile-relations-and-vertical-profiles-of-temperature-and-wind-speed" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In numerical weather prediction or climate models, the fluxes between surface and atmosphere are parametrized in terms of the vertical gradient (bulk closure). The vertical gradients of wind speed and (potential) temperature can be calculated using flux-profile relations:</p>
<p>for wind speed/momentum:
<span class="math display">\[ \frac{dU}{dz} = \frac{u_*}{\kappa z} \Phi_m(\zeta)\]</span>
for temperature/heat:
<span class="math display">\[ \frac{dT}{dz} = \frac{T_*}{\kappa z} \Phi_h(\zeta)\]</span></p>
<p>In Reddy, <span class="math inline">\(\Phi_m\)</span> and <span class="math inline">\(\Phi_h\)</span> can be calculated with <code>calc_phim, calc_phih</code> (from rearranging the above equations) or the respective scaling functions from literature, that are applied in NWP models, can be used by <code>scale_phim, scale_phih</code>. <br>
Integrating the flux-profile relations w.r.t. height allows to retrieve <span class="math inline">\(U\)</span> and <span class="math inline">\(T\)</span> as function of <span class="math inline">\(z\)</span>:</p>
<p>wind speed profile:
<span class="math display">\[ U(z) = \frac{u_*}{\kappa}( \ln(\frac{z}{z_0})-\Psi_m(\zeta)) \]</span>
temperature profile:
<span class="math display">\[ T(z) = T_0 + \frac{u_*}{\kappa}(\ln(\frac{z}{z_0})-\Psi_h(\zeta)) \]</span></p>
<p>Thereby, <span class="math inline">\(\Psi_m\)</span> and <span class="math inline">\(\Psi_h\)</span> are the integral forms of <span class="math inline">\(\Phi_m\)</span> and <span class="math inline">\(\Phi_h\)</span>.</p>
</div>
<div id="using-nwp-model-output" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Using NWP model output<a href="turbulence-parameterizations.html#using-nwp-model-output" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Reddy package also provides functions to work with output from numerical weather prediction models, e.g. converting different types of vertical levels (e.g. <code>sigma2height, height2pres</code>), find closest grid points to station locations (<code>find_closest_grid_point</code>), calculate derivative (<code>df_dx,df_dy</code>) and to deaccumulate model fluxes (<code>deaccumulate1h</code>). By applying Taylor hypothesis, time differences can be converted to spatial differences using the function <code>dt2dx_taylor</code>. <br>
The stability parameter <span class="math inline">\(\zeta\)</span> (only requires point measurements) can be converted to Richardson number (usually used in NWP models) with the function <code>zeta2Ri</code> using the empirical relation</p>
<p><span class="math display">\[Ri(\zeta) = 0.74 \zeta \cdot \frac{\sqrt{1-15\zeta}}{\sqrt{1-9\zeta}}.\]</span></p>

</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references hanging-indent">
<div id="ref-Mack2024">
<p>Mack, L., T. K. Berntsen, N. Vercauteren, and N. Pirk. 2024. “Transfer Efficiency and Organization in Turbulent Transport over Alpine Tundra.” <em>Boundary-Layer Meteorol</em> 190 (38). <a href="https://doi.org/10.1007/s10546-024-00879-5">https://doi.org/10.1007/s10546-024-00879-5</a>.</p>
</div>
<div id="ref-Monin1954">
<p>Monin, A. S., and A. M. Obukhov. 1954. “Basic laws of turbulent mixing in the surface layer of the atmosphere.” <em>Tr Akad Nauk SSSR Geophiz Inst</em> 24 (151): 163–87.</p>
</div>
<div id="ref-Stiperski2018">
<p>Stiperski, I., and M. Calaf. 2018. “Dependence of near-surface similarity scaling on the anisotropy of atmospheric turbulence.” <em>Q J R Meteorol Soc</em> 144: 641–57. <a href="https://doi.org/10.1002/qj.3224">https://doi.org/10.1002/qj.3224</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="surface-energy-balance.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": null,
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  },
  "toc depth": 2,
  "github-repo": "noctiluc3nt/ec_analyze"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
