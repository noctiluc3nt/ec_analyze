<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Calculation of some basic turbulence quantities | Introduction</title>
  <meta name="description" content="3 Calculation of some basic turbulence quantities | Introduction" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Calculation of some basic turbulence quantities | Introduction" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Calculation of some basic turbulence quantities | Introduction" />
  
  
  

<meta name="author" content="" />


<meta name="date" content="2024-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="step-1-post-processing-of-the-raw-eddy-covariance-data.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Field Tutorials</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a></li>
<li class="chapter" data-level="2" data-path="step-1-post-processing-of-the-raw-eddy-covariance-data.html"><a href="step-1-post-processing-of-the-raw-eddy-covariance-data.html"><i class="fa fa-check"></i><b>2</b> Step 1: Post-processing of the raw eddy-covariance data</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="step-1-post-processing-of-the-raw-eddy-covariance-data.html"><a href="step-1-post-processing-of-the-raw-eddy-covariance-data.html#eddy-covariance-method"><i class="fa fa-check"></i><b>2.0.1</b> Eddy-covariance method</a></li>
<li class="chapter" data-level="2.0.2" data-path="step-1-post-processing-of-the-raw-eddy-covariance-data.html"><a href="step-1-post-processing-of-the-raw-eddy-covariance-data.html#literature"><i class="fa fa-check"></i><b>2.0.2</b> Literature</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="calculation-of-some-basic-turbulence-quantities.html"><a href="calculation-of-some-basic-turbulence-quantities.html"><i class="fa fa-check"></i><b>3</b> Calculation of some basic turbulence quantities</a>
<ul>
<li class="chapter" data-level="3.1" data-path="calculation-of-some-basic-turbulence-quantities.html"><a href="calculation-of-some-basic-turbulence-quantities.html#calculation-of-standard-turbulence-diagnostics-and-simple-timeseries-plots"><i class="fa fa-check"></i><b>3.1</b> Calculation of standard turbulence diagnostics and simple timeseries plots</a></li>
<li class="chapter" data-level="3.2" data-path="calculation-of-some-basic-turbulence-quantities.html"><a href="calculation-of-some-basic-turbulence-quantities.html#regime-plots"><i class="fa fa-check"></i><b>3.2</b> Regime plots</a></li>
<li class="chapter" data-level="3.3" data-path="calculation-of-some-basic-turbulence-quantities.html"><a href="calculation-of-some-basic-turbulence-quantities.html#stability-dependence-with-discrete-binning-binning"><i class="fa fa-check"></i><b>3.3</b> Stability dependence with discrete binning (<code>binning</code>)</a></li>
<li class="chapter" data-level="3.4" data-path="calculation-of-some-basic-turbulence-quantities.html"><a href="calculation-of-some-basic-turbulence-quantities.html#literature-1"><i class="fa fa-check"></i><b>3.4</b> Literature</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="calculation-of-some-basic-turbulence-quantities" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Calculation of some basic turbulence quantities<a href="calculation-of-some-basic-turbulence-quantities.html#calculation-of-some-basic-turbulence-quantities" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Based on the half-hourly output of the first notebook (<a href="https://github.com/noctiluc3nt/ec_analyze/blob/main/notebooks/01_post-processing.ipynb">01_post-processing.ipynb</a>) some standard turbulence quantities, i.e. stability parameter, friction velocity, TKE, turbulence intensity are calculated and plotted.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="calculation-of-some-basic-turbulence-quantities.html#cb9-1" tabindex="-1"></a><span class="co">#loading Reddy package</span></span>
<span id="cb9-2"><a href="calculation-of-some-basic-turbulence-quantities.html#cb9-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;../src/Reddy_0.0.0.9000.tar.gz&quot;</span>,<span class="at">repos=</span><span class="cn">NULL</span>,<span class="at">source=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-3"><a href="calculation-of-some-basic-turbulence-quantities.html#cb9-3" tabindex="-1"></a><span class="fu">library</span>(Reddy)</span>
<span id="cb9-4"><a href="calculation-of-some-basic-turbulence-quantities.html#cb9-4" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb9-5"><a href="calculation-of-some-basic-turbulence-quantities.html#cb9-5" tabindex="-1"></a>kap<span class="ot">=</span><span class="cf">function</span>() <span class="fu">return</span>(<span class="fl">0.4</span>)</span></code></pre></div>
<pre><code>Installing package into ‘/home/lauracma/R/x86_64-pc-linux-gnu-library/4.0’
(as ‘lib’ is unspecified)</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="calculation-of-some-basic-turbulence-quantities.html#cb11-1" tabindex="-1"></a><span class="co">#read in processed example data</span></span>
<span id="cb11-2"><a href="calculation-of-some-basic-turbulence-quantities.html#cb11-2" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">readRDS</span>(<span class="st">&quot;../data/ec-data_30min_processed/processed_data_example.rds&quot;</span>)</span></code></pre></div>
<div id="calculation-of-standard-turbulence-diagnostics-and-simple-timeseries-plots" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Calculation of standard turbulence diagnostics and simple timeseries plots<a href="calculation-of-some-basic-turbulence-quantities.html#calculation-of-standard-turbulence-diagnostics-and-simple-timeseries-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here, some functions from the Reddy package are used to calculate turbulent kinetic energy <span class="math inline">\(TKE\)</span>, velocity scale of TKE <span class="math inline">\(V_{TKE}\)</span>, horizontal turbulence intensity <span class="math inline">\(TI\)</span>, vertical turbulence intensity <span class="math inline">\(I_w\)</span>, friction velocity <span class="math inline">\(u_*\)</span>, Obukhov length <span class="math inline">\(L\)</span>, stability parameter <span class="math inline">\(\zeta\)</span> and directional shear angle and plot their timeseries for the previously post-processed example data.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="calculation-of-some-basic-turbulence-quantities.html#cb12-1" tabindex="-1"></a><span class="co">#calculation of some useful turbulence diagnostics</span></span>
<span id="cb12-2"><a href="calculation-of-some-basic-turbulence-quantities.html#cb12-2" tabindex="-1"></a>dat<span class="sc">$</span>tke<span class="ot">=</span><span class="fu">calc_tke</span>(dat<span class="sc">$</span>u_sd,dat<span class="sc">$</span>v_sd,dat<span class="sc">$</span>w_sd)</span>
<span id="cb12-3"><a href="calculation-of-some-basic-turbulence-quantities.html#cb12-3" tabindex="-1"></a>dat<span class="sc">$</span>vtke<span class="ot">=</span><span class="fu">calc_vtke</span>(dat<span class="sc">$</span>u_sd,dat<span class="sc">$</span>v_sd,dat<span class="sc">$</span>w_sd)</span>
<span id="cb12-4"><a href="calculation-of-some-basic-turbulence-quantities.html#cb12-4" tabindex="-1"></a>dat<span class="sc">$</span>ti<span class="ot">=</span><span class="fu">calc_ti</span>(dat<span class="sc">$</span>u_sd,dat<span class="sc">$</span>v_sd,dat<span class="sc">$</span>ws_mean)</span>
<span id="cb12-5"><a href="calculation-of-some-basic-turbulence-quantities.html#cb12-5" tabindex="-1"></a>dat<span class="sc">$</span>iw<span class="ot">=</span><span class="fu">calc_iw</span>(dat<span class="sc">$</span>w_sd,dat<span class="sc">$</span>ws_mean)</span>
<span id="cb12-6"><a href="calculation-of-some-basic-turbulence-quantities.html#cb12-6" tabindex="-1"></a>dat<span class="sc">$</span>ustar<span class="ot">=</span><span class="fu">calc_ustar</span>(dat<span class="sc">$</span>cov_uw,dat<span class="sc">$</span>cov_vw)</span>
<span id="cb12-7"><a href="calculation-of-some-basic-turbulence-quantities.html#cb12-7" tabindex="-1"></a>dat<span class="sc">$</span>L<span class="ot">=</span><span class="fu">calc_L</span>(dat<span class="sc">$</span>ustar,dat<span class="sc">$</span>T_mean,dat<span class="sc">$</span>cov_wT)</span>
<span id="cb12-8"><a href="calculation-of-some-basic-turbulence-quantities.html#cb12-8" tabindex="-1"></a>dat<span class="sc">$</span>zeta<span class="ot">=</span><span class="fu">calc_zeta</span>(<span class="fl">4.4</span>,dat<span class="sc">$</span>L)</span>
<span id="cb12-9"><a href="calculation-of-some-basic-turbulence-quantities.html#cb12-9" tabindex="-1"></a>dat<span class="sc">$</span>alpha_uw<span class="ot">=</span><span class="fu">calc_dshear</span>(dat<span class="sc">$</span>cov_uw,dat<span class="sc">$</span>cov_vw)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="calculation-of-some-basic-turbulence-quantities.html#cb13-1" tabindex="-1"></a><span class="co">#basic timeseries plots</span></span>
<span id="cb13-2"><a href="calculation-of-some-basic-turbulence-quantities.html#cb13-2" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>T_mean,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;temperature [°C]&quot;</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb13-3"><a href="calculation-of-some-basic-turbulence-quantities.html#cb13-3" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>ws_mean,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;wind speed [m/s]&quot;</span>)</span>
<span id="cb13-4"><a href="calculation-of-some-basic-turbulence-quantities.html#cb13-4" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>tke,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="fu">TeX</span>(<span class="st">&quot;TKE [$m^2/s^2$]&quot;</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb13-5"><a href="calculation-of-some-basic-turbulence-quantities.html#cb13-5" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>zeta,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;stability parameter [-]&quot;</span>)</span>
<span id="cb13-6"><a href="calculation-of-some-basic-turbulence-quantities.html#cb13-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb13-7"><a href="calculation-of-some-basic-turbulence-quantities.html#cb13-7" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>ti,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;turbulence intensity [-]&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb13-8"><a href="calculation-of-some-basic-turbulence-quantities.html#cb13-8" tabindex="-1"></a><span class="fu">points</span>(dat<span class="sc">$</span>iw,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;gray50&quot;</span>)</span>
<span id="cb13-9"><a href="calculation-of-some-basic-turbulence-quantities.html#cb13-9" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>cov_uw,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="fu">TeX</span>(<span class="st">&quot;cov(u,w) [$m^2/s^2$]&quot;</span>))</span>
<span id="cb13-10"><a href="calculation-of-some-basic-turbulence-quantities.html#cb13-10" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>cov_wT,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="fu">TeX</span>(<span class="st">&quot;cov(T,w) [$K m/s$]&quot;</span>))</span>
<span id="cb13-11"><a href="calculation-of-some-basic-turbulence-quantities.html#cb13-11" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>cov_h2ow,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="fu">TeX</span>(<span class="st">&quot;cov(q,w) [$mmol m/s$]&quot;</span>))</span>
<span id="cb13-12"><a href="calculation-of-some-basic-turbulence-quantities.html#cb13-12" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>cov_co2w,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="fu">TeX</span>(<span class="st">&quot;cov(c,w) [$ppm m/s$]&quot;</span>))</span></code></pre></div>
<div class="float">
<img src="output_5_0.png" alt="png" />
<div class="figcaption">png</div>
</div>
<div class="float">
<img src="output_5_1.png" alt="png" />
<div class="figcaption">png</div>
</div>
<div class="float">
<img src="output_5_2.png" alt="png" />
<div class="figcaption">png</div>
</div>
<div class="float">
<img src="output_5_3.png" alt="png" />
<div class="figcaption">png</div>
</div>
<div class="float">
<img src="output_5_4.png" alt="png" />
<div class="figcaption">png</div>
</div>
<div class="float">
<img src="output_5_5.png" alt="png" />
<div class="figcaption">png</div>
</div>
<div class="float">
<img src="output_5_6.png" alt="png" />
<div class="figcaption">png</div>
</div>
<div class="float">
<img src="output_5_7.png" alt="png" />
<div class="figcaption">png</div>
</div>
<div class="float">
<img src="output_5_8.png" alt="png" />
<div class="figcaption">png</div>
</div>
</div>
<div id="regime-plots" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Regime plots<a href="calculation-of-some-basic-turbulence-quantities.html#regime-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To diagnose different turbulence regimes, scatter plots of different turbulence diagnostics can be used. Here are some examples plotting wind speed vs TKE or stability parameter vs TKE (see e.g., Sun et al., 2012).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="calculation-of-some-basic-turbulence-quantities.html#cb14-1" tabindex="-1"></a><span class="co">#some basic plots</span></span>
<span id="cb14-2"><a href="calculation-of-some-basic-turbulence-quantities.html#cb14-2" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>ws_mean,dat<span class="sc">$</span>tke,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">xlab=</span><span class="st">&quot;wind speed [m/s]&quot;</span>,<span class="at">ylab=</span><span class="fu">TeX</span>(<span class="st">&quot;TKE [$m^2/s^2$]&quot;</span>))</span>
<span id="cb14-3"><a href="calculation-of-some-basic-turbulence-quantities.html#cb14-3" tabindex="-1"></a>cond<span class="ot">=</span>(dat<span class="sc">$</span>ws_mean<span class="sc">&gt;</span><span class="dv">2</span>)</span>
<span id="cb14-4"><a href="calculation-of-some-basic-turbulence-quantities.html#cb14-4" tabindex="-1"></a>fit<span class="ot">=</span><span class="fu">lm</span>(dat<span class="sc">$</span>tke[cond]<span class="sc">~</span>dat<span class="sc">$</span>ws_mean[cond])</span>
<span id="cb14-5"><a href="calculation-of-some-basic-turbulence-quantities.html#cb14-5" tabindex="-1"></a><span class="fu">abline</span>(fit,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb14-6"><a href="calculation-of-some-basic-turbulence-quantities.html#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="calculation-of-some-basic-turbulence-quantities.html#cb14-7" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>zeta,dat<span class="sc">$</span>tke,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">xlab=</span><span class="st">&quot;stability parameter [m/s]&quot;</span>,<span class="at">ylab=</span><span class="fu">TeX</span>(<span class="st">&quot;TKE [$m^2/s^2$]&quot;</span>))</span></code></pre></div>
<div class="float">
<img src="output_7_0.png" alt="png" />
<div class="figcaption">png</div>
</div>
<div class="float">
<img src="output_7_1.png" alt="png" />
<div class="figcaption">png</div>
</div>
</div>
<div id="stability-dependence-with-discrete-binning-binning" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Stability dependence with discrete binning (<code>binning</code>)<a href="calculation-of-some-basic-turbulence-quantities.html#stability-dependence-with-discrete-binning-binning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Often it is interesting to investigate the stability dependence of turbulence characteristics. For this the function <code>binning</code> can be used, which bins one variable based on another for predefined bins, as exemplified below for the dependence of the sensible heat flux on the stability parameter. The output contains mean, median, 25% and 75% quartile per discrete bin as dataframe. The used variables and the bins can be customized. Such type of analysis is usually applied to longer timeseries.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="calculation-of-some-basic-turbulence-quantities.html#cb15-1" tabindex="-1"></a>zeta_bins<span class="ot">=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span><span class="sc">^</span>(<span class="dv">2</span><span class="sc">:-</span><span class="dv">2</span>),<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">2</span>))</span>
<span id="cb15-2"><a href="calculation-of-some-basic-turbulence-quantities.html#cb15-2" tabindex="-1"></a>sh_binned<span class="ot">=</span><span class="fu">binning</span>(dat<span class="sc">$</span>sh,dat<span class="sc">$</span>zeta,zeta_bins)</span>
<span id="cb15-3"><a href="calculation-of-some-basic-turbulence-quantities.html#cb15-3" tabindex="-1"></a>sh_binned <span class="co">#look at output</span></span>
<span id="cb15-4"><a href="calculation-of-some-basic-turbulence-quantities.html#cb15-4" tabindex="-1"></a>xbins<span class="ot">=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span><span class="sc">^</span>(<span class="dv">2</span><span class="sc">:-</span><span class="dv">1</span>),<span class="dv">0</span>,<span class="dv">5</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>))</span>
<span id="cb15-5"><a href="calculation-of-some-basic-turbulence-quantities.html#cb15-5" tabindex="-1"></a><span class="fu">plot</span>(xbins,sh_binned[,<span class="dv">2</span>],<span class="at">type=</span><span class="st">&quot;b&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">150</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&quot;stability parameter [-]&quot;</span>,<span class="at">ylab=</span><span class="fu">TeX</span>(<span class="st">&quot;SH [W/m$^2$]&quot;</span>))</span>
<span id="cb15-6"><a href="calculation-of-some-basic-turbulence-quantities.html#cb15-6" tabindex="-1"></a><span class="fu">points</span>(xbins,sh_binned[,<span class="dv">3</span>],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb15-7"><a href="calculation-of-some-basic-turbulence-quantities.html#cb15-7" tabindex="-1"></a><span class="fu">points</span>(xbins,sh_binned[,<span class="dv">4</span>],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb15-8"><a href="calculation-of-some-basic-turbulence-quantities.html#cb15-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb15-9"><a href="calculation-of-some-basic-turbulence-quantities.html#cb15-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<table class="dataframe">
<caption>
A matrix: 9 × 4 of type dbl
</caption>
<tbody>
<tr>
<td>
122.045246
</td>
<td>
116.804837
</td>
<td>
109.052920
</td>
<td>
129.797163
</td>
</tr>
<tr>
<td>
120.620398
</td>
<td>
125.471467
</td>
<td>
75.448402
</td>
<td>
167.986972
</td>
</tr>
<tr>
<td>
17.306097
</td>
<td>
12.061651
</td>
<td>
5.647776
</td>
<td>
24.415438
</td>
</tr>
<tr>
<td>
1.823135
</td>
<td>
1.864732
</td>
<td>
1.093005
</td>
<td>
2.574063
</td>
</tr>
<tr>
<td>
NA
</td>
<td>
NA
</td>
<td>
NA
</td>
<td>
NA
</td>
</tr>
<tr>
<td>
-3.564331
</td>
<td>
-3.564331
</td>
<td>
-3.564331
</td>
<td>
-3.564331
</td>
</tr>
<tr>
<td>
-11.192381
</td>
<td>
-12.213284
</td>
<td>
-13.937180
</td>
<td>
-8.561890
</td>
</tr>
<tr>
<td>
-18.102981
</td>
<td>
-19.201199
</td>
<td>
-22.358905
</td>
<td>
-14.674265
</td>
</tr>
<tr>
<td>
-8.655841
</td>
<td>
-10.389901
</td>
<td>
-11.853905
</td>
<td>
-6.324807
</td>
</tr>
</tbody>
</table>
<div class="float">
<img src="output_9_1.png" alt="png" />
<div class="figcaption">png</div>
</div>
</div>
<div id="literature-1" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Literature<a href="calculation-of-some-basic-turbulence-quantities.html#literature-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Sun, J., Mahrt, L., Banta, R. M., and Pichugina, Y. L. (2012). Turbulence Regimes and Turbulence Intermittency in the Stable Boundary Layer during CASES-99. J Atmos Sci, 69:338–351.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="step-1-post-processing-of-the-raw-eddy-covariance-data.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"github-repo": "noctiluc3nt/ec_analyze"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
