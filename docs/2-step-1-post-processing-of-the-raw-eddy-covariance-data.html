<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="2 Step 1: Post-processing of the raw eddy-covariance data | Introduction" />
<meta property="og:type" content="book" />


<meta name="github-repo" content="openscapes/series" />

<meta name="author" content="" />

<meta name="date" content="2024-06-04" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="2 Step 1: Post-processing of the raw eddy-covariance data | Introduction">

<title>2 Step 1: Post-processing of the raw eddy-covariance data | Introduction</title>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if bootstrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#welcome" id="toc-welcome"><span class="toc-section-number">1</span> Welcome</a></li>
<li class="has-sub"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#step-1-post-processing-of-the-raw-eddy-covariance-data" id="toc-step-1-post-processing-of-the-raw-eddy-covariance-data"><span class="toc-section-number">2</span> Step 1: Post-processing of the raw eddy-covariance data</a>
<ul>
<li><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#eddy-covariance-method" id="toc-eddy-covariance-method"><span class="toc-section-number">2.0.1</span> Eddy-covariance method</a></li>
<li><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#literature" id="toc-literature"><span class="toc-section-number">2.0.2</span> Literature</a></li>
</ul></li>
<li class="has-sub"><a href="3-calculation-of-some-basic-turbulence-quantities.html#calculation-of-some-basic-turbulence-quantities" id="toc-calculation-of-some-basic-turbulence-quantities"><span class="toc-section-number">3</span> Calculation of some basic turbulence quantities</a>
<ul>
<li><a href="3.1-calculation-of-standard-turbulence-diagnostics-and-simple-timeseries-plots.html#calculation-of-standard-turbulence-diagnostics-and-simple-timeseries-plots" id="toc-calculation-of-standard-turbulence-diagnostics-and-simple-timeseries-plots"><span class="toc-section-number">3.1</span> Calculation of standard turbulence diagnostics and simple timeseries plots</a></li>
<li><a href="3.2-regime-plots.html#regime-plots" id="toc-regime-plots"><span class="toc-section-number">3.2</span> Regime plots</a></li>
<li><a href="3.3-stability-dependence-with-discrete-binning-binning.html#stability-dependence-with-discrete-binning-binning" id="toc-stability-dependence-with-discrete-binning-binning"><span class="toc-section-number">3.3</span> Stability dependence with discrete binning (<code>binning</code>)</a></li>
<li><a href="3.4-literature-1.html#literature-1" id="toc-literature-1"><span class="toc-section-number">3.4</span> Literature</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="step-1-post-processing-of-the-raw-eddy-covariance-data" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Step 1: Post-processing of the raw eddy-covariance data</h1>
<p>Example for basic post-processing of raw eddy-covariance measurements (from CSAT3/Campbell Scientific and Li-7200/LI-COR closed-path IR gas analyzer) including despiking, rotation, averaging and flagging. The following notebooks (e.g., <a href="https://github.com/noctiluc3nt/ec_analyze/blob/main/notebooks/02_basic-turbulence-diagnostics.ipynb">02_basic-turbulence-diagnostics.ipynb</a>) build upon this and allow for a more detailed analysis (e.g., <a href="https://github.com/noctiluc3nt/ec_analyze/blob/main/notebooks/03_quadrant-analysis.ipynb">03_quadrant-analysis.ipynb</a>).</p>
<div id="eddy-covariance-method" class="section level3" number="2.0.1">
<h3><span class="header-section-number">2.0.1</span> Eddy-covariance method</h3>
<p>In the eddy-covariance method, the Reynolds decomposition is applied to every measured quantity <span class="math inline">\(x\)</span> through
<span class="math display">\[
x = \overline{x} + x&#39; \quad \textrm{with} \quad \overline{x}:= \frac{1}{t_s} \int_0^{t_s} x \: dt,
\]</span>
where the ensemble average is replaced by a time average.
With the Reynolds postulates (in particular <span class="math inline">\(\overline{x&#39;} = 0\)</span>) it follows
<span class="math display">\[
    \overline{xw} = \overline{x}\:\overline{w} + \overline{x&#39;w&#39;},
\]</span>
where <span class="math inline">\(\overline{x&#39;w&#39;}\)</span> represents the vertical flux (<span class="math inline">\(w\)</span>: vertical wind speed) of the quantity <span class="math inline">\(x\)</span> with <span class="math inline">\(\overline{xw} = \overline{x&#39;w&#39;}\)</span> for <span class="math inline">\(\overline{w}=0\)</span> (which is intended by the applied coordinate rotation). In the post-processing, quality checks, rotation, averaging and flagging are applied, so that the high-resolution measurements can be analyzed using the eddy-covariance method. A detailed description of the measurement devices and methods can be found in Foken, 2017.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb1-1" tabindex="-1"></a><span class="co">#loading Reddy package</span></span>
<span id="cb1-2"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb1-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;../src/Reddy_0.0.0.9000.tar.gz&quot;</span>,<span class="at">repos=</span><span class="cn">NULL</span>,<span class="at">source=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(Reddy)</span></code></pre></div>
<pre><code>Installing package into ‘/home/lauracma/R/x86_64-pc-linux-gnu-library/4.0’
(as ‘lib’ is unspecified)</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb3-1" tabindex="-1"></a><span class="co">#ec data files</span></span>
<span id="cb3-2"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb3-2" tabindex="-1"></a>dir_in<span class="ot">=</span><span class="st">&quot;../data/ec-data_10Hz_raw&quot;</span></span>
<span id="cb3-3"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb3-3" tabindex="-1"></a>files<span class="ot">=</span><span class="fu">list.files</span>(dir_in,<span class="at">full.names=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-4"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb3-4" tabindex="-1"></a>nf<span class="ot">=</span><span class="fu">length</span>(files)</span></code></pre></div>
<p>Each given file contains 30 minutes of measurements, such that we just need to average over one file to get the 30 minutes averages and fluxes. However, in the notebook <a href="https://github.com/noctiluc3nt/ec_analyze/blob/main/notebooks/04_multiresolution-decomposition.ipynb">04_multiresolution-decomposition.ipynb</a> we will have a look at method that allows to determine suitable averaging times more accurately.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb4-1" tabindex="-1"></a><span class="co">#allocate output</span></span>
<span id="cb4-2"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb4-2" tabindex="-1"></a>var_out<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;time&quot;</span>,<span class="st">&quot;u_mean&quot;</span>,<span class="st">&quot;v_mean&quot;</span>,<span class="st">&quot;w_mean&quot;</span>,<span class="st">&quot;ws_mean&quot;</span>,<span class="st">&quot;wd_mean&quot;</span>,<span class="st">&quot;T_mean&quot;</span>,<span class="st">&quot;h2o_mean&quot;</span>,<span class="st">&quot;co2_mean&quot;</span>,</span>
<span id="cb4-3"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb4-3" tabindex="-1"></a>          <span class="st">&quot;u_sd&quot;</span>,<span class="st">&quot;v_sd&quot;</span>,<span class="st">&quot;w_sd&quot;</span>,<span class="st">&quot;T_sd&quot;</span>,<span class="st">&quot;h2o_sd&quot;</span>,<span class="st">&quot;co2_sd&quot;</span>,</span>
<span id="cb4-4"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb4-4" tabindex="-1"></a>          <span class="st">&quot;cov_uv&quot;</span>,<span class="st">&quot;cov_uw&quot;</span>,<span class="st">&quot;cov_vw&quot;</span>,<span class="st">&quot;cov_wT&quot;</span>,<span class="st">&quot;cov_h2ow&quot;</span>,<span class="st">&quot;cov_co2w&quot;</span>,<span class="st">&quot;cov_wT_snd&quot;</span>,<span class="st">&quot;cov_rhoH2Ow_wpl&quot;</span>,</span>
<span id="cb4-5"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb4-5" tabindex="-1"></a>          <span class="st">&quot;rot_angle1&quot;</span>,<span class="st">&quot;rot_angle2&quot;</span>,<span class="st">&quot;flag_stationarity&quot;</span>,<span class="st">&quot;flag_w&quot;</span>,<span class="st">&quot;flag_distortion&quot;</span>)</span>
<span id="cb4-6"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb4-6" tabindex="-1"></a>nv<span class="ot">=</span><span class="fu">length</span>(var_out)</span>
<span id="cb4-7"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb4-7" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">array</span>(<span class="cn">NA</span>,<span class="at">dim=</span><span class="fu">c</span>(nf,nv)))</span>
<span id="cb4-8"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb4-8" tabindex="-1"></a><span class="fu">colnames</span>(dat)<span class="ot">=</span>var_out</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-1" tabindex="-1"></a><span class="co">#postprocessing per file (30 mins)</span></span>
<span id="cb5-2"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nf) {</span>
<span id="cb5-3"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-3" tabindex="-1"></a>    tmp<span class="ot">=</span><span class="fu">read.table</span>(files[i],<span class="at">sep=</span><span class="st">&quot;,&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb5-4"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-4" tabindex="-1"></a>    dat<span class="sc">$</span>time[i]<span class="ot">=</span>tmp<span class="sc">$</span>X[<span class="dv">1</span>]</span>
<span id="cb5-5"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-5" tabindex="-1"></a>    <span class="co">#despiking</span></span>
<span id="cb5-6"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-6" tabindex="-1"></a>    tmp<span class="sc">$</span>T_degC<span class="ot">=</span><span class="fu">despiking</span>(tmp<span class="sc">$</span>T_degC,<span class="sc">-</span><span class="dv">40</span>,<span class="dv">30</span>)</span>
<span id="cb5-7"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-7" tabindex="-1"></a>    tmp<span class="sc">$</span>u_m.s<span class="ot">=</span><span class="fu">despiking</span>(tmp<span class="sc">$</span>u_m.s,<span class="sc">-</span><span class="dv">25</span>,<span class="dv">25</span>)</span>
<span id="cb5-8"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-8" tabindex="-1"></a>    tmp<span class="sc">$</span>v_m.s<span class="ot">=</span><span class="fu">despiking</span>(tmp<span class="sc">$</span>v_m.s,<span class="sc">-</span><span class="dv">25</span>,<span class="dv">25</span>)</span>
<span id="cb5-9"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-9" tabindex="-1"></a>    tmp<span class="sc">$</span>w_m.s<span class="ot">=</span><span class="fu">despiking</span>(tmp<span class="sc">$</span>w_m.s,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb5-10"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-10" tabindex="-1"></a>    <span class="co">#wind before rotation</span></span>
<span id="cb5-11"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-11" tabindex="-1"></a>    dat<span class="sc">$</span>ws_mean[i]<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">mean</span>(tmp<span class="sc">$</span>u_m.s,<span class="at">na.rm=</span>T)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="fu">mean</span>(tmp<span class="sc">$</span>v_m.s,<span class="at">na.rm=</span>T)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-12"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-12" tabindex="-1"></a>    dat<span class="sc">$</span>wd_mean[i]<span class="ot">=</span><span class="fu">atan2</span>(<span class="fu">mean</span>(tmp<span class="sc">$</span>v_m.s,<span class="at">na.rm=</span>T),<span class="fu">mean</span>(tmp<span class="sc">$</span>u_m.s,<span class="at">na.rm=</span>T))</span>
<span id="cb5-13"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-13" tabindex="-1"></a>    <span class="co">#rotation</span></span>
<span id="cb5-14"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-14" tabindex="-1"></a>    rot_wind<span class="ot">=</span><span class="fu">rotate_double</span>(tmp<span class="sc">$</span>u_m.s,tmp<span class="sc">$</span>v_m.s,tmp<span class="sc">$</span>w_m.s)</span>
<span id="cb5-15"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-15" tabindex="-1"></a>    tmp<span class="sc">$</span>u_m.s<span class="ot">=</span>rot_wind<span class="sc">$</span>u</span>
<span id="cb5-16"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-16" tabindex="-1"></a>    tmp<span class="sc">$</span>v_m.s<span class="ot">=</span>rot_wind<span class="sc">$</span>v</span>
<span id="cb5-17"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-17" tabindex="-1"></a>    tmp<span class="sc">$</span>w_m.s<span class="ot">=</span>rot_wind<span class="sc">$</span>w</span>
<span id="cb5-18"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-18" tabindex="-1"></a>    dat<span class="sc">$</span>rot_angle1[i]<span class="ot">=</span>rot_wind<span class="sc">$</span>theta</span>
<span id="cb5-19"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-19" tabindex="-1"></a>    dat<span class="sc">$</span>rot_angle2[i]<span class="ot">=</span>rot_wind<span class="sc">$</span>phi</span>
<span id="cb5-20"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-20" tabindex="-1"></a>    <span class="co">#averaging</span></span>
<span id="cb5-21"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-21" tabindex="-1"></a>    dat<span class="sc">$</span>u_mean[i]<span class="ot">=</span><span class="fu">mean</span>(tmp<span class="sc">$</span>u_m.s,<span class="at">na.rm=</span>T)</span>
<span id="cb5-22"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-22" tabindex="-1"></a>    dat<span class="sc">$</span>v_mean[i]<span class="ot">=</span><span class="fu">mean</span>(tmp<span class="sc">$</span>v_m.s,<span class="at">na.rm=</span>T)</span>
<span id="cb5-23"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-23" tabindex="-1"></a>    dat<span class="sc">$</span>w_mean[i]<span class="ot">=</span><span class="fu">mean</span>(tmp<span class="sc">$</span>w_m.s,<span class="at">na.rm=</span>T)</span>
<span id="cb5-24"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-24" tabindex="-1"></a>    dat<span class="sc">$</span>T_mean[i]<span class="ot">=</span><span class="fu">mean</span>(tmp<span class="sc">$</span>T_degC,<span class="at">na.rm=</span>T)</span>
<span id="cb5-25"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-25" tabindex="-1"></a>    <span class="co">#unit conversion for gases</span></span>
<span id="cb5-26"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-26" tabindex="-1"></a>    tmp<span class="sc">$</span>rhoH2O<span class="ot">=</span><span class="fu">ppt2rho</span>(tmp<span class="sc">$</span>H2O_ppt,dat<span class="sc">$</span>T_mean[i]<span class="sc">+</span><span class="fl">273.15</span>,<span class="dv">87000</span>)</span>
<span id="cb5-27"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-27" tabindex="-1"></a>    tmp<span class="sc">$</span>rhoCO2<span class="ot">=</span><span class="fu">ppt2rho</span>(tmp<span class="sc">$</span>CO2_ppm<span class="sc">/</span><span class="dv">1000</span>,dat<span class="sc">$</span>T_mean[i]<span class="sc">+</span><span class="fl">273.15</span>,<span class="dv">87000</span>,<span class="at">gas=</span><span class="st">&quot;CO2&quot;</span>)</span>
<span id="cb5-28"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-28" tabindex="-1"></a>    dat<span class="sc">$</span>h2o_mean[i]<span class="ot">=</span><span class="fu">mean</span>(tmp<span class="sc">$</span>rhoH2O,<span class="at">na.rm=</span>T)</span>
<span id="cb5-29"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-29" tabindex="-1"></a>    dat<span class="sc">$</span>co2_mean[i]<span class="ot">=</span><span class="fu">mean</span>(tmp<span class="sc">$</span>rhoCO2,<span class="at">na.rm=</span>T)</span>
<span id="cb5-30"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-30" tabindex="-1"></a>    <span class="co">#sds</span></span>
<span id="cb5-31"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-31" tabindex="-1"></a>    dat<span class="sc">$</span>u_sd[i]<span class="ot">=</span><span class="fu">sd</span>(tmp<span class="sc">$</span>u_m.s,<span class="at">na.rm=</span>T)</span>
<span id="cb5-32"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-32" tabindex="-1"></a>    dat<span class="sc">$</span>v_sd[i]<span class="ot">=</span><span class="fu">sd</span>(tmp<span class="sc">$</span>v_m.s,<span class="at">na.rm=</span>T)</span>
<span id="cb5-33"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-33" tabindex="-1"></a>    dat<span class="sc">$</span>w_sd[i]<span class="ot">=</span><span class="fu">sd</span>(tmp<span class="sc">$</span>w_m.s,<span class="at">na.rm=</span>T)</span>
<span id="cb5-34"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-34" tabindex="-1"></a>    dat<span class="sc">$</span>T_sd[i]<span class="ot">=</span><span class="fu">sd</span>(tmp<span class="sc">$</span>T_degC,<span class="at">na.rm=</span>T)</span>
<span id="cb5-35"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-35" tabindex="-1"></a>    dat<span class="sc">$</span>h2o_sd[i]<span class="ot">=</span><span class="fu">sd</span>(tmp<span class="sc">$</span>rhoH2O,<span class="at">na.rm=</span>T)</span>
<span id="cb5-36"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-36" tabindex="-1"></a>    dat<span class="sc">$</span>co2_sd[i]<span class="ot">=</span><span class="fu">sd</span>(tmp<span class="sc">$</span>rhoCO2,<span class="at">na.rm=</span>T)</span>
<span id="cb5-37"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-37" tabindex="-1"></a>    <span class="co">#covs</span></span>
<span id="cb5-38"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-38" tabindex="-1"></a>    dat<span class="sc">$</span>cov_uw[i]<span class="ot">=</span><span class="fu">cov</span>(tmp<span class="sc">$</span>u_m.s,tmp<span class="sc">$</span>w_m.s,<span class="at">use=</span><span class="st">&quot;pairwise.complete.obs&quot;</span>)</span>
<span id="cb5-39"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-39" tabindex="-1"></a>    dat<span class="sc">$</span>cov_uv[i]<span class="ot">=</span><span class="fu">cov</span>(tmp<span class="sc">$</span>u_m.s,tmp<span class="sc">$</span>v_m.s,<span class="at">use=</span><span class="st">&quot;pairwise.complete.obs&quot;</span>)</span>
<span id="cb5-40"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-40" tabindex="-1"></a>    dat<span class="sc">$</span>cov_vw[i]<span class="ot">=</span><span class="fu">cov</span>(tmp<span class="sc">$</span>v_m.s,tmp<span class="sc">$</span>w_m.s,<span class="at">use=</span><span class="st">&quot;pairwise.complete.obs&quot;</span>)</span>
<span id="cb5-41"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-41" tabindex="-1"></a>    dat<span class="sc">$</span>cov_wT[i]<span class="ot">=</span><span class="fu">cov</span>(tmp<span class="sc">$</span>T_degC,tmp<span class="sc">$</span>w_m.s,<span class="at">use=</span><span class="st">&quot;pairwise.complete.obs&quot;</span>)</span>
<span id="cb5-42"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-42" tabindex="-1"></a>    dat<span class="sc">$</span>cov_h2ow[i]<span class="ot">=</span><span class="fu">cov</span>(tmp<span class="sc">$</span>rhoH2O,tmp<span class="sc">$</span>w_m.s,<span class="at">use=</span><span class="st">&quot;pairwise.complete.obs&quot;</span>)</span>
<span id="cb5-43"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-43" tabindex="-1"></a>    dat<span class="sc">$</span>cov_co2w[i]<span class="ot">=</span><span class="fu">cov</span>(tmp<span class="sc">$</span>rhoCO2,tmp<span class="sc">$</span>w_m.s,<span class="at">use=</span><span class="st">&quot;pairwise.complete.obs&quot;</span>)</span>
<span id="cb5-44"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-44" tabindex="-1"></a>    <span class="co">#SND correction</span></span>
<span id="cb5-45"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-45" tabindex="-1"></a>    dat<span class="sc">$</span>cov_wT_snd[i]<span class="ot">=</span><span class="fu">SNDcorrection</span>(tmp<span class="sc">$</span>u_m.s,tmp<span class="sc">$</span>v_m.s,tmp<span class="sc">$</span>w_m.s,tmp<span class="sc">$</span>T_degC<span class="fl">+273.15</span>)</span>
<span id="cb5-46"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-46" tabindex="-1"></a>    <span class="co">#WPL correction</span></span>
<span id="cb5-47"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-47" tabindex="-1"></a>    <span class="co">#dat$cov_rhoH2Ow_wpl[i]=WPLcorrection(tmp$rhoH2O,w=tmp$w_m.s,Ts=tmp$T_degC+273.15,q=tmp$q)</span></span>
<span id="cb5-48"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-48" tabindex="-1"></a>    <span class="co">#flagging</span></span>
<span id="cb5-49"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-49" tabindex="-1"></a>    dat<span class="sc">$</span>flag_stationarity[i]<span class="ot">=</span><span class="fu">flag_stationarity</span>(tmp<span class="sc">$</span>w_m.s,tmp<span class="sc">$</span>T_degC,<span class="at">nsub=</span><span class="dv">3000</span>)</span>
<span id="cb5-50"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-50" tabindex="-1"></a>    dat<span class="sc">$</span>flag_w[i]<span class="ot">=</span><span class="fu">flag_w</span>(dat<span class="sc">$</span>w_mean[i])</span>
<span id="cb5-51"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-51" tabindex="-1"></a>    dat<span class="sc">$</span>flag_distortion[i]<span class="ot">=</span><span class="fu">flag_distortion</span>(tmp<span class="sc">$</span>u_m.s,tmp<span class="sc">$</span>v_m.s,<span class="at">dir_blocked=</span><span class="fu">c</span>(<span class="dv">340</span>,<span class="dv">360</span>))</span>
<span id="cb5-52"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb5-52" tabindex="-1"></a>}</span></code></pre></div>
<p>The covariances have to be converted to the fluxes (unit W/m<span class="math inline">\(^2\)</span>). Since the measured temperature (“sonic temperature”) is approximately equal to the virtual temperature, the respective flux <code>cov_wT</code> represents the buoyancy flux. To derive the sensible heat flux from this, the so called SND-corrected flux <code>cov_wT_snd</code> should be used. For the latent heat flux a density correction (WPL correction) is recommended to be applied.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb6-1" tabindex="-1"></a><span class="co">#calculate fluxes</span></span>
<span id="cb6-2"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb6-2" tabindex="-1"></a>dat<span class="sc">$</span>sh<span class="ot">=</span><span class="fu">cov2sh</span>(dat<span class="sc">$</span>cov_wT_snd)</span>
<span id="cb6-3"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb6-3" tabindex="-1"></a>dat<span class="sc">$</span>lh<span class="ot">=</span><span class="fu">cov2lh</span>(dat<span class="sc">$</span>cov_h2ow)</span></code></pre></div>
<p>The output contains the 30 minutes averages, standard deviations and covariances of the measured quantities, which will be used in the following notebooks for some more detailed analysis.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb7-1" tabindex="-1"></a><span class="co">#look at output</span></span>
<span id="cb7-2"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb7-2" tabindex="-1"></a>dat</span></code></pre></div>
<table class="dataframe">
<caption>
A data.frame: 127 × 30
</caption>
<thead>
<tr>
<th scope="col">
time
</th>
<th scope="col">
u_mean
</th>
<th scope="col">
v_mean
</th>
<th scope="col">
w_mean
</th>
<th scope="col">
ws_mean
</th>
<th scope="col">
wd_mean
</th>
<th scope="col">
T_mean
</th>
<th scope="col">
h2o_mean
</th>
<th scope="col">
co2_mean
</th>
<th scope="col">
u_sd
</th>
<th scope="col">
⋯
</th>
<th scope="col">
cov_co2w
</th>
<th scope="col">
cov_wT_snd
</th>
<th scope="col">
cov_rhoH2Ow_wpl
</th>
<th scope="col">
rot_angle1
</th>
<th scope="col">
rot_angle2
</th>
<th scope="col">
flag_stationarity
</th>
<th scope="col">
flag_w
</th>
<th scope="col">
flag_distortion
</th>
<th scope="col">
sh
</th>
<th scope="col">
lh
</th>
</tr>
<tr>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
⋯
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;lgl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;lgl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
2018-07-20 08:30:00
</td>
<td>
2.872084
</td>
<td>
-3.939352e-16
</td>
<td>
6.931732e-06
</td>
<td>
2.873170
</td>
<td>
-2.289284
</td>
<td>
15.86938
</td>
<td>
0.007254132
</td>
<td>
0.0006009614
</td>
<td>
1.0621428
</td>
<td>
⋯
</td>
<td>
-1.567917e-07
</td>
<td>
0.105285787
</td>
<td>
NA
</td>
<td>
-131.16630
</td>
<td>
0.34842842
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
123.251207
</td>
<td>
103.108515
</td>
</tr>
<tr>
<td>
2018-07-20 09:00:00
</td>
<td>
2.864793
</td>
<td>
7.504684e-17
</td>
<td>
9.052527e-08
</td>
<td>
2.864538
</td>
<td>
-2.326045
</td>
<td>
16.55190
</td>
<td>
0.007584267
</td>
<td>
0.0005978138
</td>
<td>
1.1051216
</td>
<td>
⋯
</td>
<td>
-2.294700e-07
</td>
<td>
0.160070314
</td>
<td>
NA
</td>
<td>
-133.27259
</td>
<td>
0.77454172
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
187.383880
</td>
<td>
162.619600
</td>
</tr>
<tr>
<td>
2018-07-20 09:30:00
</td>
<td>
3.996526
</td>
<td>
9.365292e-16
</td>
<td>
3.049021e-05
</td>
<td>
4.002522
</td>
<td>
-2.035397
</td>
<td>
17.05704
</td>
<td>
0.007472065
</td>
<td>
0.0005954894
</td>
<td>
1.4094952
</td>
<td>
⋯
</td>
<td>
-1.862787e-07
</td>
<td>
0.153351409
</td>
<td>
NA
</td>
<td>
-116.61967
</td>
<td>
0.28889573
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
179.518496
</td>
<td>
123.571122
</td>
</tr>
<tr>
<td>
2018-07-20 10:00:00
</td>
<td>
4.998016
</td>
<td>
-2.812846e-16
</td>
<td>
-2.391239e-06
</td>
<td>
4.997530
</td>
<td>
-1.977737
</td>
<td>
17.60447
</td>
<td>
0.006762097
</td>
<td>
0.0005953881
</td>
<td>
1.2893259
</td>
<td>
⋯
</td>
<td>
-1.504328e-07
</td>
<td>
0.155664878
</td>
<td>
NA
</td>
<td>
-113.31596
</td>
<td>
0.34831201
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
182.226723
</td>
<td>
123.447352
</td>
</tr>
<tr>
<td>
2018-07-20 10:30:00
</td>
<td>
4.879095
</td>
<td>
4.062636e-16
</td>
<td>
2.187117e-05
</td>
<td>
4.880696
</td>
<td>
-2.014489
</td>
<td>
18.08994
</td>
<td>
0.005410862
</td>
<td>
0.0005948927
</td>
<td>
1.4699485
</td>
<td>
⋯
</td>
<td>
-1.989823e-07
</td>
<td>
0.191448808
</td>
<td>
NA
</td>
<td>
-115.42174
</td>
<td>
0.65319222
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
224.116637
</td>
<td>
191.164235
</td>
</tr>
<tr>
<td>
2018-07-20 11:00:00
</td>
<td>
5.225037
</td>
<td>
-8.977916e-17
</td>
<td>
-6.972624e-06
</td>
<td>
5.223984
</td>
<td>
-2.261205
</td>
<td>
18.24207
</td>
<td>
0.004422858
</td>
<td>
0.0005954766
</td>
<td>
1.3192267
</td>
<td>
⋯
</td>
<td>
-1.330638e-07
</td>
<td>
0.149027117
</td>
<td>
NA
</td>
<td>
-129.55749
</td>
<td>
0.44710739
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
174.456329
</td>
<td>
150.843015
</td>
</tr>
<tr>
<td>
2018-07-20 11:30:00
</td>
<td>
5.896774
</td>
<td>
-7.481298e-16
</td>
<td>
-4.307951e-05
</td>
<td>
5.893156
</td>
<td>
-2.141157
</td>
<td>
18.50137
</td>
<td>
0.003765156
</td>
<td>
0.0005955767
</td>
<td>
1.4571181
</td>
<td>
⋯
</td>
<td>
-1.312707e-07
</td>
<td>
0.157559904
</td>
<td>
NA
</td>
<td>
-122.67927
</td>
<td>
0.81792595
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
184.445107
</td>
<td>
161.171549
</td>
</tr>
<tr>
<td>
2018-07-20 12:00:00
</td>
<td>
5.211296
</td>
<td>
-3.062741e-16
</td>
<td>
-1.461607e-05
</td>
<td>
5.209715
</td>
<td>
-2.253118
</td>
<td>
18.57772
</td>
<td>
0.003418867
</td>
<td>
0.0005955199
</td>
<td>
1.2629639
</td>
<td>
⋯
</td>
<td>
-1.288697e-07
</td>
<td>
0.147288599
</td>
<td>
NA
</td>
<td>
-129.09416
</td>
<td>
0.70850506
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
172.421160
</td>
<td>
167.032959
</td>
</tr>
<tr>
<td>
2018-07-20 12:30:00
</td>
<td>
4.295926
</td>
<td>
-7.486225e-16
</td>
<td>
-1.727795e-06
</td>
<td>
4.295548
</td>
<td>
-2.194560
</td>
<td>
18.80679
</td>
<td>
0.003522845
</td>
<td>
0.0005946848
</td>
<td>
1.3898230
</td>
<td>
⋯
</td>
<td>
-1.343277e-07
</td>
<td>
0.150429440
</td>
<td>
NA
</td>
<td>
-125.73902
</td>
<td>
0.55118076
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
176.097937
</td>
<td>
171.821168
</td>
</tr>
<tr>
<td>
2018-07-20 13:00:00
</td>
<td>
3.973616
</td>
<td>
-4.304496e-16
</td>
<td>
-1.026732e-05
</td>
<td>
3.972403
</td>
<td>
-2.117721
</td>
<td>
18.78832
</td>
<td>
0.003276191
</td>
<td>
0.0005946895
</td>
<td>
1.4404999
</td>
<td>
⋯
</td>
<td>
-1.394019e-07
</td>
<td>
0.144682715
</td>
<td>
NA
</td>
<td>
-121.33650
</td>
<td>
0.58416349
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
169.370621
</td>
<td>
173.852072
</td>
</tr>
<tr>
<td>
2018-07-20 13:30:00
</td>
<td>
1.520355
</td>
<td>
2.799239e-16
</td>
<td>
5.320330e-05
</td>
<td>
1.527719
</td>
<td>
1.749457
</td>
<td>
18.20841
</td>
<td>
0.005748607
</td>
<td>
0.0005944343
</td>
<td>
3.1235024
</td>
<td>
⋯
</td>
<td>
-1.209975e-07
</td>
<td>
0.171911188
</td>
<td>
NA
</td>
<td>
100.23652
</td>
<td>
0.41171028
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
201.245219
</td>
<td>
-89.529788
</td>
</tr>
<tr>
<td>
2018-07-20 14:00:00
</td>
<td>
6.940662
</td>
<td>
5.646526e-16
</td>
<td>
-2.889014e-05
</td>
<td>
6.936159
</td>
<td>
1.375615
</td>
<td>
16.21080
</td>
<td>
0.008946908
</td>
<td>
0.0005954275
</td>
<td>
1.4076910
</td>
<td>
⋯
</td>
<td>
-2.003594e-07
</td>
<td>
0.139620668
</td>
<td>
NA
</td>
<td>
78.81692
</td>
<td>
0.38055423
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
163.444813
</td>
<td>
112.745879
</td>
</tr>
<tr>
<td>
2018-07-20 14:30:00
</td>
<td>
6.416896
</td>
<td>
1.098171e-16
</td>
<td>
-2.196289e-05
</td>
<td>
6.414141
</td>
<td>
1.392954
</td>
<td>
15.81382
</td>
<td>
0.008976061
</td>
<td>
0.0005949455
</td>
<td>
1.2086952
</td>
<td>
⋯
</td>
<td>
-2.123072e-07
</td>
<td>
0.120795796
</td>
<td>
NA
</td>
<td>
79.81038
</td>
<td>
0.50141324
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
141.407763
</td>
<td>
103.198460
</td>
</tr>
<tr>
<td>
2018-07-20 15:00:00
</td>
<td>
6.321222
</td>
<td>
-3.078589e-16
</td>
<td>
-2.444517e-05
</td>
<td>
6.318381
</td>
<td>
1.480618
</td>
<td>
15.43666
</td>
<td>
0.008717666
</td>
<td>
0.0005955538
</td>
<td>
1.0829833
</td>
<td>
⋯
</td>
<td>
-1.737773e-07
</td>
<td>
0.101715975
</td>
<td>
NA
</td>
<td>
84.83316
</td>
<td>
0.54901559
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
119.072260
</td>
<td>
81.415559
</td>
</tr>
<tr>
<td>
2018-07-20 15:30:00
</td>
<td>
6.043490
</td>
<td>
-3.591949e-16
</td>
<td>
-2.272359e-05
</td>
<td>
6.041072
</td>
<td>
1.537172
</td>
<td>
15.27256
</td>
<td>
0.008609773
</td>
<td>
0.0005955597
</td>
<td>
1.0474320
</td>
<td>
⋯
</td>
<td>
-1.625061e-07
</td>
<td>
0.092767213
</td>
<td>
NA
</td>
<td>
88.07349
</td>
<td>
0.63644762
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
108.596528
</td>
<td>
81.701058
</td>
</tr>
<tr>
<td>
2018-07-20 16:00:00
</td>
<td>
5.939518
</td>
<td>
-1.692595e-16
</td>
<td>
-1.849441e-05
</td>
<td>
5.937431
</td>
<td>
1.496256
</td>
<td>
15.13815
</td>
<td>
0.008618070
</td>
<td>
0.0005955722
</td>
<td>
0.9961572
</td>
<td>
⋯
</td>
<td>
-1.694039e-07
</td>
<td>
0.084952398
</td>
<td>
NA
</td>
<td>
85.72916
</td>
<td>
0.60281578
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
99.448234
</td>
<td>
82.174082
</td>
</tr>
<tr>
<td>
2018-07-20 16:30:00
</td>
<td>
5.306554
</td>
<td>
2.974929e-16
</td>
<td>
-3.094122e-05
</td>
<td>
5.303926
</td>
<td>
1.505930
</td>
<td>
14.99383
</td>
<td>
0.008512352
</td>
<td>
0.0005958945
</td>
<td>
0.9426203
</td>
<td>
⋯
</td>
<td>
-1.604182e-07
</td>
<td>
0.071198878
</td>
<td>
NA
</td>
<td>
86.28345
</td>
<td>
0.89501195
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
83.347884
</td>
<td>
76.171833
</td>
</tr>
<tr>
<td>
2018-07-20 17:00:00
</td>
<td>
5.520015
</td>
<td>
4.660902e-17
</td>
<td>
-1.371344e-05
</td>
<td>
5.518476
</td>
<td>
1.527105
</td>
<td>
14.66441
</td>
<td>
0.008393601
</td>
<td>
0.0005971210
</td>
<td>
0.9157507
</td>
<td>
⋯
</td>
<td>
-1.052333e-07
</td>
<td>
0.043069756
</td>
<td>
NA
</td>
<td>
87.49668
</td>
<td>
0.68897202
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
50.418955
</td>
<td>
47.779392
</td>
</tr>
<tr>
<td>
2018-07-20 17:30:00
</td>
<td>
5.772783
</td>
<td>
5.944122e-16
</td>
<td>
-2.376498e-05
</td>
<td>
5.770532
</td>
<td>
1.526367
</td>
<td>
14.23050
</td>
<td>
0.008291716
</td>
<td>
0.0005985217
</td>
<td>
1.0008122
</td>
<td>
⋯
</td>
<td>
-9.532674e-08
</td>
<td>
0.034922874
</td>
<td>
NA
</td>
<td>
87.45438
</td>
<td>
0.82061559
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
40.881932
</td>
<td>
48.261033
</td>
</tr>
<tr>
<td>
2018-07-20 18:00:00
</td>
<td>
5.858808
</td>
<td>
4.427743e-16
</td>
<td>
-2.452174e-05
</td>
<td>
5.855744
</td>
<td>
1.474368
</td>
<td>
13.76722
</td>
<td>
0.008188837
</td>
<td>
0.0006000559
</td>
<td>
0.9311757
</td>
<td>
⋯
</td>
<td>
-6.832866e-08
</td>
<td>
0.021616959
</td>
<td>
NA
</td>
<td>
84.47508
</td>
<td>
0.49358496
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
25.305564
</td>
<td>
36.169862
</td>
</tr>
<tr>
<td>
2018-07-20 18:30:00
</td>
<td>
4.726868
</td>
<td>
-3.629108e-16
</td>
<td>
-2.609463e-05
</td>
<td>
4.724053
</td>
<td>
1.443867
</td>
<td>
13.42414
</td>
<td>
0.008213861
</td>
<td>
0.0006007363
</td>
<td>
0.8119707
</td>
<td>
⋯
</td>
<td>
-4.526051e-08
</td>
<td>
0.006660012
</td>
<td>
NA
</td>
<td>
82.72747
</td>
<td>
0.58131225
</td>
<td>
1
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
7.796442
</td>
<td>
28.714652
</td>
</tr>
<tr>
<td>
2018-07-20 19:00:00
</td>
<td>
5.235747
</td>
<td>
-4.403414e-16
</td>
<td>
-2.374174e-05
</td>
<td>
5.232331
</td>
<td>
1.446531
</td>
<td>
12.95281
</td>
<td>
0.008061974
</td>
<td>
0.0006026033
</td>
<td>
0.8973074
</td>
<td>
⋯
</td>
<td>
-9.836328e-09
</td>
<td>
-0.003044785
</td>
<td>
NA
</td>
<td>
82.88014
</td>
<td>
0.41484529
</td>
<td>
1
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
-3.564331
</td>
<td>
21.349899
</td>
</tr>
<tr>
<td>
2018-07-20 19:30:00
</td>
<td>
4.888416
</td>
<td>
-5.150101e-16
</td>
<td>
-1.013674e-05
</td>
<td>
4.887055
</td>
<td>
1.424478
</td>
<td>
12.26218
</td>
<td>
0.007800124
</td>
<td>
0.0006059566
</td>
<td>
0.8556428
</td>
<td>
⋯
</td>
<td>
2.634083e-08
</td>
<td>
-0.010446773
</td>
<td>
NA
</td>
<td>
81.61656
</td>
<td>
0.49182960
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
-12.229356
</td>
<td>
16.702988
</td>
</tr>
<tr>
<td>
2018-07-20 20:00:00
</td>
<td>
4.186600
</td>
<td>
2.900506e-16
</td>
<td>
-1.165991e-05
</td>
<td>
4.184779
</td>
<td>
1.268382
</td>
<td>
11.69501
</td>
<td>
0.007702318
</td>
<td>
0.0006083613
</td>
<td>
0.8672731
</td>
<td>
⋯
</td>
<td>
6.448021e-08
</td>
<td>
-0.025728114
</td>
<td>
NA
</td>
<td>
72.67291
</td>
<td>
0.38725083
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
-30.118225
</td>
<td>
12.138708
</td>
</tr>
<tr>
<td>
2018-07-20 20:30:00
</td>
<td>
3.551020
</td>
<td>
-2.893889e-16
</td>
<td>
-1.814533e-06
</td>
<td>
3.555726
</td>
<td>
1.195096
</td>
<td>
11.06218
</td>
<td>
0.007535550
</td>
<td>
0.0006109579
</td>
<td>
1.0888968
</td>
<td>
⋯
</td>
<td>
6.581506e-08
</td>
<td>
-0.020063040
</td>
<td>
NA
</td>
<td>
68.47397
</td>
<td>
-0.02209129
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
-23.486493
</td>
<td>
8.825126
</td>
</tr>
<tr>
<td>
2018-07-20 21:00:00
</td>
<td>
3.181178
</td>
<td>
2.700118e-16
</td>
<td>
8.888365e-09
</td>
<td>
3.181144
</td>
<td>
1.108919
</td>
<td>
10.56345
</td>
<td>
0.007438288
</td>
<td>
0.0006128597
</td>
<td>
0.7279405
</td>
<td>
⋯
</td>
<td>
6.871569e-08
</td>
<td>
-0.021064154
</td>
<td>
NA
</td>
<td>
63.53635
</td>
<td>
-0.25485232
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
-24.658431
</td>
<td>
5.239288
</td>
</tr>
<tr>
<td>
2018-07-20 21:30:00
</td>
<td>
3.433915
</td>
<td>
-3.167000e-16
</td>
<td>
6.880287e-06
</td>
<td>
3.431664
</td>
<td>
1.203063
</td>
<td>
10.68381
</td>
<td>
0.007496276
</td>
<td>
0.0006119426
</td>
<td>
0.7405834
</td>
<td>
⋯
</td>
<td>
7.468146e-08
</td>
<td>
-0.023601111
</td>
<td>
NA
</td>
<td>
68.93044
</td>
<td>
-0.17637338
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
-27.628282
</td>
<td>
8.886297
</td>
</tr>
<tr>
<td>
2018-07-20 22:00:00
</td>
<td>
3.274341
</td>
<td>
-2.888448e-16
</td>
<td>
1.778441e-05
</td>
<td>
3.275246
</td>
<td>
1.495703
</td>
<td>
10.65175
</td>
<td>
0.007511255
</td>
<td>
0.0006121003
</td>
<td>
0.8838687
</td>
<td>
⋯
</td>
<td>
7.784352e-08
</td>
<td>
-0.021391491
</td>
<td>
NA
</td>
<td>
85.69748
</td>
<td>
0.82076630
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
-25.041624
</td>
<td>
7.859899
</td>
</tr>
<tr>
<td>
2018-07-20 22:30:00
</td>
<td>
2.803897
</td>
<td>
-2.616895e-16
</td>
<td>
1.775305e-05
</td>
<td>
2.807623
</td>
<td>
1.344351
</td>
<td>
10.09577
</td>
<td>
0.007429886
</td>
<td>
0.0006149156
</td>
<td>
0.6440969
</td>
<td>
⋯
</td>
<td>
4.863595e-08
</td>
<td>
-0.011427853
</td>
<td>
NA
</td>
<td>
77.02565
</td>
<td>
0.27070980
</td>
<td>
1
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
-13.377842
</td>
<td>
3.197872
</td>
</tr>
<tr>
<td>
2018-07-20 23:00:00
</td>
<td>
2.254428
</td>
<td>
1.066464e-16
</td>
<td>
7.137489e-05
</td>
<td>
2.260404
</td>
<td>
1.541577
</td>
<td>
10.09860
</td>
<td>
0.007342520
</td>
<td>
0.0006150409
</td>
<td>
0.3268925
</td>
<td>
⋯
</td>
<td>
4.166614e-08
</td>
<td>
-0.008875441
</td>
<td>
NA
</td>
<td>
88.32585
</td>
<td>
0.66714732
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
-10.389901
</td>
<td>
1.608121
</td>
</tr>
<tr>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋱
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
<td>
⋮
</td>
</tr>
<tr>
<td>
2018-07-22 09:00:00
</td>
<td>
4.934240
</td>
<td>
1.360241e-16
</td>
<td>
-3.029725e-05
</td>
<td>
4.931280
</td>
<td>
1.5564115
</td>
<td>
11.60676
</td>
<td>
0.008045377
</td>
<td>
0.0006071581
</td>
<td>
0.9836290
</td>
<td>
⋯
</td>
<td>
-2.728952e-07
</td>
<td>
0.1469336287
</td>
<td>
NA
</td>
<td>
89.17581
</td>
<td>
0.65919637
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
172.0056191
</td>
<td>
91.155380
</td>
</tr>
<tr>
<td>
2018-07-22 09:30:00
</td>
<td>
3.685099
</td>
<td>
1.311143e-16
</td>
<td>
-1.743743e-05
</td>
<td>
3.680715
</td>
<td>
1.5207279
</td>
<td>
11.88088
</td>
<td>
0.007695658
</td>
<td>
0.0006065192
</td>
<td>
0.9424085
</td>
<td>
⋯
</td>
<td>
-2.423139e-07
</td>
<td>
0.1276529904
</td>
<td>
NA
</td>
<td>
87.13129
</td>
<td>
0.22942499
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
149.4350329
</td>
<td>
87.776234
</td>
</tr>
<tr>
<td>
2018-07-22 10:00:00
</td>
<td>
3.808851
</td>
<td>
3.501510e-16
</td>
<td>
-2.815809e-06
</td>
<td>
3.805463
</td>
<td>
1.2501465
</td>
<td>
12.55179
</td>
<td>
0.007658358
</td>
<td>
0.0006039184
</td>
<td>
0.9662970
</td>
<td>
⋯
</td>
<td>
-3.035400e-07
</td>
<td>
0.1568491952
</td>
<td>
NA
</td>
<td>
71.62812
</td>
<td>
0.04763640
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
183.6131263
</td>
<td>
125.672679
</td>
</tr>
<tr>
<td>
2018-07-22 10:30:00
</td>
<td>
4.038900
</td>
<td>
3.412161e-17
</td>
<td>
-2.187558e-05
</td>
<td>
4.035977
</td>
<td>
1.5611167
</td>
<td>
12.68939
</td>
<td>
0.007443700
</td>
<td>
0.0006037819
</td>
<td>
0.9762103
</td>
<td>
⋯
</td>
<td>
-2.515459e-07
</td>
<td>
0.1402379720
</td>
<td>
NA
</td>
<td>
89.44540
</td>
<td>
0.44763283
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
164.1674503
</td>
<td>
135.529031
</td>
</tr>
<tr>
<td>
2018-07-22 11:00:00
</td>
<td>
4.041805
</td>
<td>
2.169395e-17
</td>
<td>
-1.737959e-06
</td>
<td>
4.040701
</td>
<td>
1.4370347
</td>
<td>
13.21034
</td>
<td>
0.007536608
</td>
<td>
0.0006022697
</td>
<td>
1.0340207
</td>
<td>
⋯
</td>
<td>
-2.199780e-07
</td>
<td>
0.1324872047
</td>
<td>
NA
</td>
<td>
82.33603
</td>
<td>
0.09057700
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
155.0941324
</td>
<td>
110.693473
</td>
</tr>
<tr>
<td>
2018-07-22 11:30:00
</td>
<td>
3.973222
</td>
<td>
3.013937e-04
</td>
<td>
-1.008345e-05
</td>
<td>
3.972104
</td>
<td>
1.5463529
</td>
<td>
13.84238
</td>
<td>
0.007486059
</td>
<td>
0.0006004164
</td>
<td>
1.0594391
</td>
<td>
⋯
</td>
<td>
-1.940930e-07
</td>
<td>
0.1478984398
</td>
<td>
NA
</td>
<td>
88.59950
</td>
<td>
0.69111276
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
173.1350605
</td>
<td>
112.520105
</td>
</tr>
<tr>
<td>
2018-07-22 12:00:00
</td>
<td>
4.283310
</td>
<td>
-4.358781e-16
</td>
<td>
-2.031664e-05
</td>
<td>
4.281145
</td>
<td>
1.4904558
</td>
<td>
14.38656
</td>
<td>
0.007452259
</td>
<td>
0.0005988270
</td>
<td>
1.0369835
</td>
<td>
⋯
</td>
<td>
-2.192808e-07
</td>
<td>
0.1572654103
</td>
<td>
NA
</td>
<td>
85.39683
</td>
<td>
0.60405517
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
184.1003622
</td>
<td>
144.963821
</td>
</tr>
<tr>
<td>
2018-07-22 12:30:00
</td>
<td>
3.406857
</td>
<td>
-4.631435e-18
</td>
<td>
-2.148455e-05
</td>
<td>
3.404504
</td>
<td>
1.6768265
</td>
<td>
14.31459
</td>
<td>
0.007368565
</td>
<td>
0.0005994846
</td>
<td>
0.9934416
</td>
<td>
⋯
</td>
<td>
-2.036819e-07
</td>
<td>
0.1356744868
</td>
<td>
NA
</td>
<td>
96.07508
</td>
<td>
0.56222577
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
158.8252757
</td>
<td>
130.511414
</td>
</tr>
<tr>
<td>
2018-07-22 13:00:00
</td>
<td>
3.510585
</td>
<td>
2.240778e-16
</td>
<td>
6.470652e-07
</td>
<td>
3.508803
</td>
<td>
1.5042434
</td>
<td>
14.38106
</td>
<td>
0.007626521
</td>
<td>
0.0005990254
</td>
<td>
1.0042979
</td>
<td>
⋯
</td>
<td>
-2.374995e-07
</td>
<td>
0.1261090650
</td>
<td>
NA
</td>
<td>
86.18680
</td>
<td>
-0.02081545
</td>
<td>
1
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
147.6276601
</td>
<td>
137.495659
</td>
</tr>
<tr>
<td>
2018-07-22 13:30:00
</td>
<td>
3.968790
</td>
<td>
8.016486e-17
</td>
<td>
9.967825e-07
</td>
<td>
3.967463
</td>
<td>
1.3624830
</td>
<td>
14.14629
</td>
<td>
0.007626520
</td>
<td>
0.0005989277
</td>
<td>
0.8834556
</td>
<td>
⋯
</td>
<td>
-1.783447e-07
</td>
<td>
0.0504325709
</td>
<td>
NA
</td>
<td>
78.06452
</td>
<td>
-0.04307320
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
59.0381225
</td>
<td>
55.629582
</td>
</tr>
<tr>
<td>
2018-07-22 14:00:00
</td>
<td>
4.956423
</td>
<td>
2.401986e-17
</td>
<td>
-1.127752e-05
</td>
<td>
4.954213
</td>
<td>
1.3523014
</td>
<td>
13.89753
</td>
<td>
0.007715921
</td>
<td>
0.0005984573
</td>
<td>
1.0858658
</td>
<td>
⋯
</td>
<td>
-1.849130e-07
</td>
<td>
0.0659642731
</td>
<td>
NA
</td>
<td>
77.48116
</td>
<td>
0.30163387
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
77.2200736
</td>
<td>
37.169667
</td>
</tr>
<tr>
<td>
2018-07-22 14:30:00
</td>
<td>
4.536245
</td>
<td>
3.509249e-16
</td>
<td>
-1.557156e-05
</td>
<td>
4.534354
</td>
<td>
1.4097145
</td>
<td>
13.57508
</td>
<td>
0.008061454
</td>
<td>
0.0005981953
</td>
<td>
0.9470086
</td>
<td>
⋯
</td>
<td>
-1.976818e-07
</td>
<td>
0.0596950154
</td>
<td>
NA
</td>
<td>
80.77069
</td>
<td>
0.52446421
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
69.8810624
</td>
<td>
59.113466
</td>
</tr>
<tr>
<td>
2018-07-22 15:00:00
</td>
<td>
3.323492
</td>
<td>
1.824209e-16
</td>
<td>
6.268496e-05
</td>
<td>
3.319558
</td>
<td>
1.0041217
</td>
<td>
13.73304
</td>
<td>
0.008020425
</td>
<td>
0.0005967901
</td>
<td>
0.9860027
</td>
<td>
⋯
</td>
<td>
-2.856360e-07
</td>
<td>
0.0874115300
</td>
<td>
NA
</td>
<td>
57.53193
</td>
<td>
-1.07062469
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
102.3269789
</td>
<td>
90.497803
</td>
</tr>
<tr>
<td>
2018-07-22 15:30:00
</td>
<td>
3.426673
</td>
<td>
9.128458e-18
</td>
<td>
9.364812e-05
</td>
<td>
3.421413
</td>
<td>
0.8924684
</td>
<td>
13.68513
</td>
<td>
0.008118645
</td>
<td>
0.0005968709
</td>
<td>
1.0725842
</td>
<td>
⋯
</td>
<td>
-2.663410e-07
</td>
<td>
0.0726323087
</td>
<td>
NA
</td>
<td>
51.13467
</td>
<td>
-1.18453904
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
85.0259082
</td>
<td>
75.815574
</td>
</tr>
<tr>
<td>
2018-07-22 16:00:00
</td>
<td>
5.038157
</td>
<td>
6.334020e-17
</td>
<td>
2.764715e-05
</td>
<td>
5.033950
</td>
<td>
1.0795385
</td>
<td>
13.27879
</td>
<td>
0.008213574
</td>
<td>
0.0005985829
</td>
<td>
1.2008591
</td>
<td>
⋯
</td>
<td>
-1.940414e-07
</td>
<td>
0.0617238594
</td>
<td>
NA
</td>
<td>
61.85300
</td>
<td>
-0.38713026
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
72.2560979
</td>
<td>
54.747261
</td>
</tr>
<tr>
<td>
2018-07-22 16:30:00
</td>
<td>
4.645413
</td>
<td>
-1.371246e-16
</td>
<td>
1.770146e-05
</td>
<td>
4.643136
</td>
<td>
1.1494962
</td>
<td>
12.92932
</td>
<td>
0.008076257
</td>
<td>
0.0005997796
</td>
<td>
1.0632421
</td>
<td>
⋯
</td>
<td>
-1.491321e-07
</td>
<td>
0.0425055503
</td>
<td>
NA
</td>
<td>
65.86128
</td>
<td>
-0.47973064
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
49.7584764
</td>
<td>
43.169816
</td>
</tr>
<tr>
<td>
2018-07-22 17:00:00
</td>
<td>
5.001013
</td>
<td>
-5.808562e-16
</td>
<td>
-7.392887e-07
</td>
<td>
5.000230
</td>
<td>
1.3124190
</td>
<td>
12.57927
</td>
<td>
0.008170141
</td>
<td>
0.0006010954
</td>
<td>
1.2517845
</td>
<td>
⋯
</td>
<td>
-1.395839e-07
</td>
<td>
0.0440654985
</td>
<td>
NA
</td>
<td>
75.19607
</td>
<td>
0.05424580
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
51.5846060
</td>
<td>
51.117089
</td>
</tr>
<tr>
<td>
2018-07-22 17:30:00
</td>
<td>
4.633404
</td>
<td>
5.241664e-16
</td>
<td>
-1.060797e-05
</td>
<td>
4.630818
</td>
<td>
1.3701906
</td>
<td>
12.17168
</td>
<td>
0.008480251
</td>
<td>
0.0006024389
</td>
<td>
0.8424576
</td>
<td>
⋯
</td>
<td>
-8.066659e-08
</td>
<td>
0.0401371726
</td>
<td>
NA
</td>
<td>
78.50614
</td>
<td>
0.23876210
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
46.9859710
</td>
<td>
22.568161
</td>
</tr>
<tr>
<td>
2018-07-22 18:00:00
</td>
<td>
4.808849
</td>
<td>
2.476932e-16
</td>
<td>
-1.946078e-06
</td>
<td>
4.808397
</td>
<td>
1.4466351
</td>
<td>
11.63522
</td>
<td>
0.008832184
</td>
<td>
0.0006047761
</td>
<td>
1.0330590
</td>
<td>
⋯
</td>
<td>
-2.724699e-08
</td>
<td>
0.0334611799
</td>
<td>
NA
</td>
<td>
82.88609
</td>
<td>
0.60550086
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
39.1708216
</td>
<td>
20.361893
</td>
</tr>
<tr>
<td>
2018-07-22 18:30:00
</td>
<td>
4.991756
</td>
<td>
1.900191e-16
</td>
<td>
-9.402087e-06
</td>
<td>
4.989375
</td>
<td>
1.3828198
</td>
<td>
11.58462
</td>
<td>
0.008966201
</td>
<td>
0.0006071991
</td>
<td>
0.9245638
</td>
<td>
⋯
</td>
<td>
4.845547e-08
</td>
<td>
0.0200961999
</td>
<td>
NA
</td>
<td>
79.22974
</td>
<td>
0.23016275
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
23.5253109
</td>
<td>
15.557606
</td>
</tr>
<tr>
<td>
2018-07-22 19:00:00
</td>
<td>
4.629573
</td>
<td>
-1.132581e-16
</td>
<td>
-1.405561e-06
</td>
<td>
4.627018
</td>
<td>
1.3171244
</td>
<td>
11.39210
</td>
<td>
0.009011218
</td>
<td>
0.0006088185
</td>
<td>
0.8886549
</td>
<td>
⋯
</td>
<td>
4.470996e-08
</td>
<td>
0.0067135792
</td>
<td>
NA
</td>
<td>
75.46567
</td>
<td>
0.03152531
</td>
<td>
1
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
7.8591494
</td>
<td>
8.669188
</td>
</tr>
<tr>
<td>
2018-07-22 19:30:00
</td>
<td>
4.336875
</td>
<td>
-5.562471e-17
</td>
<td>
3.616091e-07
</td>
<td>
4.337095
</td>
<td>
1.2881384
</td>
<td>
11.43086
</td>
<td>
0.009037957
</td>
<td>
0.0006091240
</td>
<td>
1.1164046
</td>
<td>
⋯
</td>
<td>
7.632590e-08
</td>
<td>
0.0109052802
</td>
<td>
NA
</td>
<td>
73.80490
</td>
<td>
0.09186474
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
12.7661005
</td>
<td>
12.068417
</td>
</tr>
<tr>
<td>
2018-07-22 20:00:00
</td>
<td>
4.289542
</td>
<td>
1.404781e-17
</td>
<td>
8.410191e-06
</td>
<td>
4.289915
</td>
<td>
1.4539472
</td>
<td>
11.14092
</td>
<td>
0.009144167
</td>
<td>
0.0006096889
</td>
<td>
0.9880762
</td>
<td>
⋯
</td>
<td>
8.200592e-08
</td>
<td>
0.0103035127
</td>
<td>
NA
</td>
<td>
83.30504
</td>
<td>
0.69723069
</td>
<td>
1
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
12.0616505
</td>
<td>
12.182950
</td>
</tr>
<tr>
<td>
2018-07-22 20:30:00
</td>
<td>
4.081792
</td>
<td>
-2.269024e-16
</td>
<td>
-6.796915e-06
</td>
<td>
4.080873
</td>
<td>
1.3794733
</td>
<td>
11.16442
</td>
<td>
0.009021582
</td>
<td>
0.0006100198
</td>
<td>
0.8368831
</td>
<td>
⋯
</td>
<td>
7.528827e-08
</td>
<td>
0.0015929239
</td>
<td>
NA
</td>
<td>
79.03800
</td>
<td>
0.51751216
</td>
<td>
2
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
1.8647321
</td>
<td>
6.685670
</td>
</tr>
<tr>
<td>
2018-07-22 21:00:00
</td>
<td>
3.133527
</td>
<td>
4.899518e-17
</td>
<td>
-1.415750e-05
</td>
<td>
3.130986
</td>
<td>
1.3399591
</td>
<td>
11.06795
</td>
<td>
0.009055533
</td>
<td>
0.0006108238
</td>
<td>
0.6423834
</td>
<td>
⋯
</td>
<td>
9.266462e-08
</td>
<td>
0.0022900645
</td>
<td>
NA
</td>
<td>
76.77400
</td>
<td>
0.32570547
</td>
<td>
1
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
2.6808292
</td>
<td>
6.693488
</td>
</tr>
<tr>
<td>
2018-07-22 21:30:00
</td>
<td>
3.295366
</td>
<td>
-2.060070e-16
</td>
<td>
-1.353138e-07
</td>
<td>
3.295063
</td>
<td>
1.4847268
</td>
<td>
11.06516
</td>
<td>
0.009071125
</td>
<td>
0.0006110649
</td>
<td>
0.6248660
</td>
<td>
⋯
</td>
<td>
7.630650e-08
</td>
<td>
0.0021026626
</td>
<td>
NA
</td>
<td>
85.06858
</td>
<td>
0.76335410
</td>
<td>
1
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
2.4614500
</td>
<td>
8.332597
</td>
</tr>
<tr>
<td>
2018-07-22 22:00:00
</td>
<td>
3.810747
</td>
<td>
4.310967e-16
</td>
<td>
3.270931e-06
</td>
<td>
3.808663
</td>
<td>
1.3221299
</td>
<td>
11.15502
</td>
<td>
0.008972078
</td>
<td>
0.0006097459
</td>
<td>
0.8179345
</td>
<td>
⋯
</td>
<td>
6.964864e-08
</td>
<td>
0.0002744484
</td>
<td>
NA
</td>
<td>
75.75246
</td>
<td>
-0.09013074
</td>
<td>
2
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
0.3212788
</td>
<td>
7.582162
</td>
</tr>
<tr>
<td>
2018-07-22 22:30:00
</td>
<td>
4.409078
</td>
<td>
1.620700e-16
</td>
<td>
-7.665109e-06
</td>
<td>
4.406794
</td>
<td>
1.3323178
</td>
<td>
11.15232
</td>
<td>
0.008923315
</td>
<td>
0.0006097643
</td>
<td>
0.8335655
</td>
<td>
⋯
</td>
<td>
8.022387e-08
</td>
<td>
0.0025132864
</td>
<td>
NA
</td>
<td>
76.33619
</td>
<td>
0.19445437
</td>
<td>
1
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
2.9421405
</td>
<td>
6.405388
</td>
</tr>
<tr>
<td>
2018-07-22 23:00:00
</td>
<td>
3.873026
</td>
<td>
2.977127e-16
</td>
<td>
-1.294909e-05
</td>
<td>
3.871143
</td>
<td>
1.3683514
</td>
<td>
10.78057
</td>
<td>
0.008990173
</td>
<td>
0.0006105977
</td>
<td>
0.8732912
</td>
<td>
⋯
</td>
<td>
7.507837e-08
</td>
<td>
0.0029890703
</td>
<td>
NA
</td>
<td>
78.40076
</td>
<td>
0.41666893
</td>
<td>
1
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
3.4991097
</td>
<td>
6.641999
</td>
</tr>
<tr>
<td>
2018-07-22 23:30:00
</td>
<td>
4.861514
</td>
<td>
-2.500325e-16
</td>
<td>
4.084664e-06
</td>
<td>
4.861716
</td>
<td>
1.4144546
</td>
<td>
10.67567
</td>
<td>
0.008985399
</td>
<td>
0.0006120489
</td>
<td>
0.9869727
</td>
<td>
⋯
</td>
<td>
8.122176e-08
</td>
<td>
0.0078762013
</td>
<td>
NA
</td>
<td>
81.04228
</td>
<td>
0.54988229
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NA
</td>
<td>
9.2201553
</td>
<td>
4.659475
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="2-step-1-post-processing-of-the-raw-eddy-covariance-data.html#cb8-1" tabindex="-1"></a><span class="fu">saveRDS</span>(dat,<span class="at">file=</span><span class="st">&quot;../data/ec-data_30min_processed/processed_data_example.rds&quot;</span>)</span></code></pre></div>
<p>Note, different sensors may require different correction methods, see also Foken, 2017. Additionally, the angles in the rotation can also be checked to verify if the applied rotation method is suitable (for longer time periods planar fit would be an alternative, e.g., if there is a systematic topographically induced vertical wind speed, and for stable stratification it should be checked whether the angles stay somehow constant and do not flip due to sign changes of the close-to-zero fluxes).</p>
</div>
<div id="literature" class="section level3" number="2.0.2">
<h3><span class="header-section-number">2.0.2</span> Literature</h3>
<ul>
<li>Foken, T. (2017). Micrometeorology, Springer-Verlag Berlin Heidelberg, DOI: 10.1007/978-3-642-25440-6.</li>
</ul>

</div>
</div>
<p style="text-align: center;">
<a href="index.html"><button class="btn btn-default">Previous</button></a>
<a href="3-calculation-of-some-basic-turbulence-quantities.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
