<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Turbulence diagnostics | Reddy: An open-source package for analyzing eddy-covariance data</title>
  <meta name="description" content="3 Turbulence diagnostics | Reddy: An open-source package for analyzing eddy-covariance data" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Turbulence diagnostics | Reddy: An open-source package for analyzing eddy-covariance data" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="noctiluc3nt/Reddy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Turbulence diagnostics | Reddy: An open-source package for analyzing eddy-covariance data" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="post-processing-of-raw-eddy-covariance-data.html"/>
<link rel="next" href="quadrant-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/noctiluc3nt/Reddy" target="blank"><bf>Reddy<bf></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html"><i class="fa fa-check"></i><b>2</b> Post-processing of raw eddy-covariance data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#eddy-covariance-method"><i class="fa fa-check"></i><b>2.1</b> Eddy-covariance method</a></li>
<li class="chapter" data-level="2.2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#raw-data-handling-and-corrections"><i class="fa fa-check"></i><b>2.2</b> Raw data handling and corrections</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#choosing-a-suitable-averaging-time"><i class="fa fa-check"></i><b>2.2.1</b> Choosing a suitable averaging time</a></li>
<li class="chapter" data-level="2.2.2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#overview-of-correction-procedures-applied-to-the-raw-data"><i class="fa fa-check"></i><b>2.2.2</b> Overview of correction procedures applied to the raw data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#an-example-post-processing-routine"><i class="fa fa-check"></i><b>2.3</b> An example post-processing routine</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html"><i class="fa fa-check"></i><b>3</b> Turbulence diagnostics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#calculation-of-standard-turbulence-diagnostics-and-simple-timeseries-plots"><i class="fa fa-check"></i><b>3.1</b> Calculation of standard turbulence diagnostics and simple timeseries plots</a></li>
<li class="chapter" data-level="3.2" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#regime-plots"><i class="fa fa-check"></i><b>3.2</b> Regime plots</a></li>
<li class="chapter" data-level="3.3" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#stability-dependence"><i class="fa fa-check"></i><b>3.3</b> Stability dependence</a></li>
<li class="chapter" data-level="3.4" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#literature"><i class="fa fa-check"></i><b>3.4</b> Literature</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html"><i class="fa fa-check"></i><b>4</b> Quadrant Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html#calculation-of-occurrence-frequencies-and-strengths-of-the-four-quadrants-with-calc_quadrant_analysis"><i class="fa fa-check"></i><b>4.1</b> Calculation of occurrence frequencies and strengths of the four quadrants with <code>calc_quadrant_analysis</code></a></li>
<li class="chapter" data-level="4.2" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html#plotting-quadrant-analysis-with-plot_quadrant_analysis"><i class="fa fa-check"></i><b>4.2</b> Plotting quadrant analysis with <code>plot_quadrant_analysis</code></a></li>
<li class="chapter" data-level="4.3" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html#literature-1"><i class="fa fa-check"></i><b>4.3</b> Literature</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spectra.html"><a href="spectra.html"><i class="fa fa-check"></i><b>5</b> Spectra</a>
<ul>
<li class="chapter" data-level="5.1" data-path="spectra.html"><a href="spectra.html#multiresolution-decomposition-mrd"><i class="fa fa-check"></i><b>5.1</b> Multiresolution decomposition (MRD)</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="spectra.html"><a href="spectra.html#calculating-multiresolution-decomposition-with-calc_mrd"><i class="fa fa-check"></i><b>5.1.1</b> Calculating multiresolution decomposition with <code>calc_mrd</code></a></li>
<li class="chapter" data-level="5.1.2" data-path="spectra.html"><a href="spectra.html#plotting-multiresolution-decomposition-with-plot_mrd"><i class="fa fa-check"></i><b>5.1.2</b> Plotting multiresolution decomposition with <code>plot_mrd</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="spectra.html"><a href="spectra.html#literature-2"><i class="fa fa-check"></i><b>5.2</b> Literature</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="flux-footprint.html"><a href="flux-footprint.html"><i class="fa fa-check"></i><b>6</b> Flux Footprint</a>
<ul>
<li class="chapter" data-level="6.1" data-path="flux-footprint.html"><a href="flux-footprint.html#d-flux-footprint"><i class="fa fa-check"></i><b>6.1</b> 2d flux footprint</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="flux-footprint.html"><a href="flux-footprint.html#calculate-2d-flux-footprint-estimate-with-calc_flux_footprint"><i class="fa fa-check"></i><b>6.1.1</b> Calculate 2d flux footprint estimate with <code>calc_flux_footprint</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="flux-footprint.html"><a href="flux-footprint.html#plotting-of-flux-footprint-with-plot_flux_footprint"><i class="fa fa-check"></i><b>6.1.2</b> Plotting of flux footprint with <code>plot_flux_footprint</code></a></li>
<li class="chapter" data-level="6.1.3" data-path="flux-footprint.html"><a href="flux-footprint.html#literature-3"><i class="fa fa-check"></i><b>6.1.3</b> Literature</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html"><i class="fa fa-check"></i><b>7</b> Reynolds stress tensor</a>
<ul>
<li class="chapter" data-level="7.1" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#invariant-analysis-of-the-reynolds-stress-tensor"><i class="fa fa-check"></i><b>7.1</b> Invariant analysis of the Reynolds stress tensor</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#performing-the-invariant-analysis-of-the-reynolds-stress-tensor-with-calc_anisotropy"><i class="fa fa-check"></i><b>7.1.1</b> Performing the invariant analysis of the Reynolds stress tensor with <code>calc_anisotropy</code></a></li>
<li class="chapter" data-level="7.1.2" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#plotting-the-barycentric-map-using-plot_barycentric_map"><i class="fa fa-check"></i><b>7.1.2</b> Plotting the barycentric map using <code>plot_barycentric_map</code></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#anisotropy-and-velocity-aspect-ratio-var"><i class="fa fa-check"></i><b>7.2</b> Anisotropy and velocity aspect ratio (VAR)</a></li>
<li class="chapter" data-level="7.3" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#literature-4"><i class="fa fa-check"></i><b>7.3</b> Literature</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="surface-energy-balance-seb.html"><a href="surface-energy-balance-seb.html"><i class="fa fa-check"></i><b>8</b> Surface energy balance (SEB)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="surface-energy-balance-seb.html"><a href="surface-energy-balance-seb.html#background"><i class="fa fa-check"></i><b>8.1</b> Background</a></li>
<li class="chapter" data-level="8.2" data-path="surface-energy-balance-seb.html"><a href="surface-energy-balance-seb.html#calculating-surface-energy-balance"><i class="fa fa-check"></i><b>8.2</b> Calculating surface energy balance</a></li>
<li class="chapter" data-level="8.3" data-path="surface-energy-balance-seb.html"><a href="surface-energy-balance-seb.html#bowen-ratio-and-evaporative-fraction"><i class="fa fa-check"></i><b>8.3</b> Bowen ratio and evaporative fraction</a></li>
<li class="chapter" data-level="8.4" data-path="surface-energy-balance-seb.html"><a href="surface-energy-balance-seb.html#clear-sky-index-csi-for-contextualization-calc_csi"><i class="fa fa-check"></i><b>8.4</b> Clear-Sky-Index (CSI) for contextualization (<code>calc_csi</code>)</a></li>
<li class="chapter" data-level="8.5" data-path="surface-energy-balance-seb.html"><a href="surface-energy-balance-seb.html#literature-5"><i class="fa fa-check"></i><b>8.5</b> Literature</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown<br> (Laura Mack, 2024)</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reddy: An open-source package for analyzing eddy-covariance data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="turbulence-diagnostics" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Turbulence diagnostics<a href="turbulence-diagnostics.html#turbulence-diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>After completing the post-processing, we can now move on to looking at some turbulence diagnostics.
Based on the generated half-hourly output of the first notebook (<a href="https://github.com/noctiluc3nt/ec_analyze/blob/main/notebooks/01_post-processing.ipynb">01_post-processing.ipynb</a>) some standard turbulence quantities, i.e. stability parameter, friction velocity, TKE, turbulence intensity are calculated and plotted, which allow to study flow properties.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="turbulence-diagnostics.html#cb9-1" aria-hidden="true"></a><span class="co">#loading Reddy package</span></span>
<span id="cb9-2"><a href="turbulence-diagnostics.html#cb9-2" aria-hidden="true"></a><span class="kw">install.packages</span>(<span class="st">&quot;../src/Reddy_0.0.0.9000.tar.gz&quot;</span>,<span class="dt">repos=</span><span class="ot">NULL</span>,<span class="dt">source=</span><span class="ot">TRUE</span>)</span>
<span id="cb9-3"><a href="turbulence-diagnostics.html#cb9-3" aria-hidden="true"></a><span class="kw">library</span>(Reddy)</span>
<span id="cb9-4"><a href="turbulence-diagnostics.html#cb9-4" aria-hidden="true"></a><span class="kw">library</span>(latex2exp)</span>
<span id="cb9-5"><a href="turbulence-diagnostics.html#cb9-5" aria-hidden="true"></a>kap=<span class="cf">function</span>() <span class="kw">return</span>(<span class="fl">0.4</span>)</span></code></pre></div>
<pre><code>Installing package into ‘/home/lauracma/R/x86_64-pc-linux-gnu-library/4.0’
(as ‘lib’ is unspecified)</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="turbulence-diagnostics.html#cb11-1" aria-hidden="true"></a><span class="co">#read in processed example data</span></span>
<span id="cb11-2"><a href="turbulence-diagnostics.html#cb11-2" aria-hidden="true"></a>dat=<span class="kw">readRDS</span>(<span class="st">&quot;../data/ec-data_30min_processed/processed_data_example.rds&quot;</span>)</span></code></pre></div>
<div id="calculation-of-standard-turbulence-diagnostics-and-simple-timeseries-plots" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Calculation of standard turbulence diagnostics and simple timeseries plots<a href="turbulence-diagnostics.html#calculation-of-standard-turbulence-diagnostics-and-simple-timeseries-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here, some functions from the Reddy package are used to calculate turbulent kinetic energy <span class="math inline">\(TKE\)</span>, velocity scale of TKE <span class="math inline">\(V_{TKE}\)</span>, horizontal turbulence intensity <span class="math inline">\(TI\)</span>, vertical turbulence intensity <span class="math inline">\(I_w\)</span>, friction velocity <span class="math inline">\(u_*\)</span>, Obukhov length <span class="math inline">\(L\)</span>, stability parameter <span class="math inline">\(\zeta\)</span> and directional shear angle and plot their timeseries for the previously post-processed example data. <br></p>
<ul>
<li><strong>Turbulence intensity</strong> (<code>calc_ti</code> and <code>calc_iw</code>): Turbulence intensity generally refers to the standard deviation, e.g., <span class="math inline">\(\sigma_u, \sigma_v, \sigma_w, \sigma_T\)</span>, and thus describes the mean fluctuation intensity. The horizontal turbulence intensity TI (<code>calc_ti</code>) and the vertical turbulence intensity <span class="math inline">\(I_w\)</span> (<code>calc_iw</code>) are calculated by normalizing the respective standard deviations with the mean wind speed <span class="math inline">\(\overline{u}\)</span>:
<span class="math display">\[TI = ,\quad\quad I_w= \frac{\sigma_w}{\overline{u}} \]</span></li>
<li><strong>Turbulent kinetic energy TKE</strong> (<code>calc_tke</code>): TKE describes the mean kinetic energy that the eddies contain and is calculated by
<span class="math display">\[ TKE = 0.5 (\sigma_u^2 + \sigma_v^2 + \sigma_w^2) =0.5 (\overline{u&#39;^2} + \overline{v&#39;^2} + \overline{w&#39;^2}  ).\]</span>
From the TKE, a velocity scale can easily be derived <span class="math inline">\(V_{TKE} = \sqrt{TKE}\)</span> (<code>calc_vtke</code>).</li>
<li><strong>Friction velocity</strong> <span class="math inline">\(u_*\)</span> (<code>calc_ustar</code>): The friction velocity describes the effect of friction in form of a velocity scale
<span class="math display">\[ u_* = \sqrt[4]{\overline{u&#39;v&#39;}^2+\overline{v&#39;w&#39;}^2}.\]</span></li>
<li><strong>Obukhov length</strong> <span class="math inline">\(L\)</span> (<code>calc_L</code>): The Obukhov length is a length scale that describes the effect of buoyancy
<span class="math display">\[ L = -\frac{u_*^3 \overline{T_v}}{\kappa \,g\,\overline{w&#39;T&#39;}}, \]</span>
which is central in Monin-Obukhov similarity theory (MOST) to derive dimensionless scaling parameter, like the stability parameter <span class="math inline">\(\zeta\)</span>.
The fluxes used in the calculation are either the surface fluxes for global scaling or the fluxes at the measurement height for local scaling.</li>
<li><strong>Stability parameter</strong> <span class="math inline">\(\zeta\)</span> (<code>calc_zeta</code>): The stability parameter is the ratio of Obukhov length and measurement height and thus a dimensionless measure for stability
<span class="math display">\[ \zeta = \frac{z}{L}.\]</span></li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="turbulence-diagnostics.html#cb12-1" aria-hidden="true"></a><span class="co">#calculation of some useful turbulence diagnostics</span></span>
<span id="cb12-2"><a href="turbulence-diagnostics.html#cb12-2" aria-hidden="true"></a>dat<span class="op">$</span>tke=<span class="kw">calc_tke</span>(dat<span class="op">$</span>u_sd,dat<span class="op">$</span>v_sd,dat<span class="op">$</span>w_sd)</span>
<span id="cb12-3"><a href="turbulence-diagnostics.html#cb12-3" aria-hidden="true"></a>dat<span class="op">$</span>vtke=<span class="kw">calc_vtke</span>(dat<span class="op">$</span>u_sd,dat<span class="op">$</span>v_sd,dat<span class="op">$</span>w_sd)</span>
<span id="cb12-4"><a href="turbulence-diagnostics.html#cb12-4" aria-hidden="true"></a>dat<span class="op">$</span>ti=<span class="kw">calc_ti</span>(dat<span class="op">$</span>u_sd,dat<span class="op">$</span>v_sd,dat<span class="op">$</span>ws_mean)</span>
<span id="cb12-5"><a href="turbulence-diagnostics.html#cb12-5" aria-hidden="true"></a>dat<span class="op">$</span>iw=<span class="kw">calc_iw</span>(dat<span class="op">$</span>w_sd,dat<span class="op">$</span>ws_mean)</span>
<span id="cb12-6"><a href="turbulence-diagnostics.html#cb12-6" aria-hidden="true"></a>dat<span class="op">$</span>ustar=<span class="kw">calc_ustar</span>(dat<span class="op">$</span>cov_uw,dat<span class="op">$</span>cov_vw)</span>
<span id="cb12-7"><a href="turbulence-diagnostics.html#cb12-7" aria-hidden="true"></a>dat<span class="op">$</span>L=<span class="kw">calc_L</span>(dat<span class="op">$</span>ustar,dat<span class="op">$</span>T_mean,dat<span class="op">$</span>cov_wT)</span>
<span id="cb12-8"><a href="turbulence-diagnostics.html#cb12-8" aria-hidden="true"></a>dat<span class="op">$</span>zeta=<span class="kw">calc_zeta</span>(<span class="fl">4.4</span>,dat<span class="op">$</span>L)</span>
<span id="cb12-9"><a href="turbulence-diagnostics.html#cb12-9" aria-hidden="true"></a>dat<span class="op">$</span>alpha_uw=<span class="kw">calc_dshear</span>(dat<span class="op">$</span>cov_uw,dat<span class="op">$</span>cov_vw)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="turbulence-diagnostics.html#cb13-1" aria-hidden="true"></a><span class="co">#basic timeseries plots</span></span>
<span id="cb13-2"><a href="turbulence-diagnostics.html#cb13-2" aria-hidden="true"></a><span class="kw">plot</span>(dat<span class="op">$</span>T_mean,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;temperature [°C]&quot;</span>,<span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb13-3"><a href="turbulence-diagnostics.html#cb13-3" aria-hidden="true"></a><span class="kw">plot</span>(dat<span class="op">$</span>ws_mean,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;wind speed [m/s]&quot;</span>)</span>
<span id="cb13-4"><a href="turbulence-diagnostics.html#cb13-4" aria-hidden="true"></a><span class="kw">plot</span>(dat<span class="op">$</span>tke,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="kw">TeX</span>(<span class="st">&quot;TKE [$m^2/s^2$]&quot;</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb13-5"><a href="turbulence-diagnostics.html#cb13-5" aria-hidden="true"></a><span class="kw">plot</span>(dat<span class="op">$</span>zeta,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;stability parameter [-]&quot;</span>)</span>
<span id="cb13-6"><a href="turbulence-diagnostics.html#cb13-6" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb13-7"><a href="turbulence-diagnostics.html#cb13-7" aria-hidden="true"></a><span class="kw">plot</span>(dat<span class="op">$</span>ti,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;turbulence intensity [-]&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb13-8"><a href="turbulence-diagnostics.html#cb13-8" aria-hidden="true"></a><span class="kw">points</span>(dat<span class="op">$</span>iw,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;gray50&quot;</span>)</span>
<span id="cb13-9"><a href="turbulence-diagnostics.html#cb13-9" aria-hidden="true"></a><span class="kw">plot</span>(dat<span class="op">$</span>cov_uw,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="kw">TeX</span>(<span class="st">&quot;cov(u,w) [$m^2/s^2$]&quot;</span>))</span>
<span id="cb13-10"><a href="turbulence-diagnostics.html#cb13-10" aria-hidden="true"></a><span class="kw">plot</span>(dat<span class="op">$</span>cov_wT,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="kw">TeX</span>(<span class="st">&quot;cov(T,w) [$K m/s$]&quot;</span>))</span>
<span id="cb13-11"><a href="turbulence-diagnostics.html#cb13-11" aria-hidden="true"></a><span class="kw">plot</span>(dat<span class="op">$</span>cov_h2ow,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="kw">TeX</span>(<span class="st">&quot;cov(q,w) [$mmol m/s$]&quot;</span>))</span>
<span id="cb13-12"><a href="turbulence-diagnostics.html#cb13-12" aria-hidden="true"></a><span class="kw">plot</span>(dat<span class="op">$</span>cov_co2w,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="kw">TeX</span>(<span class="st">&quot;cov(c,w) [$ppm m/s$]&quot;</span>))</span></code></pre></div>
<div class="figure">
<img src="output_5_0.png" alt="" />
<p class="caption">png</p>
</div>
<div class="figure">
<img src="output_5_1.png" alt="" />
<p class="caption">png</p>
</div>
<div class="figure">
<img src="output_5_2.png" alt="" />
<p class="caption">png</p>
</div>
<div class="figure">
<img src="output_5_3.png" alt="" />
<p class="caption">png</p>
</div>
<div class="figure">
<img src="output_5_4.png" alt="" />
<p class="caption">png</p>
</div>
<div class="figure">
<img src="output_5_5.png" alt="" />
<p class="caption">png</p>
</div>
<div class="figure">
<img src="output_5_6.png" alt="" />
<p class="caption">png</p>
</div>
<div class="figure">
<img src="output_5_7.png" alt="" />
<p class="caption">png</p>
</div>
<div class="figure">
<img src="output_5_8.png" alt="" />
<p class="caption">png</p>
</div>
</div>
<div id="regime-plots" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Regime plots<a href="turbulence-diagnostics.html#regime-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To diagnose different turbulence regimes, scatter plots of different turbulence diagnostics can be used. Here are some examples plotting wind speed vs TKE or stability parameter vs TKE (see e.g., Sun et al., 2012).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="turbulence-diagnostics.html#cb14-1" aria-hidden="true"></a><span class="co">#some basic plots</span></span>
<span id="cb14-2"><a href="turbulence-diagnostics.html#cb14-2" aria-hidden="true"></a><span class="kw">plot</span>(dat<span class="op">$</span>ws_mean,dat<span class="op">$</span>tke,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),<span class="dt">xlab=</span><span class="st">&quot;wind speed [m/s]&quot;</span>,<span class="dt">ylab=</span><span class="kw">TeX</span>(<span class="st">&quot;TKE [$m^2/s^2$]&quot;</span>))</span>
<span id="cb14-3"><a href="turbulence-diagnostics.html#cb14-3" aria-hidden="true"></a>cond=(dat<span class="op">$</span>ws_mean<span class="op">&gt;</span><span class="dv">2</span>)</span>
<span id="cb14-4"><a href="turbulence-diagnostics.html#cb14-4" aria-hidden="true"></a>fit=<span class="kw">lm</span>(dat<span class="op">$</span>tke[cond]<span class="op">~</span>dat<span class="op">$</span>ws_mean[cond])</span>
<span id="cb14-5"><a href="turbulence-diagnostics.html#cb14-5" aria-hidden="true"></a><span class="kw">abline</span>(fit,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb14-6"><a href="turbulence-diagnostics.html#cb14-6" aria-hidden="true"></a></span>
<span id="cb14-7"><a href="turbulence-diagnostics.html#cb14-7" aria-hidden="true"></a><span class="kw">plot</span>(dat<span class="op">$</span>zeta,dat<span class="op">$</span>tke,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),<span class="dt">xlab=</span><span class="st">&quot;stability parameter [m/s]&quot;</span>,<span class="dt">ylab=</span><span class="kw">TeX</span>(<span class="st">&quot;TKE [$m^2/s^2$]&quot;</span>))</span></code></pre></div>
<div class="figure">
<img src="output_7_0.png" alt="" />
<p class="caption">png</p>
</div>
<div class="figure">
<img src="output_7_1.png" alt="" />
<p class="caption">png</p>
</div>
</div>
<div id="stability-dependence" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Stability dependence<a href="turbulence-diagnostics.html#stability-dependence" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Often it is interesting to investigate the stability dependence of turbulence characteristics. For this the function <code>binning</code> can be used, which bins one variable based on another for predefined bins, as exemplified below for the dependence of the sensible heat flux on the stability parameter. The output contains mean, median, 25% and 75% quartile per discrete bin as dataframe. The used variables and the bins can be customized. Such type of analysis is usually applied to longer timeseries.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="turbulence-diagnostics.html#cb15-1" aria-hidden="true"></a>zeta_bins=<span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span><span class="op">^</span>(<span class="dv">2</span><span class="op">:-</span><span class="dv">2</span>),<span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">2</span><span class="op">:</span><span class="dv">2</span>))</span>
<span id="cb15-2"><a href="turbulence-diagnostics.html#cb15-2" aria-hidden="true"></a>sh_binned=<span class="kw">binning</span>(dat<span class="op">$</span>sh,dat<span class="op">$</span>zeta,zeta_bins)</span>
<span id="cb15-3"><a href="turbulence-diagnostics.html#cb15-3" aria-hidden="true"></a>sh_binned <span class="co">#look at output</span></span>
<span id="cb15-4"><a href="turbulence-diagnostics.html#cb15-4" aria-hidden="true"></a>xbins=<span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span><span class="op">^</span>(<span class="dv">2</span><span class="op">:-</span><span class="dv">1</span>),<span class="dv">0</span>,<span class="dv">5</span><span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</span>
<span id="cb15-5"><a href="turbulence-diagnostics.html#cb15-5" aria-hidden="true"></a><span class="kw">plot</span>(xbins,sh_binned[,<span class="dv">2</span>],<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">150</span>),<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">xlab=</span><span class="st">&quot;stability parameter [-]&quot;</span>,<span class="dt">ylab=</span><span class="kw">TeX</span>(<span class="st">&quot;SH [W/m$^2$]&quot;</span>))</span>
<span id="cb15-6"><a href="turbulence-diagnostics.html#cb15-6" aria-hidden="true"></a><span class="kw">points</span>(xbins,sh_binned[,<span class="dv">3</span>],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb15-7"><a href="turbulence-diagnostics.html#cb15-7" aria-hidden="true"></a><span class="kw">points</span>(xbins,sh_binned[,<span class="dv">4</span>],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb15-8"><a href="turbulence-diagnostics.html#cb15-8" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb15-9"><a href="turbulence-diagnostics.html#cb15-9" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<table class="dataframe">
<caption>
A matrix: 9 × 4 of type dbl
</caption>
<tbody>
<tr>
<td>
122.045246
</td>
<td>
116.804837
</td>
<td>
109.052920
</td>
<td>
129.797163
</td>
</tr>
<tr>
<td>
120.620398
</td>
<td>
125.471467
</td>
<td>
75.448402
</td>
<td>
167.986972
</td>
</tr>
<tr>
<td>
17.306097
</td>
<td>
12.061651
</td>
<td>
5.647776
</td>
<td>
24.415438
</td>
</tr>
<tr>
<td>
1.823135
</td>
<td>
1.864732
</td>
<td>
1.093005
</td>
<td>
2.574063
</td>
</tr>
<tr>
<td>
NA
</td>
<td>
NA
</td>
<td>
NA
</td>
<td>
NA
</td>
</tr>
<tr>
<td>
-3.564331
</td>
<td>
-3.564331
</td>
<td>
-3.564331
</td>
<td>
-3.564331
</td>
</tr>
<tr>
<td>
-11.192381
</td>
<td>
-12.213284
</td>
<td>
-13.937180
</td>
<td>
-8.561890
</td>
</tr>
<tr>
<td>
-18.102981
</td>
<td>
-19.201199
</td>
<td>
-22.358905
</td>
<td>
-14.674265
</td>
</tr>
<tr>
<td>
-8.655841
</td>
<td>
-10.389901
</td>
<td>
-11.853905
</td>
<td>
-6.324807
</td>
</tr>
</tbody>
</table>
<div class="figure">
<img src="output_9_1.png" alt="" />
<p class="caption">png</p>
</div>
</div>
<div id="literature" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Literature<a href="turbulence-diagnostics.html#literature" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Sun, J., Mahrt, L., Banta, R. M., and Pichugina, Y. L. (2012). Turbulence Regimes and Turbulence Intermittency in the Stable Boundary Layer during CASES-99. J Atmos Sci, 69:338–351.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="post-processing-of-raw-eddy-covariance-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="quadrant-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc depth": 2,
"github-repo": "noctiluc3nt/ec_analyze"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
