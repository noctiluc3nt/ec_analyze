<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Quadrant analysis | Reddy: An open-source package for analyzing eddy-covariance data</title>
  <meta name="description" content="4 Quadrant analysis | Reddy: An open-source package for analyzing eddy-covariance data" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Quadrant analysis | Reddy: An open-source package for analyzing eddy-covariance data" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="noctiluc3nt/Reddy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Quadrant analysis | Reddy: An open-source package for analyzing eddy-covariance data" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="turbulence-diagnostics.html"/>
<link rel="next" href="spectra.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/noctiluc3nt/Reddy" target="blank"><bf>Reddy<bf></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#measurement-setup-and-instrumentation"><i class="fa fa-check"></i><b>1.1</b> Measurement setup and instrumentation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.2</b> Data sources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html"><i class="fa fa-check"></i><b>2</b> Post-processing of raw eddy-covariance data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#eddy-covariance-method"><i class="fa fa-check"></i><b>2.1</b> Eddy-covariance method</a></li>
<li class="chapter" data-level="2.2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#raw-data-handling-and-corrections"><i class="fa fa-check"></i><b>2.2</b> Raw data handling and corrections</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#choosing-a-suitable-averaging-time"><i class="fa fa-check"></i><b>2.2.1</b> Choosing a suitable averaging time</a></li>
<li class="chapter" data-level="2.2.2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#overview-of-correction-procedures-applied-to-the-raw-data"><i class="fa fa-check"></i><b>2.2.2</b> Overview of correction procedures applied to the raw data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#an-example-post-processing-routine"><i class="fa fa-check"></i><b>2.3</b> An example post-processing routine</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html"><i class="fa fa-check"></i><b>3</b> Turbulence diagnostics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#standard-turbulence-diagnostics-and-simple-timeseries-plots"><i class="fa fa-check"></i><b>3.1</b> Standard turbulence diagnostics and simple timeseries plots</a></li>
<li class="chapter" data-level="3.2" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#stability-dependence"><i class="fa fa-check"></i><b>3.2</b> Stability dependence</a></li>
<li class="chapter" data-level="3.3" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#turbulence-regimes"><i class="fa fa-check"></i><b>3.3</b> Turbulence regimes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html"><i class="fa fa-check"></i><b>4</b> Quadrant analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html#calculation-of-occurrence-frequencies-and-strengths-of-the-four-quadrants-with-calc_quadrant_analysis"><i class="fa fa-check"></i><b>4.1</b> Calculation of occurrence frequencies and strengths of the four quadrants with <code>calc_quadrant_analysis</code></a></li>
<li class="chapter" data-level="4.2" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html#plotting-quadrant-analysis-with-plot_quadrant_analysis"><i class="fa fa-check"></i><b>4.2</b> Plotting quadrant analysis with <code>plot_quadrant_analysis</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spectra.html"><a href="spectra.html"><i class="fa fa-check"></i><b>5</b> Spectra</a>
<ul>
<li class="chapter" data-level="5.1" data-path="spectra.html"><a href="spectra.html#spectral-analysis-of-timeseries"><i class="fa fa-check"></i><b>5.1</b> Spectral analysis of timeseries</a></li>
<li class="chapter" data-level="5.2" data-path="spectra.html"><a href="spectra.html#fft-spectrum-and-comparison-to-theoretical-spectra"><i class="fa fa-check"></i><b>5.2</b> FFT spectrum and comparison to theoretical spectra</a></li>
<li class="chapter" data-level="5.3" data-path="spectra.html"><a href="spectra.html#multiresolution-decomposition-mrd"><i class="fa fa-check"></i><b>5.3</b> Multiresolution decomposition (MRD)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="spectra.html"><a href="spectra.html#calculating-multiresolution-decomposition-with-calc_mrd"><i class="fa fa-check"></i><b>5.3.1</b> Calculating multiresolution decomposition with <code>calc_mrd</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="spectra.html"><a href="spectra.html#plotting-multiresolution-decomposition-with-plot_mrd"><i class="fa fa-check"></i><b>5.3.2</b> Plotting multiresolution decomposition with <code>plot_mrd</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html"><i class="fa fa-check"></i><b>6</b> Reynolds stress tensor</a>
<ul>
<li class="chapter" data-level="6.1" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#invariant-analysis-of-the-reynolds-stress-tensor"><i class="fa fa-check"></i><b>6.1</b> Invariant analysis of the Reynolds stress tensor</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#performing-the-invariant-analysis-of-the-reynolds-stress-tensor-with-calc_anisotropy"><i class="fa fa-check"></i><b>6.1.1</b> Performing the invariant analysis of the Reynolds stress tensor with <code>calc_anisotropy</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#plotting-the-barycentric-map-using-plot_barycentric_map"><i class="fa fa-check"></i><b>6.1.2</b> Plotting the barycentric map using <code>plot_barycentric_map</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#anisotropy-and-velocity-aspect-ratio-var"><i class="fa fa-check"></i><b>6.2</b> Anisotropy and velocity aspect ratio (VAR)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="flux-footprint.html"><a href="flux-footprint.html"><i class="fa fa-check"></i><b>7</b> Flux footprint</a>
<ul>
<li class="chapter" data-level="7.1" data-path="flux-footprint.html"><a href="flux-footprint.html#flux-footprint-parametrizations"><i class="fa fa-check"></i><b>7.1</b> Flux footprint parametrizations</a></li>
<li class="chapter" data-level="7.2" data-path="flux-footprint.html"><a href="flux-footprint.html#d-flux-footprint-estimate"><i class="fa fa-check"></i><b>7.2</b> 2D flux footprint estimate</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="flux-footprint.html"><a href="flux-footprint.html#calculate-2d-flux-footprint-estimate-with-calc_flux_footprint"><i class="fa fa-check"></i><b>7.2.1</b> Calculate 2D flux footprint estimate with <code>calc_flux_footprint</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="flux-footprint.html"><a href="flux-footprint.html#plotting-of-flux-footprint-with-plot_flux_footprint"><i class="fa fa-check"></i><b>7.2.2</b> Plotting of flux footprint with <code>plot_flux_footprint</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html"><i class="fa fa-check"></i><b>8</b> Surface energy balance</a>
<ul>
<li class="chapter" data-level="8.1" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#surface-energy-balance-closure"><i class="fa fa-check"></i><b>8.1</b> Surface energy balance closure</a></li>
<li class="chapter" data-level="8.2" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#calculating-surface-energy-balance"><i class="fa fa-check"></i><b>8.2</b> Calculating surface energy balance</a></li>
<li class="chapter" data-level="8.3" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#hydrological-measures-bowen-ratio-and-evaporative-fraction"><i class="fa fa-check"></i><b>8.3</b> Hydrological measures: Bowen ratio and evaporative fraction</a></li>
<li class="chapter" data-level="8.4" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#meteorological-contextualization"><i class="fa fa-check"></i><b>8.4</b> Meteorological contextualization</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown <br>(Laura Mack, 2024)</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reddy: An open-source package for analyzing eddy-covariance data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="quadrant-analysis" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Quadrant analysis<a href="quadrant-analysis.html#quadrant-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Quadrant analysis is a simple conditional sampling method to detect coherent structures directly from the high-frequency measurements (e.g. <span class="citation">Katul et al. (<a href="#ref-Katul1997" role="doc-biblioref">1997</a>)</span>) or simulations (e.g. <span class="citation">Wallace (<a href="#ref-Wallace2016" role="doc-biblioref">2016</a>)</span>). Coherent structures maintain their structure for a significant time period, and due to their coherence, they can generate deviations from mean flow properties (e.g. <span class="citation">Jimenez (<a href="#ref-Jimenez2018" role="doc-biblioref">2018</a>)</span>). For quadrant analysis a scatter plot of a pair of two variables is considered, which are normalized through
<span class="math display">\[ \hat{x} = \frac{x-\overline{x}}{\sigma_x}\]</span>
by substracting the mean value <span class="math inline">\(\overline{x}\)</span> and dividing by <span class="math inline">\(\sigma_x\)</span> to make different variables with different value ranges comparable and centered around zero. Based on this, strength <span class="math inline">\(S_i\)</span> and duration <span class="math inline">\(D_i\)</span> of each quadrant (<span class="math inline">\(i=1, ..., 4\)</span>) can be calculated:
<span class="math display">\[ S_i = \frac{\overline{\hat{x}&#39;\hat{w}&#39;}_i}{\overline{\hat{x}\hat{w}}}, \quad\quad D_i = \frac{1}{t_s} \int_0^{t_s} I_i(t) dt\]</span>
<span class="math inline">\(S_i\)</span> represents the relative strength of the respective quadrant (normalized by the total covariance) and <span class="math inline">\(D_i\)</span> the occurrence frequency of each quadrant (with averaging time <span class="math inline">\(t_s\)</span> and indicator function <span class="math inline">\(I_i\)</span>). To get an overall measure for the contribution of disorganized (i.e. counter-gradient contribution) versus organized (i.e. down-gradient contribution) structures, the exuberance <span class="math inline">\(E\)</span> <span class="citation">(Shaw, Tavanger, and Ward <a href="#ref-Shaw1983" role="doc-biblioref">1983</a>)</span> and the organization ratio <span class="math inline">\(OR\)</span> <span class="citation">(Mack et al. <a href="#ref-Mack2024" role="doc-biblioref">2024</a>)</span> can be defined as:
<span class="math display">\[ E = \frac{S(disorganized)}{S(organized)}, \quad\quad OR = \frac{D(disorganized)}{D(organized)}\]</span>
For example, for the sensible heat flux warm updrafts and cold downdrafts are the organized structures, and oppositely cold updrafts and warm downdrafts the disorganized ones (in the figure below, organized structures are shaded and disorganized are not shaded). <br>
To filter out particularly strong coherent structures, a hole size can be applied with the filter conditions <span class="math inline">\(\vert \hat{x}\hat{y} \vert \le H \cdot \vert \overline{\hat{x}&#39;\hat{y}&#39;}\vert\)</span> (hyperbolic curves in the figure). Usually, <span class="math inline">\(y\)</span> is chosen to be the vertical velocity <span class="math inline">\(w\)</span>. The quadrant analysis is directly related to the fluxes by using the respective constituting quantities: <span class="math inline">\((u,w)\)</span> for momentum flux, <span class="math inline">\((T,w)\)</span> for sensible heat flux, <span class="math inline">\((q,w)\)</span> for latent heat flux and <span class="math inline">\((c,w)\)</span> for CO<span class="math inline">\(_2\)</span> flux – as visualized in the figure (adapted from <span class="citation">Mack et al. (<a href="#ref-Mack2024" role="doc-biblioref">2024</a>)</span>).</p>
<p><img src="../figures/schema/qa_schema.png" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="quadrant-analysis.html#cb15-1" aria-hidden="true"></a><span class="co">#loading Reddy package</span></span>
<span id="cb15-2"><a href="quadrant-analysis.html#cb15-2" aria-hidden="true"></a><span class="kw">install.packages</span>(<span class="st">&quot;../src/Reddy_0.0.0.9000.tar.gz&quot;</span>,<span class="dt">repos=</span><span class="ot">NULL</span>,<span class="dt">source=</span><span class="ot">TRUE</span>,<span class="dt">quiet=</span><span class="ot">TRUE</span>)</span>
<span id="cb15-3"><a href="quadrant-analysis.html#cb15-3" aria-hidden="true"></a><span class="kw">library</span>(Reddy)</span>
<span id="cb15-4"><a href="quadrant-analysis.html#cb15-4" aria-hidden="true"></a></span>
<span id="cb15-5"><a href="quadrant-analysis.html#cb15-5" aria-hidden="true"></a><span class="co">#ec data files</span></span>
<span id="cb15-6"><a href="quadrant-analysis.html#cb15-6" aria-hidden="true"></a>dir_in=<span class="st">&quot;../data/ec-data_10Hz_raw&quot;</span></span>
<span id="cb15-7"><a href="quadrant-analysis.html#cb15-7" aria-hidden="true"></a>files=<span class="kw">list.files</span>(dir_in,<span class="dt">full.names=</span><span class="ot">TRUE</span>)</span>
<span id="cb15-8"><a href="quadrant-analysis.html#cb15-8" aria-hidden="true"></a>nf=<span class="kw">length</span>(files)</span></code></pre></div>
<div id="calculation-of-occurrence-frequencies-and-strengths-of-the-four-quadrants-with-calc_quadrant_analysis" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Calculation of occurrence frequencies and strengths of the four quadrants with <code>calc_quadrant_analysis</code><a href="quadrant-analysis.html#calculation-of-occurrence-frequencies-and-strengths-of-the-four-quadrants-with-calc_quadrant_analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To perform quadrant analysis, Reddy provides two functions: <code>calc_quadrant_analysis</code> for calculating occurrence frequency and strength of the four quadrants and <code>plot_quadrant_analysis</code> for plotting the two variables as scatter plot with a 2d kernel density estimation and a linear regression, as detailed below. <br>
The function <code>calc_quadrant_analysis</code> counts the occurrence frequency of each quadrant, calculates their strength as product <span class="math inline">\(\hat{x}\hat{y}\)</span> and as covariance <span class="math inline">\(\overline{\hat{x}&#39;\hat{y}&#39;}\)</span>. The argument <code>do_normalization = TRUE</code> can be used to normalize the two variables and with <code>hole_sizes</code> one or several hole sizes can be applied. The output is a list containing <span class="math inline">\(D_i\)</span>, <span class="math inline">\(S_i\)</span> for every quadrant and hole size.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="quadrant-analysis.html#cb16-1" aria-hidden="true"></a>i=<span class="dv">8</span> <span class="co">#select a file</span></span>
<span id="cb16-2"><a href="quadrant-analysis.html#cb16-2" aria-hidden="true"></a>tmp=<span class="kw">read.table</span>(files[i],<span class="dt">sep=</span><span class="st">&quot;,&quot;</span>,<span class="dt">header=</span>T)</span>
<span id="cb16-3"><a href="quadrant-analysis.html#cb16-3" aria-hidden="true"></a></span>
<span id="cb16-4"><a href="quadrant-analysis.html#cb16-4" aria-hidden="true"></a>qa_Tw=<span class="kw">calc_quadrant_analysis</span>(tmp<span class="op">$</span>T_degC,tmp<span class="op">$</span>w_m.s) <span class="co">#based on the raw data (10 Hz) directly (i.e., unrotated)</span></span>
<span id="cb16-5"><a href="quadrant-analysis.html#cb16-5" aria-hidden="true"></a><span class="kw">str</span>(qa_Tw)</span></code></pre></div>
<pre><code>List of 10
 $ hole_sizes        : int [1:11] 0 1 2 3 4 5 6 7 8 9 ...
 $ occurrence        : int [1:4, 1:11] 5448 2975 6619 2958 4689 144 3812 300 4232 8 ...
 $ product           : num [1:4, 1:11] 1.068 -0.291 0.619 -0.42 0.816 ...
 $ covariance        : num [1:4, 1:11] 0.10672 0.05309 -0.00914 0.03226 0.31902 ...
 $ covariance_total  : num 0.15
 $ correlation_total : num 0.434
 $ product_total     : num [1:18000] 0.0448 -0.0544 -0.4983 0.115 0.3095 ...
 $ exuberance        : num [1:11] -0.422 -2.699 -5.521 -7.411 NaN ...
 $ organization_ratio: num [1:11] 0.491672 0.052229 0.00992 0.002498 0.000495 ...
 $ meta              : chr &quot;Output format: rows represent the quadrants Q1, Q2, Q3, Q4 -- columns represent selected hole sizes&quot;</code></pre>
</div>
<div id="plotting-quadrant-analysis-with-plot_quadrant_analysis" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Plotting quadrant analysis with <code>plot_quadrant_analysis</code><a href="quadrant-analysis.html#plotting-quadrant-analysis-with-plot_quadrant_analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>plot_quadrant_analysis</code> plots a scatter plot of two variables with a 2d kernel density estimation (<code>MASS::kde2d</code>) and a linear regression (<code>lm()</code>) to allow for a visual inspection.</p>
<p><strong>Example: Quadrant Analysis (T,w) during daytime</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="quadrant-analysis.html#cb18-1" aria-hidden="true"></a>i=<span class="dv">8</span> <span class="co">#select a file -- a daytime example</span></span>
<span id="cb18-2"><a href="quadrant-analysis.html#cb18-2" aria-hidden="true"></a><span class="kw">print</span>(files[i])</span>
<span id="cb18-3"><a href="quadrant-analysis.html#cb18-3" aria-hidden="true"></a>tmp=<span class="kw">read.table</span>(files[i],<span class="dt">sep=</span><span class="st">&quot;,&quot;</span>,<span class="dt">header=</span>T)</span>
<span id="cb18-4"><a href="quadrant-analysis.html#cb18-4" aria-hidden="true"></a></span>
<span id="cb18-5"><a href="quadrant-analysis.html#cb18-5" aria-hidden="true"></a><span class="kw">plot_quadrant_analysis</span>(tmp<span class="op">$</span>T_degC,tmp<span class="op">$</span>w_m.s,<span class="dt">xlab=</span><span class="st">&quot;T (normalized)&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;w (normalized)&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Quadrant Analysis (T,w)&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;../data/ec-data_10Hz_raw/2018-07-20T120000.csv&quot;

Call:
lm(formula = yval ~ xval)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5818 -0.5491  0.0005  0.5471  4.1136 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.849e-16  6.716e-03    0.00        1    
xval         4.337e-01  6.716e-03   64.58   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9011 on 17998 degrees of freedom
Multiple R-squared:  0.1881,    Adjusted R-squared:  0.1881 
F-statistic:  4170 on 1 and 17998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><img src="figures/fig_0901.png" width="500" /></p>
<p><strong>Example: Quadrant Analysis (T,w) during nighttime</strong></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="quadrant-analysis.html#cb20-1" aria-hidden="true"></a>i=<span class="dv">38</span> <span class="co">#select a file -- a nighttime example</span></span>
<span id="cb20-2"><a href="quadrant-analysis.html#cb20-2" aria-hidden="true"></a><span class="kw">print</span>(files[i])</span>
<span id="cb20-3"><a href="quadrant-analysis.html#cb20-3" aria-hidden="true"></a>tmp=<span class="kw">read.table</span>(files[i],<span class="dt">sep=</span><span class="st">&quot;,&quot;</span>,<span class="dt">header=</span>T)</span>
<span id="cb20-4"><a href="quadrant-analysis.html#cb20-4" aria-hidden="true"></a><span class="kw">plot_quadrant_analysis</span>(tmp<span class="op">$</span>T_degC,tmp<span class="op">$</span>w_m.s,<span class="dt">xlab=</span><span class="st">&quot;T (normalized)&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;w (normalized)&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Quadrant Analysis (T,w)&quot;</span>) <span class="co">#based on the raw data (10 Hz) directly (i.e., unrotated)</span></span></code></pre></div>
<pre><code>[1] &quot;../data/ec-data_10Hz_raw/2018-07-21T030000.csv&quot;

Call:
lm(formula = yval ~ xval)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.8334 -0.5262  0.0022  0.5425  6.2520 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.006e-17  7.120e-03    0.00        1    
xval        -2.957e-01  7.121e-03  -41.53   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9553 on 17998 degrees of freedom
Multiple R-squared:  0.08745,   Adjusted R-squared:  0.0874 
F-statistic:  1725 on 1 and 17998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><img src="figures/fig_0902.png" width="500" /></p>
<p><strong>Example: Quadrant Analysis (u,w) during nighttime</strong></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="quadrant-analysis.html#cb22-1" aria-hidden="true"></a><span class="kw">plot_quadrant_analysis</span>(tmp<span class="op">$</span>u_m.s,tmp<span class="op">$</span>w_m.s,<span class="dt">xlab=</span><span class="st">&quot;u (normalized)&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;w (normalized)&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Quadrant Analysis (u,w)&quot;</span>) <span class="co">#based on the raw data (10 Hz) directly (i.e., unrotated)</span></span></code></pre></div>
<pre><code>Call:
lm(formula = yval ~ xval)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.9799 -0.5474 -0.0342  0.5301  6.6338 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.749e-16  7.326e-03    0.00        1    
xval        -1.843e-01  7.326e-03  -25.15   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9829 on 17998 degrees of freedom
Multiple R-squared:  0.03395,   Adjusted R-squared:  0.0339 
F-statistic: 632.5 on 1 and 17998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><img src="figures/fig_0903.png" width="500" /></p>
<p>Quadrant analysis can be applied to any combination of two measured quantities and also allows to check the measurement quality or significance of the relation between them. It can also be used to check the effect of the coordinate rotation (e.g., <code>rotate_double</code>) visually. The concept can be extended to a combination of three variables in the framework of octant analysis.</p>

</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references hanging-indent">
<div id="ref-Jimenez2018">
<p>Jimenez, J. 2018. “Coherent structures in wall-bounded turbulence.” <em>J Fluid Mech</em> 842 (P1). <a href="https://doi.org/10.1017/jfm.2018.144">https://doi.org/10.1017/jfm.2018.144</a>.</p>
</div>
<div id="ref-Katul1997">
<p>Katul, G., G. Kuhn, J. Schieldge, and C.-I. Hsieh. 1997. “The ejection-sweep character of scalar fluxes in the unstable surface layer.” <em>Boundary-Layer Meteorol</em> 83: 1–26.</p>
</div>
<div id="ref-Mack2024">
<p>Mack, L., T. K. Berntsen, N. Vercauteren, and N. Pirk. 2024. “Transfer Efficiency and Organization in Turbulent Transport over Alpine Tundra.” <em>Boundary-Layer Meteorol</em> 190 (38). <a href="https://doi.org/10.1007/s10546-024-00879-5">https://doi.org/10.1007/s10546-024-00879-5</a>.</p>
</div>
<div id="ref-Shaw1983">
<p>Shaw, R. H., J. Tavanger, and D. P. Ward. 1983. “Structure of the Reynolds Stress in a Canopy Layer.” <em>J Climate Applied Meteorol</em> 22: 1922–31.</p>
</div>
<div id="ref-Wallace2016">
<p>Wallace, J. 2016. “Quadrant Analysis in Turbulence Research: History and Evolution.” <em>Annu Rev Fluid Mech</em> 48: 131–58. <a href="https://doi.org/10.1146/annurev-fluid-122414-034550">https://doi.org/10.1146/annurev-fluid-122414-034550</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="turbulence-diagnostics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spectra.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc depth": 2,
"github-repo": "noctiluc3nt/ec_analyze"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
