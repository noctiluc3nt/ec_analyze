<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Spectra | Reddy: An open-source toolbox for analyzing eddy-covariance measurements in heterogeneous environments</title>
  <meta name="description" content="5 Spectra | Reddy: An open-source toolbox for analyzing eddy-covariance measurements in heterogeneous environments" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Spectra | Reddy: An open-source toolbox for analyzing eddy-covariance measurements in heterogeneous environments" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="noctiluc3nt/Reddy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Spectra | Reddy: An open-source toolbox for analyzing eddy-covariance measurements in heterogeneous environments" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="quadrant-analysis.html"/>
<link rel="next" href="reynolds-stress-tensor.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/noctiluc3nt/Reddy" target="blank"><bf>Reddy<bf></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#measurement-setup-and-instrumentation"><i class="fa fa-check"></i><b>1.1</b> Measurement setup and instrumentation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.2</b> Data sources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html"><i class="fa fa-check"></i><b>2</b> Post-processing of raw eddy-covariance data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#eddy-covariance-method"><i class="fa fa-check"></i><b>2.1</b> Eddy-covariance method</a></li>
<li class="chapter" data-level="2.2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#raw-data-handling-and-corrections"><i class="fa fa-check"></i><b>2.2</b> Raw data handling and corrections</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#choosing-a-suitable-averaging-time"><i class="fa fa-check"></i><b>2.2.1</b> Choosing a suitable averaging time</a></li>
<li class="chapter" data-level="2.2.2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#overview-of-correction-procedures-applied-to-the-raw-data"><i class="fa fa-check"></i><b>2.2.2</b> Overview of correction procedures applied to the raw data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#an-example-post-processing-routine"><i class="fa fa-check"></i><b>2.3</b> An example post-processing routine</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html"><i class="fa fa-check"></i><b>3</b> Turbulence diagnostics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#standard-turbulence-diagnostics-and-fluxes"><i class="fa fa-check"></i><b>3.1</b> Standard turbulence diagnostics and fluxes</a></li>
<li class="chapter" data-level="3.2" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#stability-dependence"><i class="fa fa-check"></i><b>3.2</b> Stability dependence</a></li>
<li class="chapter" data-level="3.3" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#turbulence-regimes-and-hockey-stick-model"><i class="fa fa-check"></i><b>3.3</b> Turbulence regimes and “Hockey-stick” model</a></li>
<li class="chapter" data-level="3.4" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#decoupling-metric"><i class="fa fa-check"></i><b>3.4</b> Decoupling metric</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html"><i class="fa fa-check"></i><b>4</b> Quadrant analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html#calculation-of-occurrence-frequencies-and-strengths-of-the-four-quadrants-with-calc_quadrant_analysis"><i class="fa fa-check"></i><b>4.1</b> Calculation of occurrence frequencies and strengths of the four quadrants with <code>calc_quadrant_analysis</code></a></li>
<li class="chapter" data-level="4.2" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html#plotting-quadrant-analysis-with-plot_quadrant_analysis"><i class="fa fa-check"></i><b>4.2</b> Plotting quadrant analysis with <code>plot_quadrant_analysis</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spectra.html"><a href="spectra.html"><i class="fa fa-check"></i><b>5</b> Spectra</a>
<ul>
<li class="chapter" data-level="5.1" data-path="spectra.html"><a href="spectra.html#spectral-analysis-of-timeseries"><i class="fa fa-check"></i><b>5.1</b> Spectral analysis of timeseries</a></li>
<li class="chapter" data-level="5.2" data-path="spectra.html"><a href="spectra.html#frequency-spectrum-with-fft"><i class="fa fa-check"></i><b>5.2</b> Frequency spectrum with FFT</a></li>
<li class="chapter" data-level="5.3" data-path="spectra.html"><a href="spectra.html#multiresolution-decomposition-mrd"><i class="fa fa-check"></i><b>5.3</b> Multiresolution decomposition (MRD)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="spectra.html"><a href="spectra.html#calculating-multiresolution-decomposition-with-calc_mrd"><i class="fa fa-check"></i><b>5.3.1</b> Calculating multiresolution decomposition with <code>calc_mrd</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="spectra.html"><a href="spectra.html#plotting-multiresolution-decomposition-with-plot_mrd"><i class="fa fa-check"></i><b>5.3.2</b> Plotting multiresolution decomposition with <code>plot_mrd</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="spectra.html"><a href="spectra.html#ogives"><i class="fa fa-check"></i><b>5.4</b> Ogives</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html"><i class="fa fa-check"></i><b>6</b> Reynolds stress tensor</a>
<ul>
<li class="chapter" data-level="6.1" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#invariant-analysis-of-the-reynolds-stress-tensor"><i class="fa fa-check"></i><b>6.1</b> Invariant analysis of the Reynolds stress tensor</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#performing-the-invariant-analysis-of-the-reynolds-stress-tensor-with-calc_anisotropy"><i class="fa fa-check"></i><b>6.1.1</b> Performing the invariant analysis of the Reynolds stress tensor with <code>calc_anisotropy</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#plotting-the-barycentric-map-using-plot_barycentric_map"><i class="fa fa-check"></i><b>6.1.2</b> Plotting the barycentric map using <code>plot_barycentric_map</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#anisotropy-and-velocity-aspect-ratio-var"><i class="fa fa-check"></i><b>6.2</b> Anisotropy and velocity aspect ratio (VAR)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="flux-footprint.html"><a href="flux-footprint.html"><i class="fa fa-check"></i><b>7</b> Flux footprint</a>
<ul>
<li class="chapter" data-level="7.1" data-path="flux-footprint.html"><a href="flux-footprint.html#flux-footprint-parametrizations"><i class="fa fa-check"></i><b>7.1</b> Flux footprint parametrizations</a></li>
<li class="chapter" data-level="7.2" data-path="flux-footprint.html"><a href="flux-footprint.html#d-flux-footprint-estimate"><i class="fa fa-check"></i><b>7.2</b> 2D flux footprint estimate</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="flux-footprint.html"><a href="flux-footprint.html#calculate-2d-flux-footprint-estimate-with-calc_flux_footprint"><i class="fa fa-check"></i><b>7.2.1</b> Calculate 2D flux footprint estimate with <code>calc_flux_footprint</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="flux-footprint.html"><a href="flux-footprint.html#plotting-of-flux-footprint-with-plot_flux_footprint"><i class="fa fa-check"></i><b>7.2.2</b> Plotting of flux footprint with <code>plot_flux_footprint</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="flux-footprint.html"><a href="flux-footprint.html#flux-footprint-climatology"><i class="fa fa-check"></i><b>7.3</b> Flux footprint climatology</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html"><i class="fa fa-check"></i><b>8</b> Surface energy balance</a>
<ul>
<li class="chapter" data-level="8.1" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#surface-energy-balance-closure"><i class="fa fa-check"></i><b>8.1</b> Surface energy balance closure</a></li>
<li class="chapter" data-level="8.2" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#calculating-surface-energy-balance"><i class="fa fa-check"></i><b>8.2</b> Calculating surface energy balance</a></li>
<li class="chapter" data-level="8.3" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#hydrological-measures-bowen-ratio-and-evaporative-fraction"><i class="fa fa-check"></i><b>8.3</b> Hydrological measures: Bowen ratio and evaporative fraction</a></li>
<li class="chapter" data-level="8.4" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#meteorological-contextualization"><i class="fa fa-check"></i><b>8.4</b> Meteorological contextualization</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="turbulence-parameterizations.html"><a href="turbulence-parameterizations.html"><i class="fa fa-check"></i><b>9</b> Turbulence parameterizations</a>
<ul>
<li class="chapter" data-level="9.1" data-path="turbulence-parameterizations.html"><a href="turbulence-parameterizations.html#flux-variance-relations"><i class="fa fa-check"></i><b>9.1</b> Flux-variance relations</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="turbulence-parameterizations.html"><a href="turbulence-parameterizations.html#example-latent-heat-flux-from-flux-variance-relation"><i class="fa fa-check"></i><b>9.1.1</b> Example: Latent heat flux from flux-variance relation</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="turbulence-parameterizations.html"><a href="turbulence-parameterizations.html#flux-profile-relations-and-vertical-profiles-of-temperature-and-wind-speed"><i class="fa fa-check"></i><b>9.2</b> Flux-profile relations and vertical profiles of temperature and wind speed</a></li>
<li class="chapter" data-level="9.3" data-path="turbulence-parameterizations.html"><a href="turbulence-parameterizations.html#using-nwp-model-output"><i class="fa fa-check"></i><b>9.3</b> Using NWP model output</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>10</b> References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown <br>(Laura Mack, 2026)</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reddy: An open-source toolbox for analyzing eddy-covariance measurements in heterogeneous environments</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spectra" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Spectra<a href="spectra.html#spectra" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="spectral-analysis-of-timeseries" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Spectral analysis of timeseries<a href="spectra.html#spectral-analysis-of-timeseries" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Turbulence is associated with different scales, which interact in a complex manner and to investigate them spectra can be examined. Thereby, the measurements are transformed from time to frequency domain. The most common approach is to represent the timeseries with a series of sine and cosine function (with different frequencies), which is referred to as Fourier analysis. A numerical optimized way to calculate the Fourier transformation is to use Fast Fourier Transform (FFT, in rbase: <code>fft</code>). However, periodicity is not always a suitable assumption, such that other basis functions and approaches might be more applicable. With a wavelet transform information in time and frequency domain is retained and different wavelet basis functions (e.g., Morlet wavelets or Haar-wavelets) allow to represent localized and non-periodic behaviour (<code>WaveletComp::wt.image</code>). A very practical discrete wavelet transform is multiresolution decomposition (MRD, <span class="citation">Vickers and Mahrt (<a href="#ref-Vickers2003" role="doc-biblioref">2003</a>)</span>, <code>Reddy::calc_mrd</code>), which is routinley applied in the analysis of eddy-covariance data (see details below). <br>
A related method used for flux calculations from eddy-covariance data is based on Ogives (<code>Reddy::calc_ogive</code>), that is a cumulative frequency distribution, i.e. the sum of the cospectral energy. <span class="citation">Sievers et al. (<a href="#ref-Sievers2015" role="doc-biblioref">2015</a>)</span> developed an Ogive optimization, which allows to disentangle low frequency contributions on flux estimates. This approach is particular relevant under low-flux conditions, e.g. with changing signs in one averaging interval. The low frequency contributions are generally associated with non-local features, e.g. topography, while high-frequency contributions are local.</p>
<p><strong>Quick overview:</strong> <br>
- Fast Fourier Transform FFT (rbase: <code>fft</code>, <code>spectrum</code>)
- Wavelets (<code>WaveletComp::wt.image</code>)
- Multiresolution decomposition MRD (<code>Reddy::calc_mrd</code>)
- Ogives (<code>Reddy::calc_ogive</code>)</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="spectra.html#cb24-1" aria-hidden="true"></a><span class="co">#loading Reddy package</span></span>
<span id="cb24-2"><a href="spectra.html#cb24-2" aria-hidden="true"></a><span class="co">#install.packages(&quot;../src/Reddy_0.0.0.9000.tar.gz&quot;,repos=NULL,source=TRUE,quiet=TRUE)</span></span>
<span id="cb24-3"><a href="spectra.html#cb24-3" aria-hidden="true"></a><span class="kw">library</span>(Reddy)</span>
<span id="cb24-4"><a href="spectra.html#cb24-4" aria-hidden="true"></a></span>
<span id="cb24-5"><a href="spectra.html#cb24-5" aria-hidden="true"></a><span class="co">#ec data files</span></span>
<span id="cb24-6"><a href="spectra.html#cb24-6" aria-hidden="true"></a>dir_in=<span class="st">&quot;../data/ec-data_10Hz_raw&quot;</span></span>
<span id="cb24-7"><a href="spectra.html#cb24-7" aria-hidden="true"></a>files=<span class="kw">list.files</span>(dir_in,<span class="dt">full.names=</span><span class="ot">TRUE</span>)</span>
<span id="cb24-8"><a href="spectra.html#cb24-8" aria-hidden="true"></a>nf=<span class="kw">length</span>(files)</span>
<span id="cb24-9"><a href="spectra.html#cb24-9" aria-hidden="true"></a></span>
<span id="cb24-10"><a href="spectra.html#cb24-10" aria-hidden="true"></a>i=<span class="dv">8</span> <span class="co">#select a file</span></span>
<span id="cb24-11"><a href="spectra.html#cb24-11" aria-hidden="true"></a>tmp=<span class="kw">read.table</span>(files[i],<span class="dt">sep=</span><span class="st">&quot;,&quot;</span>,<span class="dt">header=</span>T)</span></code></pre></div>
</div>
<div id="frequency-spectrum-with-fft" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Frequency spectrum with FFT<a href="spectra.html#frequency-spectrum-with-fft" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The rbase function <code>spectrum</code> calculates the spectrum based on FFT and plots by default an associated periodigram.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="spectra.html#cb25-1" aria-hidden="true"></a><span class="kw">spectrum</span>(tmp<span class="op">$</span>u_m.s)</span></code></pre></div>
<p><img src="../figures/spectra/output_3_0.png" width="400" /></p>
<p>However, to systematically investigate spectral density and reduce the noise, it is recommended to apply binning (i.e., averaging over frequency intervals), which can be done with the function <code>Reddy::calc_spectrum1D</code> (using <code>rbase::fft()</code>). The resulting averaged spectra can then be compared to theoretical slopes. In homogeneous and isotropic turbulence a spectral slope of -5/3 follows from theoretical considerations (Kolmogorovs energy cascade), which is usually used as visual comparison. Deviations from this -5/3-slope indicate that either more energy (steeper slope) or less energy (weaker slope) is dissipated, which can have various reasons, e.g. turbulence anisotropy or energy injections.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="spectra.html#cb26-1" aria-hidden="true"></a>spectrum_u =<span class="st"> </span><span class="kw">calc_spectrum1D</span>(tmp<span class="op">$</span>u_m.s)</span></code></pre></div>
<pre><code>Warning message in xy.coords(x, y, xlabel, ylabel, log):
“1 x value &lt;= 0 omitted from logarithmic plot”</code></pre>
<p><img src="../figures/spectra/output_5_1.png" width="400" /></p>
</div>
<div id="multiresolution-decomposition-mrd" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Multiresolution decomposition (MRD)<a href="spectra.html#multiresolution-decomposition-mrd" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Multiresolution decomposition (MRD) is a method to characterize the timescale dependence of variances (spectrum) or covariances (cospectrum) and to find scale gaps between turbulent and submeso-scale motions. It uses Haar wavelets, which have the advantage over Fourier analysis that no periodicity is assumed. For this, the time series is step-by-step cut in half, as visualized in the figure.</p>
<p><img src="../figures/schema/mrd_schema.png" width=600 /></p>
<div id="calculating-multiresolution-decomposition-with-calc_mrd" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Calculating multiresolution decomposition with <code>calc_mrd</code><a href="spectra.html#calculating-multiresolution-decomposition-with-calc_mrd" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="spectra.html#cb28-1" aria-hidden="true"></a><span class="co">#cospectra</span></span>
<span id="cb28-2"><a href="spectra.html#cb28-2" aria-hidden="true"></a>mrd_uw=<span class="kw">calc_mrd</span>(tmp<span class="op">$</span>u_m.s,tmp<span class="op">$</span>w_m.s,<span class="dt">time_res=</span><span class="fl">0.1</span>) <span class="co">#momentum flux</span></span>
<span id="cb28-3"><a href="spectra.html#cb28-3" aria-hidden="true"></a>mrd_Tw=<span class="kw">calc_mrd</span>(tmp<span class="op">$</span>T_degC,tmp<span class="op">$</span>w_m.s,<span class="dt">time_res=</span><span class="fl">0.1</span>) <span class="co">#sensible heat flux</span></span>
<span id="cb28-4"><a href="spectra.html#cb28-4" aria-hidden="true"></a></span>
<span id="cb28-5"><a href="spectra.html#cb28-5" aria-hidden="true"></a><span class="co">#spectra</span></span>
<span id="cb28-6"><a href="spectra.html#cb28-6" aria-hidden="true"></a>mrd_ww=<span class="kw">calc_mrd</span>(tmp<span class="op">$</span>w_m.s,tmp<span class="op">$</span>w_m.s,<span class="dt">time_res=</span><span class="fl">0.1</span>) <span class="co">#vertical veloctiy</span></span>
<span id="cb28-7"><a href="spectra.html#cb28-7" aria-hidden="true"></a>mrd_TT=<span class="kw">calc_mrd</span>(tmp<span class="op">$</span>T_degC,tmp<span class="op">$</span>T_degC,<span class="dt">time_res=</span><span class="fl">0.1</span>) <span class="co">#temperature</span></span></code></pre></div>
<pre><code>[1] &quot;suggested averaging time (i.e. first zero-crossing): 1.62 min&quot;</code></pre>
<p><img src="../figures/spectra/output_7_1.png" width="400" /></p>
<pre><code>[1] &quot;No zero-crossing of the MRD (co)spectrum was detected.&quot;</code></pre>
<p><img src="../figures/spectra/output_7_3.png" width="400" /></p>
<pre><code>[1] &quot;No zero-crossing of the MRD (co)spectrum was detected.&quot;</code></pre>
<p><img src="../figures/spectra/output_7_5.png" width="400" /></p>
<pre><code>[1] &quot;No zero-crossing of the MRD (co)spectrum was detected.&quot;</code></pre>
<p><img src="../figures/spectra/output_7_7.png" width="400" /></p>
<p>The function returns a dataframe containing index, exponent <span class="math inline">\(m\)</span>, scale (i.e. <span class="math inline">\(2^{m}\)</span>), time [s], mean, median, 25% and 75% quartiles as columns. The number of rows is given by <span class="math inline">\(M\)</span> fulfilling $2^M $ #measurements.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="spectra.html#cb33-1" aria-hidden="true"></a><span class="co">#look into output</span></span>
<span id="cb33-2"><a href="spectra.html#cb33-2" aria-hidden="true"></a>mrd_uw</span></code></pre></div>
<table class="dataframe">
<caption>
A data.frame: 15 × 8
</caption>
<thead>
<tr>
<th scope="col">
index
</th>
<th scope="col">
m
</th>
<th scope="col">
scale
</th>
<th scope="col">
time
</th>
<th scope="col">
mean
</th>
<th scope="col">
median
</th>
<th scope="col">
q25
</th>
<th scope="col">
q75
</th>
</tr>
<tr>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
14
</td>
<td>
16384
</td>
<td>
1638.4
</td>
<td>
-8.838739e-34
</td>
<td>
-8.838739e-34
</td>
<td>
-8.838739e-34
</td>
<td>
-8.838739e-34
</td>
</tr>
<tr>
<td>
2
</td>
<td>
13
</td>
<td>
8192
</td>
<td>
819.2
</td>
<td>
-4.079521e-03
</td>
<td>
-4.079521e-03
</td>
<td>
-4.079521e-03
</td>
<td>
-4.079521e-03
</td>
</tr>
<tr>
<td>
3
</td>
<td>
12
</td>
<td>
4096
</td>
<td>
409.6
</td>
<td>
-6.626465e-03
</td>
<td>
-6.626465e-03
</td>
<td>
-7.390707e-03
</td>
<td>
-5.862222e-03
</td>
</tr>
<tr>
<td>
4
</td>
<td>
11
</td>
<td>
2048
</td>
<td>
204.8
</td>
<td>
-3.430667e-03
</td>
<td>
-4.011748e-03
</td>
<td>
-6.571402e-03
</td>
<td>
-8.710123e-04
</td>
</tr>
<tr>
<td>
5
</td>
<td>
10
</td>
<td>
1024
</td>
<td>
102.4
</td>
<td>
4.209757e-03
</td>
<td>
-5.068024e-04
</td>
<td>
-4.568223e-03
</td>
<td>
7.532330e-03
</td>
</tr>
<tr>
<td>
6
</td>
<td>
9
</td>
<td>
512
</td>
<td>
51.2
</td>
<td>
6.077250e-03
</td>
<td>
4.486199e-03
</td>
<td>
-2.698569e-03
</td>
<td>
9.425087e-03
</td>
</tr>
<tr>
<td>
7
</td>
<td>
8
</td>
<td>
256
</td>
<td>
25.6
</td>
<td>
9.264997e-03
</td>
<td>
5.478194e-04
</td>
<td>
-8.774036e-03
</td>
<td>
9.014596e-03
</td>
</tr>
<tr>
<td>
8
</td>
<td>
7
</td>
<td>
128
</td>
<td>
12.8
</td>
<td>
1.157982e-02
</td>
<td>
3.560662e-03
</td>
<td>
-6.819690e-03
</td>
<td>
1.801111e-02
</td>
</tr>
<tr>
<td>
9
</td>
<td>
6
</td>
<td>
64
</td>
<td>
6.4
</td>
<td>
1.465273e-02
</td>
<td>
3.577008e-03
</td>
<td>
-3.271827e-03
</td>
<td>
2.213298e-02
</td>
</tr>
<tr>
<td>
10
</td>
<td>
5
</td>
<td>
32
</td>
<td>
3.2
</td>
<td>
1.090534e-02
</td>
<td>
2.818075e-03
</td>
<td>
-4.432612e-03
</td>
<td>
1.858083e-02
</td>
</tr>
<tr>
<td>
11
</td>
<td>
4
</td>
<td>
16
</td>
<td>
1.6
</td>
<td>
9.752098e-03
</td>
<td>
1.325413e-03
</td>
<td>
-6.967310e-03
</td>
<td>
1.938746e-02
</td>
</tr>
<tr>
<td>
12
</td>
<td>
3
</td>
<td>
8
</td>
<td>
0.8
</td>
<td>
5.831290e-03
</td>
<td>
6.054180e-04
</td>
<td>
-9.164119e-03
</td>
<td>
1.592909e-02
</td>
</tr>
<tr>
<td>
13
</td>
<td>
2
</td>
<td>
4
</td>
<td>
0.4
</td>
<td>
5.007376e-03
</td>
<td>
6.024576e-04
</td>
<td>
-9.401348e-03
</td>
<td>
1.487008e-02
</td>
</tr>
<tr>
<td>
14
</td>
<td>
1
</td>
<td>
2
</td>
<td>
0.2
</td>
<td>
3.723193e-03
</td>
<td>
3.046532e-04
</td>
<td>
-7.508746e-03
</td>
<td>
1.040180e-02
</td>
</tr>
<tr>
<td>
15
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.1
</td>
<td>
2.009888e-03
</td>
<td>
6.411861e-05
</td>
<td>
-5.739598e-03
</td>
<td>
7.411443e-03
</td>
</tr>
</tbody>
</table>
</div>
<div id="plotting-multiresolution-decomposition-with-plot_mrd" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Plotting multiresolution decomposition with <code>plot_mrd</code><a href="spectra.html#plotting-multiresolution-decomposition-with-plot_mrd" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>plot_mrd</code> takes an object returned by <code>calc_mrd</code> and plots mean, median and quartiles versus time.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="spectra.html#cb34-1" aria-hidden="true"></a><span class="kw">plot_mrd</span>(mrd_uw, <span class="dt">main=</span><span class="st">&quot;Cospectrum (u,w)&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;suggested averaging time (i.e. first zero-crossing): 1.62 min&quot;</code></pre>
<p><img src="../figures/spectra/output_12_1.png" width="400" /></p>
<p><strong>suggested averaging time:</strong> <span class="citation">Vickers and Mahrt (<a href="#ref-Vickers2003" role="doc-biblioref">2003</a>)</span> developed a simple objective algorithm for suggesting an averaging time based on the MRD (co)spectrum. By starting from the smallest averaging time and going to larger averaging times, a (local) maximum in the turbulent fluxes is detected and the thereafter following first zero-crossing is regarded as suitable averaging time. In <code>plot_mrd</code> the option <code>suggest_avgtime</code> returns and plots it (orange line).</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="spectra.html#cb36-1" aria-hidden="true"></a><span class="co">#plot_mrd(mrd_Tw, main=&quot;Cospectrum (T,w)&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="spectra.html#cb37-1" aria-hidden="true"></a><span class="co">#plot_mrd(mrd_ww, main=&quot;Spectrum (w,w)&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="spectra.html#cb38-1" aria-hidden="true"></a><span class="kw">plot_mrd</span>(mrd_TT, <span class="dt">main=</span><span class="st">&quot;Spectrum (T,T)&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;No zero-crossing of the MRD (co)spectrum was detected.&quot;</code></pre>
<p><img src="../figures/spectra/output_16_1.png" width="400" /></p>
<p>Composite MRDs can be created by averaging over several MRDs (also possible to distinguish different flow regimes, e.g., based on the stability parameter <code>calc_zeta</code>) and can be used to find long-term characteristic (e.g., scale gaps). Scale(s) gap(s) are defined as the the zero-crossings of the spectrum or cospectrum (larger than the first zero-crossing at the measurement frequency itself).</p>
</div>
</div>
<div id="ogives" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Ogives<a href="spectra.html#ogives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ogives are cumulative distribution functions (calculated by integrating the spectrum). While they do not contain more information than the spectrum, the integration makes them appear smoother, which allows to estimate fluxes (and suitable averaging times) by a numerical optimization method (<span class="citation">Sievers et al. (<a href="#ref-Sievers2015" role="doc-biblioref">2015</a>)</span>). In Reddy, ogives are calculated by integrating a MRD:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="spectra.html#cb40-1" aria-hidden="true"></a>ogive_uw=<span class="kw">calc_ogive</span>(mrd_uw) <span class="co">#from previously calculated MRD for momentum flux</span></span></code></pre></div>
<p><img src="../figures/spectra/output_19_0.png" width="400" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="spectra.html#cb41-1" aria-hidden="true"></a>ogive_TT=<span class="kw">calc_ogive</span>(mrd_TT) <span class="co">#from previously calculated MRD for temperature fluctuation</span></span></code></pre></div>
<p><img src="../figures/spectra/output_20_0.png" width="400" /></p>

</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references hanging-indent">
<div id="ref-Sievers2015">
<p>Sievers, J., T. Papakyriakou, S. E. Larsen, M. M. Jammet, S. Rysgaard, M. K. Sejr, and L. L. Sørensen. 2015. “Estimating surface fluxes using eddy covariance and numerical ogive optimization.” <em>Atmos Chem Phys</em> 15: 2081–2103. <a href="https://doi.org/10.5194/acp-15-2081-2015">https://doi.org/10.5194/acp-15-2081-2015</a>.</p>
</div>
<div id="ref-Vickers2003">
<p>Vickers, D., and L. Mahrt. 2003. “The Cospectral Gap and Turbulent Flux Calculations.” <em>J Atmos Ocean Technol</em> 20: 660–72. <a href="https://doi.org/10.1175/1520-0426(2003)20%3C660:TCGATF%3E2.0.CO;2">https://doi.org/10.1175/1520-0426(2003)20&lt;660:TCGATF&gt;2.0.CO;2</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="quadrant-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reynolds-stress-tensor.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": null,
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  },
  "toc depth": 2,
  "github-repo": "noctiluc3nt/ec_analyze"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
