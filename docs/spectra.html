<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Spectra | Reddy: An open-source package for analyzing eddy-covariance data</title>
  <meta name="description" content="5 Spectra | Reddy: An open-source package for analyzing eddy-covariance data" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Spectra | Reddy: An open-source package for analyzing eddy-covariance data" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="noctiluc3nt/Reddy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Spectra | Reddy: An open-source package for analyzing eddy-covariance data" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="quadrant-analysis.html"/>
<link rel="next" href="reynolds-stress-tensor.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/noctiluc3nt/Reddy" target="blank"><bf>Reddy<bf></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#measurement-setup-and-instrumentation"><i class="fa fa-check"></i><b>1.1</b> Measurement setup and instrumentation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.2</b> Data sources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html"><i class="fa fa-check"></i><b>2</b> Post-processing of raw eddy-covariance data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#eddy-covariance-method"><i class="fa fa-check"></i><b>2.1</b> Eddy-covariance method</a></li>
<li class="chapter" data-level="2.2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#raw-data-handling-and-corrections"><i class="fa fa-check"></i><b>2.2</b> Raw data handling and corrections</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#choosing-a-suitable-averaging-time"><i class="fa fa-check"></i><b>2.2.1</b> Choosing a suitable averaging time</a></li>
<li class="chapter" data-level="2.2.2" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#overview-of-correction-procedures-applied-to-the-raw-data"><i class="fa fa-check"></i><b>2.2.2</b> Overview of correction procedures applied to the raw data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="post-processing-of-raw-eddy-covariance-data.html"><a href="post-processing-of-raw-eddy-covariance-data.html#an-example-post-processing-routine"><i class="fa fa-check"></i><b>2.3</b> An example post-processing routine</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html"><i class="fa fa-check"></i><b>3</b> Turbulence diagnostics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#standard-turbulence-diagnostics-and-simple-timeseries-plots"><i class="fa fa-check"></i><b>3.1</b> Standard turbulence diagnostics and simple timeseries plots</a></li>
<li class="chapter" data-level="3.2" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#stability-dependence"><i class="fa fa-check"></i><b>3.2</b> Stability dependence</a></li>
<li class="chapter" data-level="3.3" data-path="turbulence-diagnostics.html"><a href="turbulence-diagnostics.html#turbulence-regimes"><i class="fa fa-check"></i><b>3.3</b> Turbulence regimes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html"><i class="fa fa-check"></i><b>4</b> Quadrant analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html#calculation-of-occurrence-frequencies-and-strengths-of-the-four-quadrants-with-calc_quadrant_analysis"><i class="fa fa-check"></i><b>4.1</b> Calculation of occurrence frequencies and strengths of the four quadrants with <code>calc_quadrant_analysis</code></a></li>
<li class="chapter" data-level="4.2" data-path="quadrant-analysis.html"><a href="quadrant-analysis.html#plotting-quadrant-analysis-with-plot_quadrant_analysis"><i class="fa fa-check"></i><b>4.2</b> Plotting quadrant analysis with <code>plot_quadrant_analysis</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spectra.html"><a href="spectra.html"><i class="fa fa-check"></i><b>5</b> Spectra</a>
<ul>
<li class="chapter" data-level="5.1" data-path="spectra.html"><a href="spectra.html#spectral-analysis-of-timeseries"><i class="fa fa-check"></i><b>5.1</b> Spectral analysis of timeseries</a></li>
<li class="chapter" data-level="5.2" data-path="spectra.html"><a href="spectra.html#fft-spectrum-and-comparison-to-theoretical-spectra"><i class="fa fa-check"></i><b>5.2</b> FFT spectrum and comparison to theoretical spectra</a></li>
<li class="chapter" data-level="5.3" data-path="spectra.html"><a href="spectra.html#multiresolution-decomposition-mrd"><i class="fa fa-check"></i><b>5.3</b> Multiresolution decomposition (MRD)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="spectra.html"><a href="spectra.html#calculating-multiresolution-decomposition-with-calc_mrd"><i class="fa fa-check"></i><b>5.3.1</b> Calculating multiresolution decomposition with <code>calc_mrd</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="spectra.html"><a href="spectra.html#plotting-multiresolution-decomposition-with-plot_mrd"><i class="fa fa-check"></i><b>5.3.2</b> Plotting multiresolution decomposition with <code>plot_mrd</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html"><i class="fa fa-check"></i><b>6</b> Reynolds stress tensor</a>
<ul>
<li class="chapter" data-level="6.1" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#invariant-analysis-of-the-reynolds-stress-tensor"><i class="fa fa-check"></i><b>6.1</b> Invariant analysis of the Reynolds stress tensor</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#performing-the-invariant-analysis-of-the-reynolds-stress-tensor-with-calc_anisotropy"><i class="fa fa-check"></i><b>6.1.1</b> Performing the invariant analysis of the Reynolds stress tensor with <code>calc_anisotropy</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#plotting-the-barycentric-map-using-plot_barycentric_map"><i class="fa fa-check"></i><b>6.1.2</b> Plotting the barycentric map using <code>plot_barycentric_map</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="reynolds-stress-tensor.html"><a href="reynolds-stress-tensor.html#anisotropy-and-velocity-aspect-ratio-var"><i class="fa fa-check"></i><b>6.2</b> Anisotropy and velocity aspect ratio (VAR)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="flux-footprint.html"><a href="flux-footprint.html"><i class="fa fa-check"></i><b>7</b> Flux footprint</a>
<ul>
<li class="chapter" data-level="7.1" data-path="flux-footprint.html"><a href="flux-footprint.html#flux-footprint-parametrizations"><i class="fa fa-check"></i><b>7.1</b> Flux footprint parametrizations</a></li>
<li class="chapter" data-level="7.2" data-path="flux-footprint.html"><a href="flux-footprint.html#d-flux-footprint-estimate"><i class="fa fa-check"></i><b>7.2</b> 2D flux footprint estimate</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="flux-footprint.html"><a href="flux-footprint.html#calculate-2d-flux-footprint-estimate-with-calc_flux_footprint"><i class="fa fa-check"></i><b>7.2.1</b> Calculate 2D flux footprint estimate with <code>calc_flux_footprint</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="flux-footprint.html"><a href="flux-footprint.html#plotting-of-flux-footprint-with-plot_flux_footprint"><i class="fa fa-check"></i><b>7.2.2</b> Plotting of flux footprint with <code>plot_flux_footprint</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html"><i class="fa fa-check"></i><b>8</b> Surface energy balance</a>
<ul>
<li class="chapter" data-level="8.1" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#surface-energy-balance-closure"><i class="fa fa-check"></i><b>8.1</b> Surface energy balance closure</a></li>
<li class="chapter" data-level="8.2" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#calculating-surface-energy-balance"><i class="fa fa-check"></i><b>8.2</b> Calculating surface energy balance</a></li>
<li class="chapter" data-level="8.3" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#bowen-ratio-and-evaporative-fraction"><i class="fa fa-check"></i><b>8.3</b> Bowen ratio and evaporative fraction</a></li>
<li class="chapter" data-level="8.4" data-path="surface-energy-balance.html"><a href="surface-energy-balance.html#clear-sky-index-csi-for-contextualization-calc_csi"><i class="fa fa-check"></i><b>8.4</b> Clear-Sky-Index (CSI) for contextualization (<code>calc_csi</code>)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reddy: An open-source package for analyzing eddy-covariance data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spectra" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Spectra<a href="spectra.html#spectra" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="spectral-analysis-of-timeseries" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Spectral analysis of timeseries<a href="spectra.html#spectral-analysis-of-timeseries" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Turbulence is associated with different scales, which interact in a complex manner and to investigate them spectra can be examined. Thereby, the measurements are transformed from time to frequency domain. The most common approach is to represent the timeseries with a series of sine and cosine function (with different frequencies), which is referred to as Fourier analysis. A numerical optimized way to calculate the Fourier transformation is to use Fast Fourier Transform (FFT, in rbase: <code>fft</code>). However, periodicity is not always a suitable assumption, such that other basis functions and approaches might be more applicable. With a wavelet transform information in time and frequency domain is retained and different wavelet basis functions (e.g., Morlet wavelets or Haar-wavelets) allow to represent localized and not periodic behaviour (<code>WaveletComp::wt.image</code>). A very practical discrete wavelet transform is multiresolution decomposition (MRD, <span class="citation">Vickers and Mahrt (<a href="#ref-Vickers2003" role="doc-biblioref">2003</a>)</span>, <code>Reddy:calc_mrd</code>), which is routinley applied in the analysis of eddy-covariance data (see details below). <br>
A related method used for flux calculations from eddy-covariance data is based on Ogives, that is a cumulative frequency distribution, i.e. the sum of the cospectral energy. <span class="citation">Sievers et al. (<a href="#ref-Sievers2015" role="doc-biblioref">2015</a>)</span> developed an Ogive optimization, which allows to disentangle low frequency contributions on flux estimates. This approach is particular relevant under low-flux conditions, e.g. with changing signs in one averaging interval. The low frequency contributions are generally associated with non-local features, e.g. topography, while high-frequency contributions are local.</p>
<p><strong>Quick overview:</strong></p>
<ul>
<li>Fast Fourier Transform FFT (rbase: <code>fft</code>, <code>spectrum</code>)</li>
<li>Wavelets (<code>WaveletComp::wt.image</code>)</li>
<li>Multiresolution decomposition MRD (<code>Reddy::calc_mrd</code>)</li>
<li>Ogives (<code>agricolae::ogive.freq</code>)</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="spectra.html#cb24-1" aria-hidden="true"></a><span class="co">#loading Reddy package</span></span>
<span id="cb24-2"><a href="spectra.html#cb24-2" aria-hidden="true"></a><span class="kw">install.packages</span>(<span class="st">&quot;../src/Reddy_0.0.0.9000.tar.gz&quot;</span>,<span class="dt">repos=</span><span class="ot">NULL</span>,<span class="dt">source=</span><span class="ot">TRUE</span>,<span class="dt">quiet=</span><span class="ot">TRUE</span>)</span>
<span id="cb24-3"><a href="spectra.html#cb24-3" aria-hidden="true"></a><span class="kw">library</span>(Reddy)</span>
<span id="cb24-4"><a href="spectra.html#cb24-4" aria-hidden="true"></a></span>
<span id="cb24-5"><a href="spectra.html#cb24-5" aria-hidden="true"></a><span class="co">#ec data files</span></span>
<span id="cb24-6"><a href="spectra.html#cb24-6" aria-hidden="true"></a>dir_in=<span class="st">&quot;../data/ec-data_10Hz_raw&quot;</span></span>
<span id="cb24-7"><a href="spectra.html#cb24-7" aria-hidden="true"></a>files=<span class="kw">list.files</span>(dir_in,<span class="dt">full.names=</span><span class="ot">TRUE</span>)</span>
<span id="cb24-8"><a href="spectra.html#cb24-8" aria-hidden="true"></a>nf=<span class="kw">length</span>(files)</span>
<span id="cb24-9"><a href="spectra.html#cb24-9" aria-hidden="true"></a></span>
<span id="cb24-10"><a href="spectra.html#cb24-10" aria-hidden="true"></a>i=<span class="dv">8</span> <span class="co">#select a file</span></span>
<span id="cb24-11"><a href="spectra.html#cb24-11" aria-hidden="true"></a>tmp=<span class="kw">read.table</span>(files[i],<span class="dt">sep=</span><span class="st">&quot;,&quot;</span>,<span class="dt">header=</span>T)</span></code></pre></div>
</div>
<div id="fft-spectrum-and-comparison-to-theoretical-spectra" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> FFT spectrum and comparison to theoretical spectra<a href="spectra.html#fft-spectrum-and-comparison-to-theoretical-spectra" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The rbase function <code>spectrum</code> calculates the spectrum based on FFT and plots by default an associated periodigram.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="spectra.html#cb25-1" aria-hidden="true"></a><span class="kw">spectrum</span>(tmp<span class="op">$</span>u_m.s)</span></code></pre></div>
<p><img src="figures/fig_0501.png" width="400" /></p>
<p>However, to systematically investigate spectral density and reduce the noise, it is recommended to apply binning (i.e., averaging over frequency intervals), which can be done with the function <code>Reddy::calc_spectrum</code> (as wrapper of <code>spectrum</code>). The resulting averaged spectra can then be compared to theoretical slopes. In homogeneous and isotropic turbulence a spectral slope of -5/3 follows from theoretical considerations (Kolmogorovs energy cascade), which is usually used as visual comparison. Deviations from this -5/3-slope indicate that either more energy (steeper slope) or less energy (weaker slope) is dissipated, which can have various reasons, e.g. turbulence anisotropy or energy injections.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="spectra.html#cb26-1" aria-hidden="true"></a>spectrum_u =<span class="st"> </span><span class="kw">calc_spectrum</span>(tmp<span class="op">$</span>u_m.s)</span></code></pre></div>
<pre><code>Call:
lm(formula = log(sbin[, 2]) ~ bins[2:nbins])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.20343 -0.08638  0.00209  0.21610  1.08777 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    -3.9486     0.2669  -14.79 2.23e-16 ***
bins[2:nbins]  -2.7810     0.1064  -26.15  &lt; 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.6212 on 34 degrees of freedom
  (63 observations deleted due to missingness)
Multiple R-squared:  0.9526,    Adjusted R-squared:  0.9512 
F-statistic: 683.6 on 1 and 34 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><img src="figures/fig_0502.png" width="400" /></p>
</div>
<div id="multiresolution-decomposition-mrd" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Multiresolution decomposition (MRD)<a href="spectra.html#multiresolution-decomposition-mrd" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Multiresolution decomposition (MRD) is a method to characterize the timescale dependence of variances (spectrum) or covariances (cospectrum) and to find scale gaps between turbulent and submeso-scale motions. It uses Haar wavelets, which have the advantage over Fourier analysis that no periodicity is assumed.</p>
<p><img src="../figures/schema/mrd_schema.png" width=600 /></p>
<div id="calculating-multiresolution-decomposition-with-calc_mrd" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Calculating multiresolution decomposition with <code>calc_mrd</code><a href="spectra.html#calculating-multiresolution-decomposition-with-calc_mrd" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="spectra.html#cb28-1" aria-hidden="true"></a><span class="co">#cospectra</span></span>
<span id="cb28-2"><a href="spectra.html#cb28-2" aria-hidden="true"></a>mrd_uw=<span class="kw">calc_mrd</span>(tmp<span class="op">$</span>u_m.s,tmp<span class="op">$</span>w_m.s,<span class="dt">time_res=</span><span class="fl">0.1</span>) <span class="co">#momentum flux</span></span>
<span id="cb28-3"><a href="spectra.html#cb28-3" aria-hidden="true"></a>mrd_Tw=<span class="kw">calc_mrd</span>(tmp<span class="op">$</span>T_degC,tmp<span class="op">$</span>w_m.s,<span class="dt">time_res=</span><span class="fl">0.1</span>) <span class="co">#sensible heat flux</span></span>
<span id="cb28-4"><a href="spectra.html#cb28-4" aria-hidden="true"></a></span>
<span id="cb28-5"><a href="spectra.html#cb28-5" aria-hidden="true"></a><span class="co">#spectra</span></span>
<span id="cb28-6"><a href="spectra.html#cb28-6" aria-hidden="true"></a>mrd_ww=<span class="kw">calc_mrd</span>(tmp<span class="op">$</span>w_m.s,tmp<span class="op">$</span>w_m.s,<span class="dt">time_res=</span><span class="fl">0.1</span>) <span class="co">#vertical veloctiy</span></span>
<span id="cb28-7"><a href="spectra.html#cb28-7" aria-hidden="true"></a>mrd_TT=<span class="kw">calc_mrd</span>(tmp<span class="op">$</span>T_degC,tmp<span class="op">$</span>T_degC,<span class="dt">time_res=</span><span class="fl">0.1</span>) <span class="co">#temperature</span></span></code></pre></div>
<p>The function returns a dataframe containing index, exponent <span class="math inline">\(m\)</span>, scale (i.e. <span class="math inline">\(2^{m}\)</span>), time [s], mean, median, 25% and 75% quartiles as columns. The number of rows is given by <span class="math inline">\(M\)</span> fulfilling $2^M $ #measurements.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="spectra.html#cb29-1" aria-hidden="true"></a><span class="co">#look into output</span></span>
<span id="cb29-2"><a href="spectra.html#cb29-2" aria-hidden="true"></a>mrd_uw</span></code></pre></div>
<table class="dataframe">
<caption>
A data.frame: 15 × 8
</caption>
<thead>
<tr>
<th scope="col">
index
</th>
<th scope="col">
m
</th>
<th scope="col">
scale
</th>
<th scope="col">
time
</th>
<th scope="col">
mean
</th>
<th scope="col">
median
</th>
<th scope="col">
q25
</th>
<th scope="col">
q75
</th>
</tr>
<tr>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
14
</td>
<td>
16384
</td>
<td>
1638.4
</td>
<td>
2.009888e-03
</td>
<td>
6.411861e-05
</td>
<td>
-5.739598e-03
</td>
<td>
7.411443e-03
</td>
</tr>
<tr>
<td>
2
</td>
<td>
13
</td>
<td>
8192
</td>
<td>
819.2
</td>
<td>
3.723193e-03
</td>
<td>
3.046532e-04
</td>
<td>
-7.508746e-03
</td>
<td>
1.040180e-02
</td>
</tr>
<tr>
<td>
3
</td>
<td>
12
</td>
<td>
4096
</td>
<td>
409.6
</td>
<td>
5.007376e-03
</td>
<td>
6.024576e-04
</td>
<td>
-9.401348e-03
</td>
<td>
1.487008e-02
</td>
</tr>
<tr>
<td>
4
</td>
<td>
11
</td>
<td>
2048
</td>
<td>
204.8
</td>
<td>
5.831290e-03
</td>
<td>
6.054180e-04
</td>
<td>
-9.164119e-03
</td>
<td>
1.592909e-02
</td>
</tr>
<tr>
<td>
5
</td>
<td>
10
</td>
<td>
1024
</td>
<td>
102.4
</td>
<td>
9.752098e-03
</td>
<td>
1.325413e-03
</td>
<td>
-6.967310e-03
</td>
<td>
1.938746e-02
</td>
</tr>
<tr>
<td>
6
</td>
<td>
9
</td>
<td>
512
</td>
<td>
51.2
</td>
<td>
1.090534e-02
</td>
<td>
2.818075e-03
</td>
<td>
-4.432612e-03
</td>
<td>
1.858083e-02
</td>
</tr>
<tr>
<td>
7
</td>
<td>
8
</td>
<td>
256
</td>
<td>
25.6
</td>
<td>
1.465273e-02
</td>
<td>
3.577008e-03
</td>
<td>
-3.271827e-03
</td>
<td>
2.213298e-02
</td>
</tr>
<tr>
<td>
8
</td>
<td>
7
</td>
<td>
128
</td>
<td>
12.8
</td>
<td>
1.157982e-02
</td>
<td>
3.560662e-03
</td>
<td>
-6.819690e-03
</td>
<td>
1.801111e-02
</td>
</tr>
<tr>
<td>
9
</td>
<td>
6
</td>
<td>
64
</td>
<td>
6.4
</td>
<td>
9.264997e-03
</td>
<td>
5.478194e-04
</td>
<td>
-8.774036e-03
</td>
<td>
9.014596e-03
</td>
</tr>
<tr>
<td>
10
</td>
<td>
5
</td>
<td>
32
</td>
<td>
3.2
</td>
<td>
6.077250e-03
</td>
<td>
4.486199e-03
</td>
<td>
-2.698569e-03
</td>
<td>
9.425087e-03
</td>
</tr>
<tr>
<td>
11
</td>
<td>
4
</td>
<td>
16
</td>
<td>
1.6
</td>
<td>
4.209757e-03
</td>
<td>
-5.068024e-04
</td>
<td>
-4.568223e-03
</td>
<td>
7.532330e-03
</td>
</tr>
<tr>
<td>
12
</td>
<td>
3
</td>
<td>
8
</td>
<td>
0.8
</td>
<td>
-3.430667e-03
</td>
<td>
-4.011748e-03
</td>
<td>
-6.571402e-03
</td>
<td>
-8.710123e-04
</td>
</tr>
<tr>
<td>
13
</td>
<td>
2
</td>
<td>
4
</td>
<td>
0.4
</td>
<td>
-6.626465e-03
</td>
<td>
-6.626465e-03
</td>
<td>
-7.390707e-03
</td>
<td>
-5.862222e-03
</td>
</tr>
<tr>
<td>
14
</td>
<td>
1
</td>
<td>
2
</td>
<td>
0.2
</td>
<td>
-4.079521e-03
</td>
<td>
-4.079521e-03
</td>
<td>
-4.079521e-03
</td>
<td>
-4.079521e-03
</td>
</tr>
<tr>
<td>
15
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.1
</td>
<td>
-8.838739e-34
</td>
<td>
-8.838739e-34
</td>
<td>
-8.838739e-34
</td>
<td>
-8.838739e-34
</td>
</tr>
</tbody>
</table>
</div>
<div id="plotting-multiresolution-decomposition-with-plot_mrd" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Plotting multiresolution decomposition with <code>plot_mrd</code><a href="spectra.html#plotting-multiresolution-decomposition-with-plot_mrd" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>plot_mrd</code> takes an object returned by <code>calc_mrd</code> and plots mean, median and quartiles versus time.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="spectra.html#cb30-1" aria-hidden="true"></a><span class="kw">plot_mrd</span>(mrd_uw, <span class="dt">main=</span><span class="st">&quot;Cospectrum (u,w)&quot;</span>)</span></code></pre></div>
<p><img src="figures/fig_0503.png" width="400" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="spectra.html#cb31-1" aria-hidden="true"></a><span class="co">#plot_mrd(mrd_Tw, main=&quot;Cospectrum (T,w)&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="spectra.html#cb32-1" aria-hidden="true"></a><span class="co">#plot_mrd(mrd_ww, main=&quot;Spectrum (w,w)&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="spectra.html#cb33-1" aria-hidden="true"></a><span class="kw">plot_mrd</span>(mrd_TT, <span class="dt">main=</span><span class="st">&quot;Spectrum (T,T)&quot;</span>)</span></code></pre></div>
<p><img src="figures/fig_0504.png" width="400" /></p>
<p>Composite MRDs can be created by averaging over several MRDs (also possible to distinguish different flow regimes, e.g., based on the stability parameter <code>calc_zeta</code>) and can be used to find long-term characteristic (e.g., scale gaps). Scale(s) gap(s) are defined as the the zero-crossings of the spectrum or cospectrum (larger than the first zero-crossing at the measurement frequency itself).</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references hanging-indent">
<div id="ref-Sievers2015">
<p>Sievers, J., T. Papakyriakou, S. E. Larsen, M. M. Jammet, S. Rysgaard, M. K. Sejr, and L. L. Sørensen. 2015. “Estimating surface fluxes using eddy covariance and numerical ogive optimization.” <em>Atmos Chem Phys</em> 15: 2081–2103. <a href="https://doi.org/10.5194/acp-15-2081-2015">https://doi.org/10.5194/acp-15-2081-2015</a>.</p>
</div>
<div id="ref-Vickers2003">
<p>Vickers, D., and L. Mahrt. 2003. “The Cospectral Gap and Turbulent Flux Calculations.” <em>J Atmos Ocean Technol</em> 20: 660–72.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="quadrant-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reynolds-stress-tensor.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc depth": 2,
"github-repo": "noctiluc3nt/ec_analyze"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
