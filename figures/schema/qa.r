library(latex2exp)

png("schema_qa.png",res=300,unit="in",height=4,width=15)

xs=seq(-2.5,2.5,0.01)
ys=seq(-2.5,2.5,0.01)

u_points=c(1,0.2,0.4,0.2,-0.1,-0.8,-0.7,-0.1,-0.4,-1,-0.9,0.9,0.6,-0.2,0.3,-0.2)
w_points=c(-1,-0.7,-0.3,0.2,-0.1,1,0.5,0.3,0.1,0.9,0.6,-0.4,-0.5,0.2,-0.1,-0.3)
T_points=c(-u_points)

par(mfrow=c(1,4),mgp=c(2.2,1,0),mar=c(5,4,4,2)+0.1)
par(cex.main=1.4,cex.lab=1.4,cex.axis=1.4)
cex=1.4
pch=1.8
plot(u_points,w_points,pch=20,col=1,xlab=substitute(paste(bold('u (normalized)'))),
    ylab=substitute(paste(bold('w (normalized)'))),main=TeX("momentum flux"),xlim=c(-2,2),ylim=c(-2,2),cex=pch)
points(xs,1/ys,col="gray",type="l",lty=2,lwd=2,pch=pch)
points(xs,-1/ys,col="gray",type="l",lty=2,lwd=2,pch=pch)
points(xs,2/ys,col="gray",type="l",lty=3,lwd=2,pch=pch)
points(xs,-2/ys,col="gray",type="l",lty=3,lwd=2,pch=pch)
abline(h=0,lty=2,lwd=2)
abline(v=0,lty=2,lwd=2)
text(2,2,"Q1")
text(-2,2,"Q2")
text(-2,-2,"Q3")
text(2,-2,"Q4")
text(1.5,1.5,substitute(paste(bold('outward\ninteraction'))),cex=cex)
text(-1.5,1.5,substitute(paste(bold('ejection'))),cex=cex)
text(-1.5,-1.5,substitute(paste(bold('inward\ninteraction'))),cex=cex)
text(1.5,-1.5,substitute(paste(bold('sweep'))),cex=cex)
text(-1.5,0.45,"H = 1",col="gray")
text(-1.7,0.9,"H = 2",col="gray")
polygon(c(0,-4,-4,0),c(0,0,4,4),col=rgb(0,0,0,0.1),lty=0)
polygon(c(0,4,4,0),c(0,0,-4,-4),col=rgb(0,0,0,0.1),lty=0)
mtext("(a)",3,line=1.4,adj=1,cex=0.8)


c2=rgb(1,0,0)
plot(T_points,w_points,pch=20,xlab=substitute(paste(bold('T (normalized)'))),
    ylab=substitute(paste(bold('w (normalized)'))),xlim=c(-2,2),ylim=c(-2,2),col=c2,main=TeX("sensible heat flux"),cex=pch)
points(xs,1/ys,col="gray",type="l",lty=2,lwd=2,pch=pch)
points(xs,-1/ys,col="gray",type="l",lty=2,lwd=2,pch=pch)
points(xs,2/ys,col="gray",type="l",lty=3,lwd=2,pch=pch)
points(xs,-2/ys,col="gray",type="l",lty=3,lwd=2,pch=pch)
abline(h=0,lty=2,lwd=2)
abline(v=0,lty=2,lwd=2)
text(2,2,"Q1")
text(-2,2,"Q2")
text(-2,-2,"Q3")
text(2,-2,"Q4")
text(1.5,1.5,substitute(paste(bold('warm\nupdraft'))),cex=cex,col=c2)
text(-1.5,1.5,substitute(paste(bold('cold\nupdraft'))),cex=cex,col=c2)
text(-1.5,-1.5,substitute(paste(bold('cold\ndowndraft'))),cex=cex,col=c2)
text(1.5,-1.5,substitute(paste(bold('warm\ndowndraft'))),cex=cex,col=c2)
text(-1.5,0.45,"H = 1",col="gray")
text(-1.7,0.9,"H = 2",col="gray")
polygon(c(0,4,4,0),c(0,0,4,4),col=rgb(1,0,0,0.1),lty=0)
polygon(c(0,-4,-4,0),c(0,0,-4,-4),col=rgb(1,0,0,0.1),lty=0)
mtext("(b)",3,line=1.4,adj=1,cex=0.8)


c2=rgb(0,0,0.9)
plot(T_points,w_points,pch=20,xlab=substitute(paste(bold('q (normalized)'))),
    ylab=substitute(paste(bold('w (normalized)'))),xlim=c(-2,2),ylim=c(-2,2),col=c2,main=TeX("latent heat flux"),cex=pch)
points(xs,1/ys,col="gray",type="l",lty=2,lwd=2,pch=pch)
points(xs,-1/ys,col="gray",type="l",lty=2,lwd=2,pch=pch)
points(xs,2/ys,col="gray",type="l",lty=3,lwd=2,pch=pch)
points(xs,-2/ys,col="gray",type="l",lty=3,lwd=2,pch=pch)
abline(h=0,lty=2,lwd=2)
abline(v=0,lty=2,lwd=2)
text(2,2,"Q1")
text(-2,2,"Q2")
text(-2,-2,"Q3")
text(2,-2,"Q4")
text(1.5,1.5,substitute(paste(bold('moist\nupdraft'))),cex=cex,col=c2)
text(-1.5,1.5,substitute(paste(bold('dry\nupdraft'))),cex=cex,col=c2)
text(-1.5,-1.5,substitute(paste(bold('dry\ndowndraft'))),cex=cex,col=c2)
text(1.5,-1.5,substitute(paste(bold('moist\ndowndraft'))),cex=cex,col=c2)
text(-1.5,0.45,"H = 1",col="gray")
text(-1.7,0.9,"H = 2",col="gray")
polygon(c(0,4,4,0),c(0,0,4,4),col=rgb(0,0,0.9,0.1),lty=0)
polygon(c(0,-4,-4,0),c(0,0,-4,-4),col=rgb(0,0,0.9,0.1),lty=0)
mtext("(c)",3,line=1.4,adj=1,cex=0.8)


c2=rgb(0.9,0.5,0)
plot(u_points,w_points,pch=20,col=c2,xlab=substitute(paste(bold('c (normalized)'))),
    ylab=substitute(paste(bold('w (normalized)'))),xlim=c(-2,2),ylim=c(-2,2),main=TeX("CO$_2$ flux"),cex=pch)
points(xs,1/ys,col="gray",type="l",lty=2,lwd=2,pch=pch)
points(xs,-1/ys,col="gray",type="l",lty=2,lwd=2,pch=pch)
points(xs,2/ys,col="gray",type="l",lty=3,lwd=2,pch=pch)
points(xs,-2/ys,col="gray",type="l",lty=3,lwd=2,pch=pch)
abline(h=0,lty=2,lwd=2)
abline(v=0,lty=2,lwd=2)
text(2,2,"Q1")
text(-2,2,"Q2")
text(-2,-2,"Q3")
text(2,-2,"Q4")
pos=1.5
text(pos,pos,substitute(paste(bold('enriched\nupdraft'))),cex=cex,col=c2)
text(-pos,pos,substitute(paste(bold('depleted\nupdraft'))),cex=cex,col=c2)
text(-pos,-1.7,substitute(paste(bold('depleted\ndowndraft'))),cex=cex,col=c2)
text(pos,-1.7,substitute(paste(bold('enriched\ndowndraft'))),cex=cex,col=c2)
text(-1.5,0.45,"H = 1",col="gray")
text(-1.7,0.9,"H = 2",col="gray")
polygon(c(0,-4,-4,0),c(0,0,4,4),col=rgb(0.9,0.5,0,0.1),lty=0)
polygon(c(0,4,4,0),c(0,0,-4,-4),col=rgb(0.9,0.5,0,0.1),lty=0)
mtext("(d)",3,line=1.4,adj=1,cex=0.8)

dev.off()